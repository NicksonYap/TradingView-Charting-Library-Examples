(window.webpackJsonp=window.webpackJsonp||[]).push([["widgetbar"],{"1Pr8":function(t,e,i){t.exports={button:"button-3SuA46Ww",hover:"hover-3AIQmXGb",hoverMask:"hoverMask-LMMGveQV",icon:"icon-ogPAaQZH",counterRow:"counterRow-S6Ya-jCg",counter:"counter-1TX_xqdT",isGrayed:"isGrayed-3O5VgbN4",isActive:"isActive-1D4aU96I",isTab:"isTab-1dbyVeUX"}},"1WEt":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m18 18v-.5c0-1.2.6-2 1.5-2.7.8-.5 2-.8 3-.8s2.2.3 3 .8c.9.6 1.5 1.5 1.5 2.7a4 4 0 0 1-1.3 2.8l-2.3 2c-.3.3-.4.6-.4 1.2v.5h-1v-.5c0-.8.2-1.4.6-1.9l2.4-2c.6-.7 1-1.3 1-2.1a2 2 0 0 0-1-1.8c-.7-.5-1.6-.7-2.5-.7-1 0-1.8.2-2.5.7-.6.4-1 1-1 1.8v.5m3.5 8a1 1 0 0 0 0 5 1 1 0 0 0 0-5m0 1a1 1 0 0 1 0 3 1 1 0 0 1 0-3m0-17a1 1 0 0 0 0 25 1 1 0 0 0 0-25m0 1a1 1 0 0 1 0 23 1 1 0 0 1 0-23"/></svg>'},"5qsH":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><g fill="none" stroke="currentColor"><path d="M14.5 27.5c0 4.97 3.03 8 8 8 4.97 0 8-3.03 8-8v-6a3 3 0 0 0-3-3h-10a3 3 0 0 0-3 3v6z"/><path stroke-linecap="square" d="M22.5 19v16"/><path d="M27.5 18.5a5 5 0 1 0-10 0m13 3h2a2 2 0 0 1 2 2V25m-4 2.5h2a2 2 0 0 1 2 2V31M29 32.5h1.5a2 2 0 0 1 2 2V36m-18-14.5h-2a2 2 0 0 0-2 2V25m4 2.5h-2a2 2 0 0 0-2 2V31m5.5 1.5h-1.5a2 2 0 0 0-2 2V36"/><g transform="translate(12 8)"><circle cx="2.5" cy="2.5" r="2"/><path d="M3.911 3.911L7 7"/></g><g transform="translate(26 8)"><circle cx="4.5" cy="2.5" r="2"/><path d="M3.115 3.885L0 7"/></g></g></svg>'},"9Qhg":function(t,e,i){},BH4H:function(t,e,i){"use strict";(function(e,n,a){function s(t){t||(t={}),this.options=t,this.resizerBridge=t.resizerBridge,this.adaptive=!!t.adaptive,this.tradingPanelAccessor=t.tradingPanelAccessor,this.widgetConfig=$.extend(!0,{},s.widgetConfig),t.widgetConfig&&(this.widgetConfig=$.extend(!0,this.widgetConfig,t.widgetConfig)),this.layout=new o({widgetBar:this}),this._customization=t.customization,t.chartWidgetCollection&&(this.chartWidgetCollection=t.chartWidgetCollection),t.state?this.layout.demarshal(t.state):t.settingsPrefix&&(this._settingsPrefix=t.settingsPrefix+"",this.loadFromTVSettings()),t.readonly&&(this.readonly=!0),t.fixedMode&&(this.fixedMode=!0),t.showCloseButton&&(this.showCloseButton=!0),this.$container=$(this.resizerBridge.container.value()),this._internal=new y(this),this.createHTML(),this.initLayout(),loginStateChange.subscribe(this,this.onLoginStateChange),this.resizerBridge.width.subscribe(function(){this.layout.syncWidth()}.bind(this)),this.resizerBridge.height.subscribe(function(){this.layout.syncHeight()}.bind(this)),this.resizerBridge.visible.subscribe(function(t){this.layout.onVisibilityChange(t)}.bind(this)),this.resizerBridge.availWidth.subscribe(function(){this.layout.requestOptimalWidth(),this.layout.updateResponsiveness()}.bind(this)),this._tradingServiceCancelable=A(x()),this._tradingServiceCancelable.promise.then(function(t){this._tradingServiceCancelable=null,t.onConnectionStatusChange.subscribe(this,this._onBrokerConnectionStatusChanged)
}.bind(this))}function o(t){this.widgetBar=t.widgetBar,this.pages=[],this.activePageIndex=new n(this.activeIndex),this.isMinimized=new n(this.minimized),t&&t.widgetBar&&Object.defineProperty(this,"widgetBar",{value:t.widgetBar,configurable:!0})}function r(t){this.widgets=[],t&&t.widgetBarLayout&&Object.defineProperty(this,"widgetBarLayout",{value:t.widgetBarLayout,configurable:!0})}function d(t){t&&t.widgetBarPage&&Object.defineProperty(this,"widgetBarPage",{value:t.widgetBarPage,configurable:!0}),this._internalState={alive:new n(!0),container:new n,width:new n,height:new n,detachable:new n(!1)},this._rdState=new T.ResizerDetacherState(this._internalState),this._rdState.owner.subscribe(function(t){t!==this._internalState&&$(this._internalState.container.value()).empty()}.bind(this)),this.widgetActive=new n,this.widgetMaximized=new n,this._widgetStarted=new a}function l(t){t&&t.settingsKey&&(this._settingsKey=t.settingsKey,this._value=TVSettings.getJSON(this._settingsKey,null)),t&&t.widgetBarWidget&&Object.defineProperty(this,"widgetBarWidget",{value:t.widgetBarWidget,configurable:!0})}function h(){return e.enabled("widgetbar_tabs")||e.enabled("dome_widget")&&e.enabled("showdom_button")||e.enabled("order_panel")||e.enabled("bugreport_button")}var g,c,u,p,w,f,m,v,y,b,_,B,P,C,T,W,S,x,A,M;i("9Qhg"),i("pfXf"),g=i("Eyy1").ensureNotNull,c="widgetbar",u=i("PiKd"),p=i("Q8Ag"),w=i("PT1i").linking,f=i("PC8g").trackEvent,m=i("0waE"),v=i("/BH3"),y=i("Fb/L").WidgetBarInternal,b=i("dkCg").RightToolbarRenderer,_=i("tBUM").WidgetBarTabButtonViewModel,B=i("jkvV").Hider,P=i("i8i4"),C=i("q1tI"),T=i("HySD"),W=i("N22A"),S=W.tradingService,x=W.waitTradingService,A=i("b5Gw").makeCancelable,M=i("ULlu").unwrap,i("e9Yb"),s.widgetConfig={reuters_calendar:{title:$.t("Economic Calendar"),ctor:null,lazyLoad:!0,icon:"economic-calendar",options:{widgetType:"widgetbar"}},earnings_calendar:{title:$.t("Earnings Calendar"),ctor:null,lazyLoad:!0,icon:"earnings-calendar"},watchlist:{title:$.t("Watchlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},hotlist:{title:$.t("Hotlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},detail:{title:$.t("Details"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},news:{title:$.t("News"),ctor:null},chat:{title:$.t("Talks"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages_with_select:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notifications_user:{title:$.t("Notifications"),ctor:null,options:{type:"user"},chartWidgetAllowed:!0},notifications_following:{title:$.t("Ideas Stream"),ctor:null,options:{type:"following"},chartWidgetAllowed:!0},datawindow:{title:$.t("Data Window"),ctor:null,chartWidgetAllowed:!0,chartWidgetRequired:!0},publicchats:{title:$.t("All Talks"),ctor:null,doNotClearNotifications:!0},publicchats_with_select:{title:$.t("All Talks"),ctor:null,doNotClearNotifications:!0,options:{layoutWithSelect:!0},
emptyHeader:!0},notes:{title:$.t("My Ideas"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},alerts_manage:{title:$.t("Manage Alerts"),ctor:null,chartWidgetAllowed:!0},alerts_log:{title:$.t("Alerts Log"),ctor:null,chartWidgetAllowed:!0},market_summary:{title:$.t("Market Summary"),ctor:null}},s.svgIcons={base:i("dECE")},s._messageHandlers=[],s.postMessage=function(t,e){s._messageHandlers.forEach(function(i){i.handler(t,e)})},s.onMessage=function(t){"function"==typeof t&&s._messageHandlers.push({handler:t,widget:this})},s.prototype.destroy=function(){null!==this._tradingServiceCancelable?(this._tradingServiceCancelable.cancel(),this._tradingServiceCancelable=null):g(S()).onConnectionStatusChange.unsubscribe(this,this._onBrokerConnectionStatusChanged);this._internal.destroy(),this._internal=null},s.prototype.isVisible=function(){var t=this.resizerBridge;return t.visible.value()&&t.height.value()&&t.width.value()},s.prototype.initLayout=function(){var t=this;u.load(c,function(){var e=$.Deferred();return p.loadWidgetBarModules(function(i){var n=t.widgetConfig;n.reuters_calendar.ctor=i.ReutersCalendarWidget,n.earnings_calendar.ctor=i.CalendarWidget&&i.CalendarWidget.Earnings,n.watchlist.ctor=i.Watchlist&&i.Watchlist.Widget,n.hotlist.ctor=i.HotlistWidget,n.detail.ctor=i.Detail&&i.Detail.Widget,n.news.ctor=i.NewsWidget,n.chat.ctor=i.ChatWidget,n.messages.ctor=i.Messages&&i.Messages.Widget,n.messages_with_select.ctor=i.Messages&&i.Messages.Widget,n.notifications_following.ctor=i.NotificationsWidgets,n.notifications_user.ctor=i.NotificationsWidgets,n.publicchats.ctor=i.PublicChatsWidget,n.publicchats_with_select.ctor=i.PublicChatsWidget,n.notes.ctor=i.NotesWidget,n.alerts_manage.ctor=i.AlertsManageWidget,n.alerts_log.ctor=i.AlertsLogWidget,e.resolve(i)}),e.promise()},this.options.instantLoad),u.onReady(c,function(){t.layout.startWidgets()}),0===this.layout.pages.length&&(this.layout.setMinimizedState(!0),this.layout.$handle.addClass("js-hidden")),t.layout.requestOptimalWidth(),this.layout.syncWidth(),this.layout.syncHeight(),t.layout.onVisibilityChange(),t.layout.updateResponsiveness()},s.prototype.loadWidgets=function(){this._widgetsLoadRequested||(this._widgetsLoadRequested=!0,u.load(c,null,!0))},s.prototype.onLoginStateChange=function(t){t||window.is_authenticated&&(this.dropWidgetData(),this.refreshFromTVSettings())},s.prototype.dropWidgetData=function(){for(var t in this.widgetConfig)delete this.widgetConfig[t].data},s.prototype.refreshFromTVSettings=function(){this._settingsPrefix&&(this.layout&&this.layout.destroy(),this.layout=new o({widgetBar:this}),this.loadFromTVSettings(),this.layout.createHTML(),this.layout.$pages.appendTo(this.$wrap),this.layout.$tabs.appendTo(this.$wrap),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap),this.initLayout())},s.prototype.getWidgets=function(t){var e,i=[];for(e=0;e<this.layout.pages.length;++e)i=i.concat(this.layout.pages[e].getWidgets(t));return i},s.prototype.loadFromTVSettings=function(){var t,e,i,n,a;if(this._settingsPrefix){try{this.migrateFromOld()}catch(t){
console.error&&console.error(t)}if(t=this.getLayoutState(),t=this.mergeProperties(t),this.layout.demarshal(t,{settingsPrefix:this._settingsPrefix}),this.saveToTVSettings(),e=TVSettings.getJSON(this._settingsPrefix+"."+v.layoutKeyName,null)){for(n in i=[],e.widgets)i=i.concat(e.widgets[n].map(function(t){return t.id}));(a=TVSettings.keysMask(this._settingsPrefix+".widget.*.*"))&&a.forEach(function(t){var e=t.replace(this._settingsPrefix+".widget.","");-1===i.indexOf(e)&&0===t.indexOf(this._settingsPrefix+".widget.")&&(f("Settings debug","loadFromTVSettings: "+t,user.username),TVSettings.remove(t))}.bind(this))}}},s.prototype.mergeProperties=function(t){var e,i,n,a,s,o=TVSettings.getJSON(this._settingsPrefix+"."+v.layoutKeyName,null);if(!o)return t;for(o.settings&&$.extend(t,o.settings),e={},i=0;i<t.pages.length;i++)for(n=0;n<t.pages[i].widgets.length;n++)s=e[(a=t.pages[i].widgets[n]).type]||0,o.widgets[a.type]&&o.widgets[a.type][s]&&$.extend(a,o.widgets[a.type][s]),e[a.type]=++s;return t},s.prototype.migrateFromOld=function(t){var e,i,n,a,s,o,r,d=TVSettings.getJSON(this._settingsPrefix+".layout-fixed",null);if(d){e={settings:{}},"minimized"in d&&(e.settings.minimized=d.minimized),"width"in d&&(e.settings.width=d.width),"activeIndex"in d&&(e.settings.activeIndex=d.activeIndex),e.widgets={};for(i=0;i<d.pages.length;i++)for(n=d.pages[i].widgets||d.pages[i],s=0;s<n.length;s++)(o=n[s]).id?(a=o.id.replace(/\..*/,""),/^news_.+/.test(a)&&(a=o.type="news",TVSettings.setJSON(this._settingsPrefix+".widget."+o.id.replace(/news_[^.]*/,"news"),TVSettings.getValue(this._settingsPrefix+".widget."+o.id)),o.id=o.id.replace(/news_[^.]*/,"news"))):(a=o.type,/^news_.+/.test(a)&&(o.properties=o.properties||{},o.properties.provider=o.type.replace(/news_([^.]*).*/,"$1"),a=o.type="news")),e.widgets[a]?e.widgets[a].push(o):e.widgets[a]=[o];TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,e)}else TVSettings.getJSON(this._settingsPrefix+".layout",null)&&(r=this.getWidgetProperties("watchlist"))&&(e={settings:{},widgets:{watchlist:[r]}},TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,e));d&&TVSettings.remove(this._settingsPrefix+".layout-fixed"),TVSettings.getJSON(this._settingsPrefix+".layout",null)&&TVSettings.remove(this._settingsPrefix+".layout")},s.prototype.saveToTVSettings=function(){if(this._settingsPrefix){var t=this.layout.marshal();TVSettings.setJSON(this._settingsPrefix+"."+v.layoutKeyName,t)}},s.prototype.getWidgetProperties=function(t,e){var i,n;return e=e||0,i=this._settingsPrefix.replace(/\W/g,"\\$&")+".widget.",!!((n=TVSettings.keysMask(i+t+".*"))&&n.length&&(n=n.sort())[e])&&{id:n[e].replace(i,"")}},s.prototype._onBrokerConnectionStatusChanged=function(t){},s.prototype.getGenericLayoutState=function(t){var i,n,a=v.getDefaultState(),s=window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE;for(s.default=s.en,i=[{_gaEvent:"General Widget",title:$.t("Watchlist, details and news"),name:"base",icon:"base",widgets:[{type:"watchlist",properties:t&&t.length?{list:t}:void 0},{type:"detail"},{type:"news",properties:{provider:{
base:"yahoo",ru:"djforex",en:"yahoo",tr:"bloomberght",pl:"yahoo",kr:"edali",id:"yahoo"}}}]},e.enabled("alerts")?{_gaEvent:"Alerts",title:$.t("Alerts"),name:"alerts",icon:"alarm-clock",widgets:[{type:"alerts_manage",properties:{}},{type:"alerts_log",properties:{}}]}:null,null,{_gaEvent:"Data Window",title:$.t("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]},{_gaEvent:"Hotlists",title:$.t("Hotlists"),name:"hotlist",icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:s,groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:s,groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:s,groupByLocale:{default:"percent_change_loosers"}}}]},{_gaEvent:"Calendar",title:$.t("Calendar"),name:"calendar",icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]},{_gaEvent:"My Ideas",title:$.t("My Ideas"),name:"notes",icon:"notes",spaceBottom:!0,spaceBottomText:$.t("Social"),widgets:[{type:"notes"}]},{_gaEvent:"Public Chats",title:$.t("Public Chats"),name:"chats",icon:"chat",widgets:[{type:"chat"},{type:"publicchats"}]},{_gaEvent:"Private Chats",title:$.t("Private Chats"),name:"pm_chats",icon:"messages",widgets:[{type:"messages"}]},{_gaEvent:"Ideas Stream",title:$.t("Ideas Stream"),name:"ideas_stream",icon:"ideas-stream",widgets:[{type:"notifications_following"}]},{_gaEvent:"Notifications",title:$.t("Notifications"),name:"notifications",icon:"notifications",widgets:[{type:"notifications_user"}]}],n=0;n<i.length;n++)i[n]&&a.pages.push(i[n]);return a},s.prototype.getChartingPlatformLayoutState=function(t,e){var i,n,a={version:2,width:267,pages:[]};return(this._customization.watchlist||this._customization.details||this._customization.news)&&(i="",n=[],this._customization.watchlist&&(i=$.t("Watchlist"),n.push({type:"watchlist",id:"watchlist."+e,properties:t&&t.length?{list:t}:void 0})),this._customization.details&&(this._customization.watchlist?i+=" "+$.t("and details"):i=$.t("Details"),n.push({type:"detail"})),this._customization.news&&(this._customization.watchlist||this._customization.details?i+=" and news":i="News",n.push({type:"news",id:"news."+e})),a.pages.push({name:i,title:i,icon:"base",widgets:n})),a},s.prototype.getLayoutState=function(){function t(t){return!(void 0!==t.isEnabled&&!t.isEnabled)&&(o.chartWidgetCollection||!s.widgetConfig[t.type].chartWidgetRequired)}var i,n,a,o=this,r=TVSettings.getJSON("watchlist.list",[]);for(n=(i=e.enabled("cqg_terminal")?this.getChartingPlatformLayoutState(r,"cqg"):e.enabled("trading_terminal")?this.getChartingPlatformLayoutState(r,"terminal"):this.getGenericLayoutState(r)).pages.length-1;n>=0;n--)(a=i.pages[n]).widgets=$.grep(a.widgets,t);return i.pages=$.grep(i.pages,function(t){return t.widgets&&t.widgets.length}),i},s.prototype.createWidgetId=function(t){return t+"."+m.randomHash()},s.prototype.setPage=function(t){this.layout.setMinimizedState(!1);var e=this.layout.activeIndex
;return this.layout.pages.forEach(function(i,n){i.name===t&&(e=n)}),this.layout.switchPage(e),this.layout.getActivePage()},o.prototype.startWidgets=function(){this.pages.forEach(function(t){t.widgets.forEach(function(t){t.widgetObject||t.widgetStartDelayed||setTimeout(function(){t.startWidget()},0)})});var t=this.getActivePage();t&&t.onActiveStateChange(!0)},o.prototype.syncHeight=function(){var t,e=this.widgetBar.resizerBridge.height.value();this.$pages.css("height",e+"px"),this.minimized||(t=this.getActivePage())&&t.updateWidgetsHeight()},o.prototype.tabsWidth=function(){return h()?v.tabsWidth:this.minimized?v.hiderGapWidth:0},o.prototype.borderWidth=function(){return v.borderWidth},o.prototype.canOpen=function(){return this.MIN_WIDTH+this.tabsWidth()+this.borderWidth()<=this.widgetBar.resizerBridge.availWidth.value()},o.prototype.requestWidth=function(t){var e,i,n=this.widgetBar.resizerBridge;t>0&&(t+=this.borderWidth()),i=t+(e=this.tabsWidth()),this.canOpen()?n.width.value()!==i&&n.negotiateWidth([{min:e,max:e},{min:this.MIN_WIDTH+e,max:i}]):n.negotiateWidth(0)},o.prototype.requestOptimalWidth=function(){this.changeWidgetsButtonTitle(),this.minimized?this.requestWidth(0):this.requestWidth(this.width)},o.prototype.updateResponsiveness=function(){var t=!this.canOpen();this.$tabs.toggleClass("js-hidden",t),this.$pages.toggleClass("js-hidden",t)},o.prototype.syncWidth=function(){var t,e,i=this.widgetBar.resizerBridge,n=this.tabsWidth(),a=this.borderWidth(),s=i.width.value(),o=Math.max(s-n-a,0)||0;o<this.MINIMIZE_THRESHOLD?this.setMinimizedState(!0):this.setMinimizedState(!1),this.$pages.css("width",o+"px").toggleClass("hidden",!!this.minimized),this.minimized||((t=this.getActivePage())&&t.widgets.forEach(function(t){t.onWidthChange(o)}),this.widgetBar&&this.widgetBar.loadWidgets()),e=!this.canOpen(),this.$deviceButton&&this.$deviceButton.toggleClass("js-hidden",!e||!this.minimized)},o.prototype.setMinimizedState=function(t){t=!!t,!!this.minimized!==t&&(this.minimized=t,this.isMinimized.setValue(this.minimized),t&&this.widgetBar.resizerBridge.exitFullscreen(),this.requestOptimalWidth(),this.activeIndex>=0&&this.pages[this.activeIndex].onActiveStateChange(!this.minimized))},o.prototype.getWidgetsButtonTitle=function(){return this.minimized?window.t("Show Widgets"):window.t("Hide Widgets")},o.prototype.changeWidgetsButtonTitle=function(){this.widgetBar.$widgetBarBtn&&this.widgetBar.$widgetBarBtn.attr("title",this.getWidgetsButtonTitle())},o.prototype.switchPage=function(t){var e,i,n;if(-1===t||0===this.pages.length)return this.activeIndex=-1,void this.activePageIndex.setValue(this.activeIndex);if(t instanceof r){if(-1===(e=this.pages.indexOf(t)))return}else e=+t;i=this.pages[this.activeIndex],this.activeIndex=Math.min(this.pages.length-1,Math.max(0,e)),this.activePageIndex.setValue(this.activeIndex),n=this.pages[this.activeIndex],this.activeName=n.name,this.minimized||i&&i===n||(i&&i.onActiveStateChange(!1),n&&n.onActiveStateChange(!0))},o.prototype.getActivePage=function(){
return this.minimized?null:this.pages[this.activeIndex]||null},o.prototype.onTabClick=function(t,e){if(!t.isDefaultPrevented()){var i=this.pages.indexOf(e);-1!==i&&(t.preventDefault(),i!==this.activeIndex||this.minimized?(e._gaEvent&&f("Platform Widgets",e._gaEvent),this.switchPage(i),this.minimized&&this.setMinimizedState(!1)):this.setMinimizedState(!0),this.widgetBar&&this.widgetBar.saveToTVSettings())}},s.prototype.ensureSupportTicketButtonViewModel=function(){return this._supportTicketButtonViewModel?this._supportTicketButtonViewModel:this._supportTicketButtonViewModel=new _({icon:i("5qsH"),hint:window.t("Help Center"),onClick:function(){e.enabled("charting_library_base")?window.showUserReportDialog():(u.onReady(c,function(t){var e=t.showSupportDialog;e&&e()}),u.load(c,null,0))}})},s.prototype.ensureHelpButtonViewModel=function(){var t,e,n,a;return this._helpButtonViewModel?this._helpButtonViewModel:(t=this.ensureSupportTicketButtonViewModel(),e=this.options,n=null,a=this._helpButtonViewModel=new _({icon:i("1WEt"),hint:$.t("Help"),onClick:function(i){var s=i.currentTarget;u.onReady(c,function(i){var o=i.ChartHelpMenu;o&&(null===n&&(n=new o(a,t,e.showWizardFn,e.areShortcutsAvailable)),n.isOpened()?n.close():n.open(s))}),u.load(c,null,0)}}))},o.prototype.onLayoutResizeHandleMousedown=function(t){function e(t){var e,s;e=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,(s=n-(e-a))<i.MINIMIZE_THRESHOLD?s=0:s<i.MIN_WIDTH&&(s=i.MIN_WIDTH),s>0&&(i.width=s),i.requestWidth(s)}var i,n,a;t.isDefaultPrevented()||(t.preventDefault(),i=this,n=Math.max(this.widgetBar.resizerBridge.width.value()-this.tabsWidth()-this.borderWidth(),0),a=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,$(document.documentElement).on("mousemove touchmove",e).on("mouseup touchend",function t(n){$(document.documentElement).off("mousemove touchmove",e).off("mouseup touchend",t),i.widgetBar&&i.widgetBar.saveToTVSettings(),i.changeWidgetsButtonTitle()}))},o.prototype.removePage=function(t){var e=this.pages.indexOf(t);-1!==e&&(delete t.widgetBarLayout,this.pages.splice(e,1),t.$page.detach(),t.$page.detach(),t.$tab.detach(),this.activeIndex===e&&this.switchPage(e-1))},o.prototype.createPage=function(){var t=new r({widgetBarLayout:this});return this.pages.push(t),t.createHTML(),this.$pagescontent.append(t.$page),t},o.prototype.createWidget=function(t,e){if(e){if(-1===this.pages.indexOf(e))return null}else e=this.createPage();var i=new d({widgetBarPage:e});return i.demarshal({type:t}),i.createHTML(),e.attachWidget(i),i},o.prototype.widgetInsertionDisallowed=function(t){return"watchlist"===t&&((!window.user||!user.is_pro)&&(!!this.pages.some(function(e){return e.widgets.some(function(e){return e.type===t})})||void 0))},o.prototype.onVisibilityChange=function(){var t=!(!this.widgetBar||!this.widgetBar.resizerBridge.visible.value());this.visible=t,this.pages.forEach(function(e){e.onVisibilityChange(t)})},o.prototype.destroy=function(){var t,e,i,n,a
;for(this.widgetBar&&this.widgetBar.layout===this&&delete this.widgetBar.layout,this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this.$hider&&(t=this.$hider.get(0),P.unmountComponentAtNode(t)),e=this.pages.length;e--;)for(n=(i=this.pages[e]).widgets.length;n--;)i.widgets[n].destroy();for(a in this)this[a]instanceof $&&this[a].remove(),delete this[a]},o.prototype.getWidgetBarOption=function(){if(this.widgetBar&&name in this.widgetBar)return this.widgetBar[name]},o.prototype.MIN_WIDTH=200,o.prototype.MINIMIZE_THRESHOLD=50,o.prototype.width=290,o.prototype.minimized=!1,o.prototype.activeIndex=0,o.prototype.activeName="",o.prototype.visible=!0,r.prototype.onActiveStateChange=function(t){t=!!t,$(this.$page).toggleClass("active",!!t),this.tab.onActiveStateChange(t),t&&this.updateWidgetsHeight({skipIfHeightUnchanged:!0}),this.widgets.forEach(function(e){e.onActiveStateChange(t)})},r.prototype.updateWidgetsHeight=function(t){var e,i,n,a,s,o,r,d,l,h,g;if(this.$page&&this.widgetBarLayout&&this.widgetBarLayout.widgetBar)if(this.widgetBarLayout.getActivePage()===this){if(t=t||{},e=this.widgetBarLayout.widgetBar.resizerBridge.height.value(),this._pageHeight===e&&t.skipIfHeightUnchanged||(this._invalidated=!0,this._pageHeight=e),this._invalidated){for(i=e,a=0,s=this.widgets,o=null,r=this.widgets.length;r--;)if(this.widgets[r].widgetMaximized.value()){o=this.widgets[r];break}if(o){for(r=this.widgets.length;r--;)(d=s[r])!==o&&d.setHeight(0);s=[o]}for(i-=this.widgets.length-1,r=s.length;r--;)(d=s[r]).$widget&&(void 0===n&&(n=d.$header.outerHeight(!0)),i-=n,a+=d.heightRatio);for(l=i/a,h=s.length-1,r=0;r<=h;r++)d=s[r],g=r===h?i:Math.round(l*d.heightRatio),d.setHeight(g),i-=g}}else this._invalidated=!0},r.prototype.onWidgetResizeHandleMousedown=function(t,e){var i,n,a,s,o,r,d,l,h,g,c,u;if(!t.isDefaultPrevented()){for(i=this,t.preventDefault(),s=this.widgets.length-1;s>0;s--)this.widgets[s]===e&&(n=this.widgets[s],a=this.widgets[s-1]);o=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY,r=a._rdState.bridge().height.value(),d=a.heightRatio+n.heightRatio,0!==(l=r+n._rdState.bridge().height.value())&&(g=!1,c=function(t){var e,s;g||i.$page.addClass("widget-resize-mode"),e=(t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY)-o,s=Math.max(0,Math.min(r+e,l)),h!==s&&(h=s,a.heightRatio=s/l*d,n.heightRatio=d-a.heightRatio,a.setHeight(s),n.setHeight(l-s))},u=function(t){$(document.documentElement).off("mousemove touchmove",c).off("mouseup touchend",u),i.$page.removeClass("widget-resize-mode"),h!==r&&(i.normalizeRatios(),i.widgetBarLayout&&i.widgetBarLayout.widgetBar&&i.widgetBarLayout.widgetBar.saveToTVSettings())},$(document.documentElement).on("mousemove touchmove",c).one("mouseup touchend",u))}},r.prototype.normalizeRatios=function(){var t,e,i,n=1/0;for(t=this.widgets.length;t--;)(e=this.widgets[t].heightRatio)<=0||!isFinite(e)||e<n&&(n=e);if(isFinite(n)){for(i=1;n<1;)n*=2,i*=2;for(;n>=2;)n/=2,i/=2;for(t=this.widgets.length;t--;)this.widgets[t].heightRatio*=i}},
r.prototype.attachWidget=function(t,e){var i,n;e=+e,-1!==(i=this.widgets.indexOf(t))?this.widgets.splice(i,1):t.widgetBarPage&&t.widgetBarPage!==this&&t.widgetBarPage.removeWidget(t),e<this.widgets.length?e<0&&(e=0):e=this.widgets.length,delete t.widgetBarPage,Object.defineProperty(t,"widgetBarPage",{value:this,configurable:!0}),this.widgets.splice(e,0,t),(n=this.widgets[e+1])?t.$widget.insertBefore(n.$widget):t.$widget.appendTo(this.$page),this.widgetBarLayout&&this.widgetBarLayout.getActivePage(),this.updateWidgetsHeight(),t.updateVisibleWatchedValue()},r.prototype.removeWidget=function(t){var e=this.widgets.indexOf(t);-1!==e&&(delete t.widgetBarPage,this.widgets.splice(e,1),t.$widget&&t.$widget.detach(),this.updateWidgetsHeight())},r.prototype.remove=function(){this.widgetBarLayout&&this.widgetBarLayout.removePage(this)},r.prototype.destroy=function(){for(var t in this.remove(),this)this[t]instanceof $&&this[t].remove(),delete this[t]},r.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},r.prototype.onVisibilityChange=function(t){var e=t&&this.widgetBarLayout&&this.widgetBarLayout.getActivePage()===this;this.widgets.forEach(function(i){e&&i.clearNotifications(),i.onVisibilityChange(t)})},r.prototype.notify=function(t,e){!0!==(e=e||{}).clear?e.stopHighlightTab||(this.notificationCounter=this.notificationCounter+(~~t||1),this.updateNotifications(e.notificationValue)):this.clearNotifications()},r.prototype.clearNotifications=function(){this.notificationCounter=0,this.tab.updateNotifications(this.notificationCounter)},r.prototype.updateNotifications=function(t){var e="number"==typeof t?t:this.notificationCounter;this.tab.updateNotifications(e)},r.prototype.notificationCounter=0,r.prototype.getWidgets=function(t){var e,i,n=[];for(e=0;e<this.widgets.length;++e)(i=this.widgets[e]).type===t&&n.push(i);return n},d.prototype.setHeight=function(t){$(this._internalState.container.value())&&$(this._internalState.container.value()).height(t),this._internalState.height.setValue(t)},d.prototype.onWidthChange=function(t){this._internalState.width.setValue(t)},d.prototype.remove=function(){this.widgetBarPage&&this.widgetBarPage.removeWidget(this)},d.prototype.destroy=function(){for(var t in this.widgetObject&&"function"==typeof this.widgetObject.destroy&&this.widgetObject.destroy(),this.remove(),this.symbolLinking&&(this.symbolLinking.destroy(),this.symbolLinking=null),this.intervalLinking&&(this.intervalLinking.destroy(),this.intervalLinking=null),this.widgetVisible&&(this.widgetVisible.unsubscribe(),this.widgetVisible=null),this.widgetActive&&(this.widgetActive.unsubscribe(),this.widgetActive=null),this.watchedHeight&&(this.watchedHeight.unsubscribe(),this.watchedHeight=null),this.watchedWidth&&(this.watchedWidth.unsubscribe(),this.watchedWidth=null),this.widgetMaximized&&(this.widgetMaximized.unsubscribe(),this.widgetMaximized=null),this)this[t]instanceof $&&this[t].remove(),delete this[t];s._messageHandlers=s._messageHandlers.filter(function(t){
return t.widget!==this},this)},d.prototype.onActiveStateChange=function(t){var e=this.getWidgetBarOption("widgetConfig")||s.widgetConfig,i=e[this.type];this.$icon&&this.$icon.toggleClass("active",!!t),t&&!i.doNotClearNotifications&&this.clearNotifications(),this.updateVisibleWatchedValue(),this.widgetActive.setValue(!!t)},d.prototype.toggleMaximize=function(t){if("boolean"!=typeof t)t=!this.widgetMaximized.value();else if(t===this.widgetMaximized.value())return;this.widgetMaximized.setValue(t),this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.saveToTVSettings(),this.widgetBarPage&&this.widgetBarPage.updateWidgetsHeight()},d.prototype.startWidget=function(){var t,e,i,a,o,r;if(!this.widgetObject&&!this.widgetStartDelayed&&(t=(this.getWidgetBarOption("widgetConfig")||s.widgetConfig)[this.type])&&(e=t.ctor)){if(i=this,this.widgetVisible=this.widgetVisible||new n,this.updateVisibleWatchedValue(),t.lazyLoad&&!this.widgetVisible.value())return this.widgetStartDelayed=!0,void this.widgetVisible.when(function(){delete i.widgetStartDelayed,i.startWidget()});this.symbolLinking=w.symbol.spawn(),this.intervalLinking=w.interval.spawn(),a=this._rdState.bridge(),o={$widget:this.$widget,$header:this.$header,$headerspace:this.$headerspace,$body:$(a.container.value()),container:a.container.value(),properties:this.properties,notify:this.notify.bind(this),clearNotifications:this.clearNotifications.bind(this),visible:this.widgetVisible.readonly(),active:this.widgetActive.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,height:a.height,width:a.width,setTitle:this.setTitle.bind(this),setTitleHtml:this.setTitleHtml.bind(this),id:this.id,toggleMaximize:this.toggleMaximize.bind(this),maximized:this.widgetMaximized.readonly(),postMessage:s.postMessage.bind(this),onMessage:s.onMessage.bind(this),hideDetach:!1,unAuthEditable:this.unAuthEditable},t.chartWidgetAllowed&&(r=function(){return i.widgetBarPage&&i.widgetBarPage.widgetBarLayout&&i.widgetBarPage.widgetBarLayout.widgetBar&&i.widgetBarPage.widgetBarLayout.widgetBar.chartWidgetCollection},o.getChartWidget=function(){var t=r();return t?t.activeChartWidget.value():null},o.getChartWidgetCollection=function(){return r()||null}),null!=this.readonly?this.readonly&&(o.readonly=!0):this.getWidgetBarOption("readonly")&&(o.readonly=!0),null!=t.options&&(o.options=t.options),null!=this.stateData?o.data=this.stateData:null!=t.data&&(o.data=t.data),this.widgetObject=new e(o),this._widgetStarted.fire(this)}},d.prototype.widgetStarted=function(){return this._widgetStarted},d.prototype.notify=function(t,e){if(e=e||{},this.widgetBarPage&&(!this.widgetBarPage.isActiveAndVisible()||e.force))return this.widgetBarPage.notify(t,e)},d.prototype.clearNotifications=function(){if(this.widgetBarPage)return this.widgetBarPage.clearNotifications()},r.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},
d.prototype.onVisibilityChange=function(t){this.updateVisibleWatchedValue()},d.prototype.updateVisibleWatchedValue=function(){this.widgetVisible&&this.widgetVisible.setValue(!!this.widgetBarPage&&this.widgetBarPage.isActiveAndVisible())},d.prototype.setTitle=function(t){this.customTitle=t+"",this.$title&&this.$title.text(this.getTitle())},d.prototype.setTitleHtml=function(t){this.$title&&this.$title.html(t)},d.prototype.heightRatio=1,d.prototype.getWidgetBarOption=function(t){if(this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&t in this.widgetBarPage.widgetBarLayout.widgetBar)return this.widgetBarPage.widgetBarLayout.widgetBar[t]},l.prototype.value=function(t){return this._value},l.prototype.setValue=function(t,e){return this._value=t,this._settingsKey&&(null==t?(f("Settings debug","WigdetProperties.setValue: "+this._settingsKey,user.username),TVSettings.remove(this._settingsKey)):TVSettings.setJSON(this._settingsKey,t,e)),this._value},s.prototype.createHTML=function(){var t=this.$container;!t||t.size()<1||(t.empty(),this.layout.createHTML(),this.$wrap=$(document.createElement("div")).attr("class","widgetbar-wrap unselectable js-right-boundary").appendTo(t),this.$wrap.toggleClass("fullscreen",this.fullscreen),this.layout.$pages.appendTo(this.$wrap),h()&&this.layout.$tabs.appendTo(this.$wrap),this.layout.$deviceButton&&this.$wrap.append(this.layout.$deviceButton),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap))},o.prototype._tabRendererOptions=function(){var t=this.widgetBar,e=t._internal;return{tabs:this.pages,isDomButtonAvailable:e.isDomButtonAvailable(),isOrderPanelButtonAvailable:e.isOrderPanelButtonAvailable(),isSupportTicketButtonAvailable:e.isSupportTicketButtonAvailable(),isHelpButtonAvailable:e.isHelpButtonAvailable()}},o.prototype.updateRightToolbar=function(){this.tabRenderer.updateOptions(this._tabRendererOptions())},o.prototype.createHTML=function(){var t,e=this;e.$tabs=e.$tabscontent=$(),h()&&(e.$tabs=$('<div class="widgetbar-tabs">'),e.tabRenderer&&(e.tabRenderer.destroy(),e.tabRenderer=null),e.tabRenderer=new b(e.widgetBar,e.$tabs[0],e._tabRendererOptions()),this.widgetBar.adaptive),e.$pages=$(document.createElement("div")).attr("class","widgetbar-pages"),e.$pagescontent=$(document.createElement("div")).attr("class","widgetbar-pagescontent").appendTo(e.$pages),h()||e.$pages.css("right","-1px"),this.widgetBar.fullscreen||(e.$handle=$(document.createElement("div")).attr("class","widgetbar-handle").appendTo(e.$pages),e.$handle.on("mousedown touchstart",e.onLayoutResizeHandleMousedown.bind(e))),this.widgetBar.showCloseButton&&(e.$hider=$(document.createElement("div")).addClass("widgetbar-hider"),t=function(){var t=e.$hider.get(0);t.classList.toggle("widgetbar-hider--closed",e.isMinimized.value()),t.classList.toggle("js-hidden",h()&&e.isMinimized.value()),P.render(C.createElement(B,{isMinimized:e.isMinimized.value(),onClick:function(){e.setMinimizedState(!e.minimized)}}),t)},e.isMinimized.subscribe(t),t()),e.pages.forEach(function(t){
t.createHTML(),t.$page.appendTo(e.$pagescontent)})},r.prototype.createHTML=function(){var t=this;t.$page=$(document.createElement("div")).attr("class","widgetbar-page"),t.widgets.forEach(function(e){e.createHTML(),e.$widget.appendTo(t.$page)})},r.prototype.createTabButtonViewModel=function(){var t=this;t.tab=new _({icon:s.svgIcons[t.icon],hint:t.title,onClick:function(e){t.widgetBarLayout&&t.widgetBarLayout.onTabClick(e,t)}})},d.prototype.getTitle=function(t){var e,i,n,a=(e=this.type,i=this.getWidgetBarOption("widgetConfig"),!(n=((i=i||s.widgetConfig)[e]||0).title)&&e&&(n=(""+e).match(/[A-Z]{2,}|\d+(?:\.\d+)?|[A-Z]?[a-z]+/g).join(" ").replace(/^.|\s./g,function(t){return t.toUpperCase()})),n||void 0);return t&&this.customTitle&&a?this.customTitle.substr(0,a.length)===a?this.customTitle:a+": "+this.customTitle:this.customTitle||a||$.t("Widget")},d.prototype.createHTML=function(){var t,e=this,i=!!e.widgetConfig&&(!!e.widgetConfig.icon&&e.widgetConfig.icon),n=e.widgetConfig&&e.widgetConfig.emptyHeader,a=e.widgetConfig&&e.widgetConfig.noHeader;e.$widget=$(document.createElement("div")).attr("class","widgetbar-widget widgetbar-widget-"+e.type),e.$header=$(document.createElement("div")).attr("class","widgetbar-widgetheader"),a||e.$header.appendTo(e.$widget),e.$header.on("contextmenu",function(t){"input"!==t.target.tagName.toLowerCase()&&t.preventDefault()}),i&&(e.$headericon=$(document.createElement("div")).attr("class","widgetbar-widgetheader-icon widgetbar-widgetheader-icon-"+i).append($(s.svgIcons[i])).appendTo(e.$header)),e.$headerspace=$(document.createElement("div")).attr("class","widgetbar-headerspace").appendTo(e.$header),e.$headerspace.on("click",function(t){t.preventDefault()}),n||(e.$title=$(document.createElement("div")).attr("class","widgetbar-widgettitle").appendTo(e.$header),e.$title.text(this.getTitle())),(t=$(document.createElement("div")).attr("class","widgetbar-widgetbody").appendTo(e.$widget)).on("contextmenu",function(t){t.target.classList.contains("widgetbar-widgetbody")&&t.preventDefault()}),e._internalState.container.setValue(M(t)),e.$resizehandle=$(document.createElement("div")).attr("class","widgetbar-widgethandle").appendTo(e.$widget),e.$resizehandle.on("mousedown touchstart",function(t){e.widgetBarPage&&e.widgetBarPage.onWidgetResizeHandleMousedown(t,e)}),!0===this.maximized&&(this.toggleMaximize(!0),delete this.maximized)},o.demarshal=function(t,e){return(new o).demarshal(t,e)},r.demarshal=function(t,e){return(new r).demarshal(t,e)},d.demarshal=function(t,e){return(new d).demarshal(t,e)},o.prototype.demarshal=function(t,e){var i,n,a,s;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t&&"object"==typeof t?(this.width=+t.width,!isFinite(this.width)||this.width<=0?delete this.width:this.width<this.MIN_WIDTH&&(this.width=this.MIN_WIDTH),"minimized"in t?(this.minimized=!!t.minimized,this.isMinimized.setValue(this.minimized)):(delete this.minimized,this.isMinimized.setValue(this.minimized)),"version"in t&&(this.version=t.version),i=+t.activeIndex,n=t.activeName,a=!1,
(s=this.pages).splice(0,this.pages.length),Array.isArray(t.pages)&&t.pages.forEach(function(t,o){var d=new r({widgetBarLayout:this}).demarshal(t,e);n?t.name===n&&d&&(i=o,a=!0):d||o!==i||i--,d&&s.push(d)},this),n&&!a&&(i=0),0===s.length?(this.activeIndex=-1,this.activePageIndex.setValue(this.activeIndex)):i>=0&&i<s.length&&(this.activeIndex=i,this.activePageIndex.setValue(this.activeIndex)),this):null},r.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}if(!t||!t.widgets||!Array.isArray(t.widgets))return null;var i=this.widgets;return i.splice(0,i.length),this._gaEvent=t._gaEvent,this.title=t.title,this.name=t.name,this.icon=t.icon,this.spaceBottom=t.spaceBottom,this.spaceBottomText=t.spaceBottomText,this.onBottom=t.onBottom,this.createTabButtonViewModel(),t.widgets.forEach(function(t){var n=new d({widgetBarPage:this}).demarshal(t,e);n&&i.push(n)},this),0===i.length?null:this},d.prototype.demarshal=function(t,e){var i,n,a;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t&&"object"==typeof t?("id"in t?(this.id=t.id+"",this.type=this.id.replace(/\..*/,"")):"type"in t?(this.type=t.type+"",this.id=s.prototype.createWidgetId(this.type)):(delete this.type,delete this.id),null!=t.readonly?this.readonly=!!t.readonly:delete this.readonly,this.stateData=t.data,isFinite(+t.heightRatio)&&+t.heightRatio>=0?this.heightRatio=+t.heightRatio:delete this.heightRatio,!0===t.maximized&&(this.maximized=!0),!0===t.unAuthEditable&&(this.unAuthEditable=!0),t.settingsKey?i=t.settingsKey:this.id&&(n=this.getWidgetBarOption("_settingsPrefix"))&&(i=n+".widget."+this.id),this.properties=new l({widgetBarWidget:this,settingsKey:i}),null==t.properties||i&&null!==this.properties.value()||this.properties.setValue(t.properties),"news"!==this.type&&"hotlist"!==this.type||!i||this.properties.setValue($.extend(!0,{},t.properties,this.properties.value())),"hotlist"===this.type&&!i&&t.properties&&this.properties.setValue(t.properties),this.widgetConfig=null,(a=this.getWidgetBarOption("widgetConfig"))[this.type]&&(this.widgetConfig=a[this.type]),this):null},o.prototype.marshal=function(t){var e,i,n,a,s=[];for(this.pages.forEach(function(e){var i=e.marshal(t);i&&(s=s.concat(i))}),e={},i=0;i<s.length;i++)s[i].type&&(n=s[i].type,s[i].id&&delete s[i].type,e[n]?e[n].push(s[i]):e[n]=[s[i]]);return a={widgets:e,settings:{}},["minimized","width","activeIndex","version","activeName"].forEach(function(t){this[t]!==o.prototype[t]&&(a.settings[t]=this[t])},this),a},r.prototype.marshal=function(t){var e=[];return this.widgets.forEach(function(i){var n=i.marshal(t);n&&e.push(n)}),0===e.length?null:e},d.prototype.marshal=function(t){var e={};return this.id&&(e.id=this.id),this.type&&(e.type=this.type),["heightRatio"].forEach(function(t){this[t]!==d.prototype[t]&&(e[t]=this[t])},this),this.widgetMaximized.value()&&(e.maximized=!0),t&&t.includeWidgetProperties&&this.properties&&(e.properties=TradingView.clone(this.properties.value())),e},t.exports.WidgetBar=s}).call(this,i("Kxc7"),i("hY0g"),i("aIyQ"))},"Fb/L":function(t,e,i){
"use strict";var n,a;i.r(e),i.d(e,"WidgetBarInternal",function(){return a}),n=i("Kxc7"),a=function(){function t(){}return t.prototype.isHelpButtonAvailable=function(){return!n.enabled("widget")&&!n.enabled("charting_library_base")},t.prototype.isSupportTicketButtonAvailable=function(){return n.enabled("bugreport_button")},t.prototype.isDomButtonAvailable=function(){return n.enabled("dome_widget")},t.prototype.isOrderPanelButtonAvailable=function(){return n.enabled("order_panel")},t}()},HSWI:function(t,e,i){t.exports={filler:"filler-3UAoz6aE"}},"If+W":function(t,e,i){t.exports={toolbar:"toolbar-1A0PjTA7",isGrayed:"isGrayed-1AzrEXYM"}},Opoj:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17"><path fill="none" stroke="currentColor" d="M1 1l15 15M1 16L16 1"/></svg>'},PW1O:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m17 30a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m6 5a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m10 5a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2"/></svg>'},PiKd:function(t,e,i){"use strict";function n(t){return o.filter(function(e){return e.m===t})[0]}function a(t){var e=n(t);e&&e.cb&&$.when(e.cb()).done(function(){e.state="loaded",e.args=Array.prototype.slice.call(arguments),delete e.cb,s(e.m)})}function s(t){var e=n(t),i=function t(i){i&&!i.length||(i.shift().apply(null,e.args),t(i))},a=r[t];a&&i(a)}var o,r,d;Object.defineProperty(e,"__esModule",{value:!0}),e.isExists=function(t){return!!n(t)},e.load=function(t,e,i){if(e){var s=n(t);s?s.cb=e:o.push({m:t,cb:e})}(void 0!==i||d)&&function(t,e){"number"==typeof e?setTimeout(function(){return a(t)},e):(!0===e||d)&&a(t)}(t,i)},e.isLoaded=function(t){var e=n(t);return e&&"loaded"===e.state},e.onReady=function(t,e){var i=n(t);r[t]=r[t]||[],r[t].push(e),i&&"loaded"===i.state&&s(t)},o=[],r={},d=!1,setTimeout(function(){var t;for(d=!0,t=0;t<o.length;t+=1)a(o[t].m)},5e3)},YvYu:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45"><path fill="currentcolor" d="M16.5 21.5l8.146 8.146a.914.914 0 0 1-1.292 1.293L16.5 24.086l-6.854 6.853a.914.914 0 0 1-1.292-1.293L16.5 21.5zm0 4l6.146 6.146a1.914 1.914 0 0 0 2.708-2.707L16.5 20.086l-8.854 8.853a1.914 1.914 0 1 0 2.708 2.707L16.5 25.5zm13 0l8.146-8.146a.914.914 0 0 0-1.292-1.293L29.5 22.914l-6.854-6.853a.914.914 0 0 0-1.292 1.293L29.5 25.5zm0-4l6.146-6.146a1.914 1.914 0 0 1 2.708 2.707L29.5 26.914l-8.854-8.853a1.914 1.914 0 1 1 2.708-2.707L29.5 21.5z"/></svg>'},ai7J:function(t,e,i){t.exports={separator:"separator-3EpY15lj"}},dCE3:function(t,e,i){t.exports={
button:"button-ef8Q4JWf",icon:"icon-1i5UojWG"}},dECE:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m29.5 11a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5v-14a4.5 4.5 0 0 1 4.5-4.5m0 1a3.5 3.5 0 0 0-3.5 3.5v14a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5M15 17v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z"/></svg>'},dkCg:function(t,e,i){"use strict";function n(t){var e=c(t.className,p.button,t.isGrayed&&p.isGrayed);return d.createElement("div",{className:e,onClick:t.onClick,"data-role":"button","data-name":t.name},d.createElement(u.a,{className:p.icon,icon:w}))}function a(t){t=Object(h.__assign)({isTab:!0,theme:m},t);var e=c(t.className,t.theme.button,t.isTab&&t.theme.isTab,t.isActive&&t.theme.isActive,t.isGrayed&&t.theme.isGrayed,t.hint&&"apply-common-tooltip common-tooltip-vertical");return d.createElement("div",{className:e,title:t.hint,onClick:t.onClick,"data-role":"button","data-name":t.name},d.createElement("div",{className:t.theme.hoverMask}),d.createElement(u.a,{icon:t.icon}),d.createElement("div",{className:t.theme.counterRow},d.createElement("span",{className:t.theme.counter,"data-name":"counter"},t.count)))}function s(t){return d.createElement("div",{className:c(t.className,$.separator)})}function o(t){return d.createElement("div",{className:c(S.filler,t.className)})}function r(t,e){return function(i){function n(t){var n=i.call(this,t)||this;return n._bindedForceUpdate=function(){return n.forceUpdate()},n.state={viewModel:e},n}return Object(h.__extends)(n,i),n.prototype.componentDidMount=function(){var t=this.state.viewModel;t.notificationsCount.subscribe(this._bindedForceUpdate),t.isActive.subscribe(this._bindedForceUpdate)},n.prototype.componentWillUnmount=function(){var t=this.state.viewModel;t.notificationsCount.unsubscribe(this._bindedForceUpdate),t.isActive.unsubscribe(this._bindedForceUpdate)},n.prototype.render=function(){var e=this.state.viewModel,i=e.notificationsCount.value();return d.createElement(t,Object(h.__assign)({},this.props,{icon:e.icon.value(),isActive:e.isActive.value(),onClick:e.onClick.value(),hint:e.hint.value(),count:0!==i?i.toString():void 0}))},n}(d.PureComponent)}var d,l,h,g,c,u,p,w,f,m,v,y,b,_,B,P,C,T,W,$,S,x,A,M,O,z,E,V,L;i.r(e),d=i("q1tI"),l=i("i8i4"),i("bf9a"),h=i("mrSG"),g=i("17x9"),c=i("TSYQ"),u=i("jjrI"),p=i("dCE3"),w=i("Opoj"),f=i("5AaZ"),m=i("1Pr8"),v=i("vOQ2"),y=i("Eyy1"),b=i("PW1O"),_=window.t("DOM"),B=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._handleClick=function(){(0,Object(y.ensure)(n.context.widgetBar.tradingPanelAccessor).setDomPanelVisibility)(!n.state.isActive)},n._handleIsOpenedChange=function(){n.setState({isActive:n._tradingPanel.isPageOpened(v.d.DomPanel)})},n._handleActivePageChange=function(t){n._tradingPanel.isOpened.value()&&n.setState({isActive:t===v.d.DomPanel})},n._tradingPanel=Object(y.ensure)(n.context.widgetBar.tradingPanelAccessor).tradingPanel,n.state={
isActive:n._tradingPanel.isPageOpened(v.d.DomPanel)},n}return Object(h.__extends)(e,t),e.prototype.componentDidMount=function(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)},e.prototype.componentWillUnmount=function(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)},e.prototype.render=function(){return d.createElement(a,Object(h.__assign)({},this.props,{icon:b,hint:_,isActive:this.state.isActive,onClick:this._handleClick}))},e.contextTypes={widgetBar:g.any.isRequired},e}(d.PureComponent),P=i("PC8g"),C=i("YvYu"),T=window.t("Order Panel"),W=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._handleClick=function(){var t=Object(y.ensure)(n.context.widgetBar.tradingPanelAccessor).setOrderPanelVisibility,e=!n.state.isActive;t(e),e&&Object(P.trackEvent)("GUI","Open Order Panel")},n._handleIsOpenedChange=function(){n.setState({isActive:n._tradingPanel.isPageOpened(v.d.OrderPanel)})},n._handleActivePageChange=function(t){n._tradingPanel.isOpened.value()&&n.setState({isActive:t===v.d.OrderPanel})},n._tradingPanel=Object(y.ensure)(n.context.widgetBar.tradingPanelAccessor).tradingPanel,n.state={isActive:n._tradingPanel.isPageOpened(v.d.OrderPanel)},n}return Object(h.__extends)(e,t),e.prototype.componentDidMount=function(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)},e.prototype.componentWillUnmount=function(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)},e.prototype.render=function(){return d.createElement(a,Object(h.__assign)({},this.props,{icon:C,hint:T,isActive:this.state.isActive,onClick:this._handleClick}))},e.contextTypes={widgetBar:g.any.isRequired},e}(d.PureComponent),$=i("ai7J"),S=i("HSWI"),x=i("XAms"),A=i("uOxu"),M=i("8d0Q"),O=i("If+W"),z=Object(A.getLogger)("Platform.GUI.RightToolbar"),E=function(t){function e(e,i){var n,s,o=t.call(this,e,i)||this;return o._pages={},o._isTradingPanelCanBeShown=null,o._tradingActivePage=null,o._isTradingPanelOpened=null,o._handleMouseOver=function(t){Object(M.a)(t)&&o.setState({isHovered:!0})},o._handleMouseOut=function(t){Object(M.a)(t)&&o.setState({isHovered:!1})},o._handleFullscreenChange=function(t){o.setState({isFullscreen:t})},o._handleCloseClick=function(){o.context.widgetBar.layout.setMinimizedState(!0)},o._handleGrayedChange=function(){o.setState({isGrayed:o._isGrayed()})},o._handleDomButtonVisibilityChange=function(t){o.setState({isTradingButtonsVisible:t})},o._isGrayed=function(){var t=o._isMinimized.value();return null!==o._isTradingPanelOpened&&(t=t&&!o._isTradingPanelOpened.value()),!t},n=o.context.widgetBar,o._isMinimized=n.layout.isMinimized.spawn(),o._isFullscreen=n.resizerBridge.fullscreen.spawn(),n.tradingPanelAccessor&&(s=n.tradingPanelAccessor.tradingPanel,
o._isTradingPanelCanBeShown=s.isAvailable.spawn(),o._tradingActivePage=s.activePage.spawn(),o._isTradingPanelOpened=s.isOpened.spawn()),o.state={isHovered:!1,isGrayed:o._isGrayed(),isFullscreen:o._isFullscreen.value(),isTradingButtonsVisible:!1},o._isTradingPanelCanBeShown&&(o.state=Object(h.__assign)(Object(h.__assign)({},o.state),{isTradingButtonsVisible:o._isTradingPanelCanBeShown.value()})),n.layout.pages.forEach(function(t){void 0===t.name&&z.logWarn('Page does not provide required field "name"'),o._pages[t.name]=r(a,t.tab)}),o._toolset=o._createToolset(),o}return Object(h.__extends)(e,t),e.prototype.componentDidMount=function(){this._isFullscreen.subscribe(this._handleFullscreenChange),this._isMinimized.subscribe(this._handleGrayedChange),null!==this._isTradingPanelCanBeShown&&this._isTradingPanelCanBeShown.subscribe(this._handleDomButtonVisibilityChange),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.subscribe(this._handleGrayedChange)},e.prototype.componentWillUnmount=function(){this._isFullscreen.destroy(),this._isMinimized.destroy(),null!==this._isTradingPanelCanBeShown&&this._isTradingPanelCanBeShown.destroy(),null!==this._tradingActivePage&&this._tradingActivePage.destroy(),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.destroy()},e.prototype.render=function(){var t=this.props,e=t.className,i=t.isDomButtonAvailable,a=t.isOrderPanelButtonAvailable,r=this.state,l=r.isHovered,h=r.isGrayed,g=r.isFullscreen,u=r.isTradingButtonsVisible,p=this.context.widgetBar,w=this._toolset,m=a&&u,v=i&&u;return d.createElement(f.a,{isVisibleFade:Modernizr.mobiletouch,isVisibleButtons:!Modernizr.mobiletouch&&l,isVisibleScrollbar:!1,onMouseOver:this._handleMouseOver,onMouseOut:this._handleMouseOut},d.createElement("div",{className:c(e,O.toolbar,h&&O.isGrayed),"data-name":"right-toolbar",onContextMenu:x.a},p.adaptive&&g&&d.createElement(n,{name:"close-button",onClick:this._handleCloseClick}),this._renderPages(),(m||v)&&d.createElement(s,null),m&&d.createElement(W,{name:"order-panel-button",isGrayed:h}),v&&d.createElement(B,{name:"dom-button",isGrayed:h}),d.createElement(o,null),this._renderPages(!0),w.SupportTicketButton&&d.createElement(w.SupportTicketButton,{name:"bug-report-button",isGrayed:h,isTab:!1}),w.HelpButton&&d.createElement(w.HelpButton,{name:"help-button",isGrayed:h,isTab:!1})))},e.prototype._renderPages=function(t){var e=this,i=[],n=this.state.isGrayed,a=this.context.widgetBar,o=a.layout.pages;return o.forEach(function(a){if(a.name in e._pages&&Boolean(a.onBottom)===Boolean(t)){var o=e._pages[a.name];i.push(d.createElement(o,{name:a.name,isGrayed:n,key:a.name})),a.spaceBottom&&i.push(d.createElement(s,{key:a.spaceBottomText}))}}),i},e.prototype._createToolset=function(){var t=this.context.widgetBar;return{SupportTicketButton:this.props.isSupportTicketButtonAvailable?r(a,t.ensureSupportTicketButtonViewModel()):void 0,HelpButton:this.props.isHelpButtonAvailable?r(a,t.ensureHelpButtonViewModel()):void 0}},e.contextTypes={widgetBar:g.any.isRequired},e}(d.PureComponent),V=function(t){
function e(){return null!==t&&t.apply(this,arguments)||this}return Object(h.__extends)(e,t),e.prototype.getChildContext=function(){return{widgetBar:this.props.widgetBar}},e.prototype.render=function(){return this.props.children},e.childContextTypes={widgetBar:g.any},e}(d.PureComponent),i.d(e,"RightToolbarRenderer",function(){return L}),L=function(){function t(t,e,i){this._widgetBar=t,this._container=e,this._options=i,this._render()}return t.prototype.updateOptions=function(t){this._options=t,this._render()},t.prototype.destroy=function(){l.unmountComponentAtNode(this._container)},t.prototype._render=function(){l.render(d.createElement(V,{widgetBar:this._widgetBar},d.createElement(E,{isDomButtonAvailable:this._options.isDomButtonAvailable,isOrderPanelButtonAvailable:this._options.isOrderPanelButtonAvailable,isHelpButtonAvailable:this._options.isHelpButtonAvailable,isSupportTicketButtonAvailable:this._options.isSupportTicketButtonAvailable})),this._container)},t}()},e9Yb:function(t,e,i){},jkvV:function(t,e,i){"use strict";function n(t){var e=s(t.className,"apply-common-tooltip","common-tooltip-vertical","common-tooltip-otl");return a.createElement("div",{className:e,onClick:t.onClick,title:t.isMinimized?d:r},a.createElement(o.b,{direction:t.isMinimized?"left":"right"}))}var a,s,o,r,d;i.r(e),i.d(e,"Hider",function(){return n}),i("YFKU"),a=i("q1tI"),s=i("TSYQ"),o=i("EKk7"),r=window.t("Hide Tab"),d=window.t("Open Tab")},tBUM:function(t,e,i){"use strict";var n,a,s,o,r;i.r(e),i.d(e,"WidgetBarTabButtonViewModel",function(){return r}),n=i("mrSG"),a=i("hY0g"),s=i.n(a),o={isActive:!1,notificationCount:0},r=function(){function t(t){var e=Object(n.__assign)(Object(n.__assign)({},o),t);this.isActive=new s.a(e.isActive),this.notificationsCount=new s.a(e.notificationCount),this.icon=new s.a(e.icon),this.hint=new s.a(e.hint),this.onClick=new s.a(e.onClick)}return t.prototype.onActiveStateChange=function(t){this.isActive.setValue(t)},t.prototype.updateNotifications=function(t){this.notificationsCount.setValue(t)},t}()},vOQ2:function(t,e,i){"use strict";var n,a,s,o;i.d(e,"d",function(){return n}),i.d(e,"a",function(){return a}),i.d(e,"c",function(){return s}),i.d(e,"b",function(){return o}),function(t){t.DomPanel="domPanel",t.OrderPanel="orderPanel"}(n||(n={})),a=400,s=296,o=451}}]);