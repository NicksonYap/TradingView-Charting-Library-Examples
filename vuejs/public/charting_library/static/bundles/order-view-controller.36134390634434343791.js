(window.webpackJsonp=window.webpackJsonp||[]).push([["order-view-controller"],{"+AwB":function(t,e,i){"use strict";var r=i("rRE7"),s=i("PIcZ"),o=i("SUh3"),n=i("H9Zw"),u=i("z6YP");e.startWith=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){var i,a=e[e.length-1];return u.isScheduler(a)?e.pop():a=null,1===(i=e.length)?n.concat(new s.ScalarObservable(e[0],a),t):i>1?n.concat(new r.ArrayObservable(e,a),t):n.concat(new o.EmptyObservable(a),t)}}},"+EyI":function(t,e,i){"use strict";var r=i("NVK1");e.map=function(t,e){return r.map(t,e)(this)}},"/Trf":function(t,e,i){"use strict";e.isPromise=function(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}},"0rc0":function(t,e,i){"use strict";function r(t){var e=new O.BehaviorSubject(t.value()),i=function(t){e.next(t)};return t.subscribe(i),{subject:e,unsubscribe:function(){return t.unsubscribe(i)}}}function s(t,e){return Object(j.deepEquals)(t,e)[0]}function o(t){return void 0!==t&&Boolean(t.showTotal)}function n(t){return t<1?Math.abs(Math.floor(Math.log10(t))):2}function u(t,e){if(void 0!==t)return t;if(void 0!==e){var i=Math.round(1/e);return String(i)+":1"}return null}function a(t,e,i){return null!==t?(void 0!==i?t*i:t)*e:0}function c(t,e,i,r,s){return null!==t?(void 0!==s?t*s:t)*e/r*i:0}function l(t,e){return void 0!==e?t*e:0}function h(t,e){var i=0!==e?100*t/e:0;return i>100?100:i}function d(t){if("number"==typeof t){var e=Object(T.splitThousands)((t||0).toFixed(2)," ");return Number.isInteger(t)||t>=1?e:function(t){if(Number.isInteger(t))return t+"";return t<1?function(t){for(var e=(t+"").split(".")[1]||"",i=e.length,r=0;r<e.length;r++)if("0"!==e[r]){i=r+1;break}return t.toFixed(i)}(t):t.toFixed(2)}(t)}return Object(T.splitThousands)(t," ")}function p(t,e){return null!==t&&null!==e&&t/e>0?N.format(t/e):""}function b(t,e){var i=Object.assign({},t),r=["trade","ask","bid"];return r.forEach(function(t){var r=i[t];void 0!==r&&(i[t]=function(t,e){return e>1?t:Object(M.fixComputationError)(Math.round(t/e)*e)}(r,e))}),i}function f(t,e){var i,r;return 0!==e&&(i=new k.Big(t),r=new k.Big(e),i.mod(r).eq(0))}function _(t){return Object(j.isNumber)(t.ask)?t.ask:Object(j.isNumber)(t.trade)?t.trade:0}function y(t){return Object(j.isNumber)(t.bid)?t.bid:Object(j.isNumber)(t.trade)?t.trade:0}function v(t){return Object(j.isNumber)(t.trade)?t.trade:0}function m(t,e){return 1===t?_(e):y(e)}function w(t,e){return"crypto"===t.type?t.currency||"":e.currencySign||e.currency||t.currency||""}function P(t,e,i){return 4===t?null===e||null===i:3===t?null===i:null===e}function g(t,e){switch(e){case x.b.IncDec:return t<0?"-":"+";case x.b.PlusValue:return String(t);case x.b.Clear:return"Clear";default:return"Default"}}function S(t,e,i,r){var s=[];return void 0!==i&&Array.isArray(i.customFields)&&i.customFields.forEach(function(i){var o,n,u;"TextWithCheckBox"===i.inputType&&s.push({id:i.id,type:i.inputType,inputType:i.customInfo.asterix?"password":"text",placeholder:i.placeHolder||"",title:i.title||"",checkboxTitle:i.customInfo.checkboxTitle,
text:new V.a(i.value.text),checked:new V.a(i.value.checked),status:e,onControlFocused:new E.a}),"ComboBox"===i.inputType&&Array.isArray(i.items)&&(o=i.items[0],n=i.id,r&&n in r&&(u=r[n],o=i.items.filter(function(t){return t.value===u})[0]),s.push({id:i.id,type:i.inputType,title:i.title,items:i.preventModify&&t?[o]:i.items,selectedItem:new V.a(o.value),onControlFocused:new E.a,saveToSettings:i.saveToSettings}))}),s}var O,k,M,C,V,j,T,I,x,B,E,N,L,F;i.d(e,"t",function(){return r}),i.d(e,"g",function(){return s}),i.d(e,"v",function(){return o}),i.d(e,"n",function(){return n}),i.d(e,"i",function(){return u}),i.d(e,"b",function(){return a}),i.d(e,"c",function(){return c}),i.d(e,"d",function(){return l}),i.d(e,"e",function(){return h}),i.d(e,"j",function(){return d}),i.d(e,"k",function(){return p}),i.d(e,"a",function(){return b}),i.d(e,"s",function(){return f}),i.d(e,"l",function(){return _}),i.d(e,"m",function(){return y}),i.d(e,"p",function(){return v}),i.d(e,"q",function(){return m}),i.d(e,"o",function(){return w}),i.d(e,"f",function(){return P}),i.d(e,"u",function(){return g}),i.d(e,"r",function(){return F}),i.d(e,"h",function(){return S}),O=i("nDsj"),k=i("nc0P"),M=i("ivNn"),C=i("hY0g"),V=i.n(C),j=i("ogJP"),T=i("9XXR"),I=i("nEwK"),x=i("lZfC"),B=i("aIyQ"),E=i.n(B),N=new I.VolumeFormatter(2),L="Â ",F={buy:{market:function(t,e){return window.t("Buy {qty} {symbol}{whitespaceNoBreak}MKT").format({qty:t,symbol:e,whitespaceNoBreak:L})},stop:function(t,e,i){return window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP").format({qty:t,symbol:e,stopPrice:i,whitespaceNoBreak:L})},limit:function(t,e,i){return window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,limitPrice:i,whitespaceNoBreak:L})},stopLimit:function(t,e,i,r){return window.t("Buy {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,stopPrice:i,limitPrice:r,whitespaceNoBreak:L})}},sell:{market:function(t,e){return window.t("Sell {qty} {symbol}{whitespaceNoBreak}MKT").format({qty:t,symbol:e,whitespaceNoBreak:L})},stop:function(t,e,i){return window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP").format({qty:t,symbol:e,stopPrice:i,whitespaceNoBreak:L})},limit:function(t,e,i){return window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,limitPrice:i,whitespaceNoBreak:L})},stopLimit:function(t,e,i,r){return window.t("Sell {qty} {symbol}{whitespaceNoBreak}@ {stopPrice}{whitespaceNoBreak}STP {limitPrice}{whitespaceNoBreak}LMT").format({qty:t,symbol:e,stopPrice:i,limitPrice:r,whitespaceNoBreak:L})}}}},"10Uv":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("1Re5"),o=function(t){function e(e,i){t.call(this,e,i),this.scheduler=e,this.work=i}return r(e,t),
e.prototype.schedule=function(e,i){return void 0===i&&(i=0),i>0?t.prototype.schedule.call(this,e,i):(this.delay=i,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,i){return i>0||this.closed?t.prototype.execute.call(this,e,i):this._execute(e,i)},e.prototype.requestAsyncId=function(e,i,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,i,r):e.flush(this)},e}(s.AsyncAction);e.QueueAction=o},"1R9w":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=function(t){function e(e){t.call(this),this.errors=e;var i=Error.call(this,e?e.length+" errors occurred during unsubscription:\n  "+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=i.name="UnsubscriptionError",this.stack=i.stack,this.message=i.message}return r(e,t),e}(Error);e.UnsubscriptionError=s},"1Re5":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("tSeh"),o=i("C7Jb"),n=function(t){function e(e,i){t.call(this,e,i),this.scheduler=e,this.pending=!1,this.work=i}return r(e,t),e.prototype.schedule=function(t,e){var i,r;return void 0===e&&(e=0),this.closed?this:(this.state=t,this.pending=!0,i=this.id,r=this.scheduler,null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this)},e.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),s.root.setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return e;s.root.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var i=!1,r=void 0;try{this.work(t)}catch(t){i=!0,r=!!t&&t||new Error(t)}if(i)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(o.Action);e.AsyncAction=n},"1ouX":function(t,e,i){"use strict";var r=i("10Uv"),s=i("9zIo");e.queue=new s.QueueScheduler(r.QueueAction)},"22vd":function(t,e,i){"use strict";e.identity=function(t){return t}},"35Wn":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("rfFC"),o=function(t){function e(){t.apply(this,arguments)}return r(e,t),
e.prototype.notifyNext=function(t,e,i,r,s){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(s.Subscriber);e.OuterSubscriber=o},"3bpA":function(t,e,i){"use strict";function r(t,e,i,r){if(!e)return 0;var s=t/(e*i);return Math.floor(Object(F.fixComputationError)(s/r*r))}function s(t,e,i,r,s){if(!i)return 0;var o=t*e/(i*r*100);return Math.floor(Object(F.fixComputationError)(o/s*s))}function o(t,e,i){return Object(F.fixComputationError)(e*i*t)}function n(t,e,i,r){return r&&t?Object(F.fixComputationError)(e*i*t*100/r):0}function u(t,e,i,r){return Object(F.fixComputationError)((t-e)/(r*i))}function a(t,e,i,r){return e?Math.floor(Object(F.fixComputationError)(t/(i*e*(r||1)))):0}function c(t,e,i,r,s){return e?Math.floor(Object(F.fixComputationError)(t*i/(r*e*(s||1)*100))):0}function l(t,e,i,r){return Object(F.fixComputationError)(i*t*r+e)}function h(t,e,i,r){return t*i*e*(r||1)}function d(t,e,i,r,s){return i?t*r*e*(s||1)*100/i:0}function p(t,e,i){return t.catch(function(t){return ut.logError(t),i&&i(),e})}function b(){return Promise.all([i.e("react"),i.e(1),i.e(2),i.e(3),i.e(5),i.e(7),i.e(10),i.e(11),i.e(13),i.e(15),i.e(17),i.e(19),i.e(32),i.e(38),i.e(56),i.e(63),i.e(73),i.e(0),i.e(4),i.e(6),i.e(8),i.e(9),i.e(14),i.e(34),i.e(49),i.e(58),i.e("order-widget")]).then(i.bind(null,"IkHa"))}function f(){return Promise.all([i.e("react"),i.e(1),i.e(2),i.e(3),i.e(5),i.e(7),i.e(11),i.e(13),i.e(15),i.e(17),i.e(19),i.e(38),i.e(56),i.e(87),i.e(0),i.e(4),i.e(6),i.e(9),i.e(14),i.e(34),i.e(49),i.e("position-widget")]).then(i.bind(null,"CWem"))}var _,y,v,m,w,P,g,S,O,k,M,C,V,j,T,I,x,B,E,N,L,F,q,A,R,D,$,W,z,U,Q,H,K,Y,G,X,J,Z,tt,et,it,rt,st,ot,nt,ut,at,ct,lt,ht,dt,pt,bt,ft,_t,yt,vt,mt,wt;i.r(e),_=i("mrSG"),i("YFKU"),y=i("Kxc7"),v=i("Vdly"),m=i("PT1i"),w=i("en3B"),P=i("NbG7"),g=i("ldgD"),i("xDhC"),i("G7k4"),i("MSNS"),i("mPU7"),S=i("4c1C"),O=i("nDsj"),k=i("Eyy1"),M=i("ogJP"),C=i("0waE"),V=i("aIyQ"),j=i.n(V),T=i("hY0g"),I=i.n(T),x=window.t("Long"),B=window.t("Short"),E=function(){function t(t,e,i,r,s,o,n,u,a,c,l){var h=this;this.description="",this.isTradable=!0,this._pinButtonClicked=new j.a,this._backButtonClicked=new j.a,this._cancelButtonClicked=new j.a,this._closeButtonClicked=new j.a,this._onStatusChanged=function(){h.hasBackButton.setValue(h._hasBackButton()),h.hasCloseButton.setValue(!0),h.hasCancelButton.setValue(h._hasCancelButton()),h.description=h._text(),h.title=h._title()},this._onQuotes=function(t){h.hasDelayedWarning.setValue(Boolean(t.isDelayed))},this._data=c,this._symbol=t,this._formatter=l,this._brokerName=e,this.status=r,this._mode=i,this.type=s,this._existingOrder=o,this.isTradable=n,this.ticketCanBePanel=a,this.hasBackButton=new I.a(this._hasBackButton()),this.hasCloseButton=new I.a(!0),this.hasCancelButton=new I.a(!1),this.hasDelayedWarning=new I.a(!1),this.title=this._title(),this.description=this._text(),this.status.subscribe(this._onStatusChanged),this._mode.subscribe(this._onStatusChanged),
u&&(this._quotesSubscription=u.subscribe(this._onQuotes))}return t.prototype.unsubscribe=function(){this._mode.unsubscribe(this._onStatusChanged),this.status.unsubscribe(this._onStatusChanged),this._quotesSubscription&&this._quotesSubscription.unsubscribe()},t.prototype.showCancelButton=function(){this.hasCancelButton.setValue(!0)},t.prototype.hideCancelButton=function(){this.hasCancelButton.setValue(!1)},t.prototype.back=function(){this._backButtonClicked.fire()},t.prototype.pin=function(){this._pinButtonClicked.fire()},t.prototype.cancel=function(){this._cancelButtonClicked.fire()},t.prototype.close=function(){this._closeButtonClicked.fire()},t.prototype.pinButtonClicked=function(){return this._pinButtonClicked},t.prototype.backButtonClicked=function(){return this._backButtonClicked},t.prototype.cancelButtonClicked=function(){return this._cancelButtonClicked},t.prototype.closeButtonClicked=function(){return this._closeButtonClicked},t.prototype._hasBackButton=function(){return!(this._mode.value()!==w.f.Panel||!this._existingOrder&&2!==this.type&&this.status.value()!==w.g.Preview)},t.prototype._hasCancelButton=function(){return this._mode.value()===w.f.Panel&&this.status.value()===w.g.Active&&!this._existingOrder&&2!==this.type},t.prototype._title=function(){return this.status.value()===w.g.Preview?window.t("Order confirmation"):this._symbol},t.prototype._text=function(){var t,e,i;return this.status.value()===w.g.Preview?"":this._existingOrder&&this._data&&this._formatter?2===this.type?(t=this._data.side,e=this._data.qty,i=this._formatter.format(this._data.price||this._data.avgPrice||this._data.limitPrice),", "+(1===t?x:B)+" "+e+" @ "+i):", "+window.t("order")+" "+this._data.id:this._brokerName?", "+this._brokerName:""},t}(),N=i("0rc0"),L=function(){function t(t,e,i,r,s){this.quotes=new I.a({ask:" ",bid:" "}),this.onControlFocused=new j.a,this.id=Object(C.randomHashN)(6),this._waitQuotesTimeout=null,this._priceFormatter=e,this._spreadFormatter=i,this._quotes=t,this.side=new I.a(r),this.status=s,this._subcsription=Object(N.t)(this.side),this.$value=this._subcsription.subject}return t.prototype.subscribe=function(){var t=this;return this._waitQuotesTimeout=setTimeout(function(){return t.quotes.setValue({})},5e3),this._quotes.subscribe(function(e){t.quotes.setValue(t._generateText(e)),t._waitQuotesTimeout&&(clearTimeout(t._waitQuotesTimeout),t._waitQuotesTimeout=null)})},t.prototype.unsubscribe=function(){this._subcsription.unsubscribe(),this._waitQuotesTimeout&&(clearTimeout(this._waitQuotesTimeout),this._waitQuotesTimeout=null)},t.prototype._generateText=function(t){var e={},i=Object(N.l)(t),r=Object(N.m)(t);return e.ask=this._priceFormatter.format(i),e.bid=this._priceFormatter.format(r),e.spread=Object(M.isNumber)(t.spread)?this._spreadFormatter.format(t.spread):this._priceFormatter.format(i-r),e},t}(),i("JwtW"),i("4XzM"),F=i("ivNn"),q=function(t){function e(e,i){var r=t.call(this,e)||this;return r._comparator=i,r}return Object(_.__extends)(e,t),e.prototype.setValue=function(e,i){
!1===this._comparator(this.value(),e)&&t.prototype.setValue.call(this,e,i)},e}(I.a),A=i("VVyh"),R=i("4qhP"),D=window.t("Order price is not appropriate for this order type/direction."),$=window.t("Order price is too close to the market price. It can lead to placing wrong order type due to specifics of the order placement in {brokerTitle}"),W=function(){function t(t,e,i,r,s,o,n,u,a,c,l,h){var d,p=this;this.id=Object(C.randomHashN)(6),this.price=new I.a(null),this.displayPrice=new I.a(""),this.relativePrice=new q(null,N.g),this.priceError=new I.a,this.quotes=new q({ask:0,bid:0,last:0},N.g),this.side=new I.a,this.step=new I.a,this.error=new q({res:!1},N.g),this.onControlFocused=new j.a,this.$value=new O.BehaviorSubject(null),this._controlError=new O.BehaviorSubject(!1),this._syncPrice=null,this._symbolType="",this._priceRules=[],this.setControlError=function(t){p._controlError.next(t)},this._isPriceRules=function(t){return"limitPriceDistance"===t.id||"stopPriceDistance"===t.id},this._updateFocusIfNeeded=function(){1!==p.focusedControl.value()||!p.isRelativePriceControlHidden&&p._settings.value().showRelativePriceControl||p.focusedControl.setValue(0)},this.side.setValue(e.getValue()||1),this._instrumentInfo=i,this.status=r,this.orderType=n,this._isLimitPrice=u,this._settings=a,this._settings.subscribe(this._updateFocusIfNeeded),this.isRelativePriceControlHidden=this._roundToStepRequired(),this._setStep(),this.formatter=o,d=h||this.isRelativePriceControlHidden||!this._settings.value().showRelativePriceControl,this.focusedControl=new I.a(d?0:1),this.displayPrice.setValue(this.formatter.format(0)),void 0!==s&&(this.forceAbsolutePriceUpdate(s),this.$value.next(this.price.value())),this._symbolType=i.type||"",this._quotes=t,this._side=e,this._priceSubscription=Object(N.t)(this.price),this._orderTypeSubscription=Object(N.t)(this.orderType),this._orderTypeSubj=this._orderTypeSubscription.subject,this._resultSubscription=S.Observable.combineLatest(this._priceSubscription.subject,this._quotes,this._side,this._orderTypeSubscription.subject,this._controlError).subscribe(function(t){var e=t[0],i=t[1],r=t[2],s=t[3],o=t[4],n=Object(N.q)(r,i),u="forex"===p._symbolType,a=null!==e&&null!==s&&2!==s?function(t,e,i,r,s,o,n,u){var a=Math.abs(e-t)>t/2&&t>1,c=function(t,e,i,r,s){var o=1===r&&1===i,n=-1===r&&1===i,u=1===r&&3===i,a=-1===r&&3===i,c=3===i||s;return c&&((o||a)&&t>e||(n||u)&&t<e)}(t,e,i,r,s),l=t>=0,h=t<=100*e,d=!l||!h||c||a;return s&&!u||!1!==Object(N.s)(t,n)?{res:d,severity:"error",msg:d?D:void 0}:{res:!0,msg:window.t("Order price should be a multiple of {minTick}").format({minTick:o.format(n)})}}(e,n,s,r,u,p.formatter,p.step.value(),p._roundToStepRequired()):{res:!1},c=null!==e?p._checkPriceWarning(e,i):{res:!1},l=p.status.value(),h=l!==w.g.Wait,d=a.res||o||c.res,b=a.res||o?"error":"warning",f=o?void 0:a.res?a.msg:c.msg;p.error.setValue({res:!!h&&d,severity:b,msg:h?f:void 0}),p.$value.next(a.res||o?null:e)}),this._pipSize=i.pipSize,this._priceRules=(l||[]).filter(this._isPriceRules),this._brokerTitle=c}
return t.prototype.onAbsolutePriceSelected=function(t){var e,i,r=this.formatter.parse(t);r.res?(this.price.setValue(r.price),this.displayPrice.setValue(t)):this.displayPrice.setValue(t),e=this._isLimitPrice&&4===this.orderType.value()&&null!==this._syncPrice?this._syncPrice:this._getQuotesBySide(this.side.value()),i={base:this._getBase(this.side.value(),this.orderType.value()),offset:this._calcOffset(r.res?r.price:0,e,this.step.value())},this.relativePrice.setValue(i)},t.prototype.onRelativePriceSelected=function(t){var e,i;!this.isRelativePriceControlHidden&&this._settings.value().showRelativePriceControl&&(this.relativePrice.setValue(t),null===t?e=0:"ask"===t.base?e=this.quotes.value().ask+this.step.value()*t.offset:"bid"===t.base?e=this.quotes.value().bid+this.step.value()*t.offset:(void 0,e=(this._isLimitPrice&&4===this.orderType.value()&&null!==this._syncPrice?this._syncPrice:this._getQuotesBySide(this.side.value()))+this.step.value()*t.offset),this._checkOutOfRange(this.quotes.value(),e)&&(e=this._getQuotesBySide(this.side.value()),this.relativePrice.setValue({base:this._getBase(this.side.value(),this.orderType.value()),offset:0})),i=this.formatter.format(Object(F.fixComputationError)(e)),this.price.setValue(Object(A.d)(i,this.formatter,e)),this.displayPrice.setValue(i))},t.prototype.subscribe=function(){var t=this;return S.Observable.combineLatest(this._side,this._quotes,this._orderTypeSubj).subscribe(function(e){var i=e[0],r=e[1],s=e[2];t.orderType.setValue(s),t.isRelativePriceControlHidden=t._roundToStepRequired(),t._setStep(),(t._isLimitPrice&&4!==s||!1===t._isLimitPrice||t.isRelativePriceControlHidden)&&(t._updateAbsolutePriceOnQuotes(i,r),t._updateRelativePriceOnQuotes(i,r,s)),t.quotes.setValue({ask:Object(N.l)(r),bid:Object(N.m)(r),last:Object(N.p)(r)}),t.side.setValue(i),t.orderType.setValue(s)})},t.prototype.unsubscribe=function(){this._priceSubscription.unsubscribe(),this._orderTypeSubscription.unsubscribe(),this._resultSubscription.unsubscribe(),this._settings.unsubscribe(this._updateFocusIfNeeded)},t.prototype.forcePricesUpdate=function(t){this.focusedControl.setValue(this._settings.value().showRelativePriceControl&&!this.isRelativePriceControlHidden?1:0),this.forceAbsolutePriceUpdate(t),this.forceRelativePriceUpdate()},t.prototype.forceAbsolutePriceUpdate=function(t){var e,i;null!==t&&(e=this._roundToStepRequired(),i=this._getPriceType(),t=e?Object(R.roundToStepByPriceTypeAndSide)(t,this.step.value(),i,this.side.value()):t,this.price.setValue(t),this.displayPrice.setValue(this.formatter.format(t)))},t.prototype.forceRelativePriceUpdate=function(){var t=this._getOffsetFromAbsolutePrice(this.price.value(),this.side.value(),this.quotes.value()),e={base:this._getBase(this.side.value(),this.orderType.value()),offset:t};this.onRelativePriceSelected(e)},t.prototype.forceStopLimitRelativePriceUpdate=function(t){var e={base:"stop",offset:this.side.value()};this.onRelativePriceSelected(e)},t.prototype.syncWithPrice=function(t){var e,i,r,s,o,n,u=null!==t?t:0;this._syncPrice=u,
i=null!==(e=this.price.value())?e:0,r=this._calcOffset(i,u,this.step.value()),0===this.focusedControl.value()?(s={base:"stop",offset:r},this.relativePrice.setValue(s)):(n=u+(null!==(o=this.relativePrice.value())?o.offset:0)*this.step.value(),this.forceAbsolutePriceUpdate(n))},t.prototype._checkOutOfRange=function(t,e){var i=null!==e&&e>=0,r=null!==e&&e<=100*Object(N.q)(this.side.value(),t);return!i||!r},t.prototype._checkPriceWarning=function(t,e){var i=this,r=this._priceRules.find(function(r){return i._isDistanceRuleViolated(t,e,r)});return r?{res:!0,severity:r.severity,msg:$.format({brokerTitle:this._brokerTitle})}:{res:!1,msg:void 0}},t.prototype._isDistanceRuleViolated=function(t,e,i){var r,s,o,n;return!("limitPriceDistance"===i.id&&!this._isLimitPrice||"stopPriceDistance"===i.id&&this._isLimitPrice)&&(s=1===(r=this._side.getValue()),o=Object(N.q)(r,e),n=null,s&&"buyDirectionPips"in i.options&&(n=i.options.buyDirectionPips),!s&&"sellDirectionPips"in i.options&&(n=i.options.sellDirectionPips),null!==n&&Math.abs(o-t)<n*this._pipSize)},t.prototype._getBase=function(t,e){return 4===e&&!0===this._isLimitPrice?"stop":1===t?"ask":"bid"},t.prototype._getQuotesBySide=function(t){return 1===t?this.quotes.value().ask:this.quotes.value().bid},t.prototype._calcOffset=function(t,e,i){return Math.round((t-e)/i)},t.prototype._getOffsetFromAbsolutePrice=function(t,e,i){var r=1===e?Object(N.l)(i):Object(N.m)(i);return this._calcOffset(null!==t?t:r,r,this.step.value())},t.prototype._getOffsetFromRelativePrice=function(){var t=this.relativePrice.value();return null!==t?t.offset:0},t.prototype._updateAbsolutePriceOnQuotes=function(t,e){var i,r=Object(N.q)(t,e);null===this.price.value()?this.forceAbsolutePriceUpdate(r):1===this.focusedControl.value()&&(i=this._getOffsetFromRelativePrice(),this.forceAbsolutePriceUpdate(Object(F.fixComputationError)(r+i*this.step.value())))},t.prototype._updateRelativePriceOnQuotes=function(t,e,i){var r,s;!this.isRelativePriceControlHidden&&this._settings.value().showRelativePriceControl&&(null!==this.relativePrice.value()&&0!==this.focusedControl.value()&&this.side.value()===t&&this.orderType.value()===i||(r=void 0,r=this.side.value()===t?4===i&&null===this.relativePrice.value()?t:this._getOffsetFromAbsolutePrice(this.price.value(),t,e):1===this.focusedControl.value()?0:4===i?t:-this._getOffsetFromRelativePrice(),s={base:this._getBase(t,i),offset:r},this.relativePrice.setValue(s)))},t.prototype._getPriceType=function(){var t=this.orderType.value();return 1===t||4===t&&this._isLimitPrice?1:2},t.prototype._setStep=function(){var t=this._getPriceType();1===t&&void 0!==this._instrumentInfo.limitPriceStep?this.step.setValue(this._instrumentInfo.limitPriceStep):2===t&&void 0!==this._instrumentInfo.stopPriceStep?this.step.setValue(this._instrumentInfo.stopPriceStep):this.step.setValue(this._instrumentInfo.minTick||this._instrumentInfo.pipSize)},t.prototype._roundToStepRequired=function(){var t=this._getPriceType()
;return 2===t&&void 0!==this._instrumentInfo.stopPriceStep||1===t&&void 0!==this._instrumentInfo.limitPriceStep},t}(),i("HbRj"),z=i("nc0P"),U=i("m6W+"),Q=i("kcTO"),H={min:window.t("Specified amount is less that the instrument minimum of {0}."),max:window.t("Specified amount is more than the instrument maximum of {0}."),step:window.t("Specified amount is not a multiple of the instrument quantity step of {0}.")},K=function(){function t(t,e,i,r,s,o,n,u,a){var c=this;this.quantityFormatter=new U.a,this.riskInCurrency=new I.a(null),this.riskInCurrencyFormatter=new Q.PriceFormatter(100),this.riskInPercent=new I.a(null),this.riskInPercentFormatter=new Q.PriceFormatter(100),this.isRiskAvailable=new I.a(!1),this.focusedControl=new I.a(null),this.riskStep=.01,this.error=new q({res:!1},N.g),this.onControlFocused=new j.a,this.$value=new O.BehaviorSubject(null),this._focusSubscription=Object(N.t)(this.focusedControl),this._riskInCurrencySubscription=Object(N.t)(this.riskInCurrency),this._riskInPercentSubscription=Object(N.t)(this.riskInPercent),this._focusSubj=this._focusSubscription.subject,this._controlError=new O.BehaviorSubject({res:!1}),this._riskInCurrencySubj=this._riskInCurrencySubscription.subject,this._riskInPercentSubj=this._riskInPercentSubscription.subject,this.setControlError=function(t){c._controlError.next({res:t})},this._updateFocusIfNeeded=function(t){var e=c.focusedControl.value(),i=1===e&&!t.showCurrencyRiskInQty,r=2===e&&!t.showPercentRiskInQty;(i||r)&&c.focusedControl.setValue(0)},this.qty=s.qty,this.quantity=new I.a(null!==n?n:this.qty.default),this._quantitySubscription=Object(N.t)(this.quantity),this._quantitySubj=this._quantitySubscription.subject,this.currency=o||"",this.status=u,this._equity=i,this._pipValue=r,this._stopLossAvailable=t,this._stopLossPips=e,this._stopLossSubscription=this._stopLossAvailable.subscribe(function(t){c.isRiskAvailable.setValue(t),t||c.focusedControl.setValue(0)}),this._valuesSubscription=S.Observable.combineLatest(this._createQuantityObservable(),this._createRiskInCurrencyObservable(),this._createRiskInPercentObservable(),this._focusSubj).subscribe(function(t){var e=t[0],i=t[1],r=t[2],s=t[3];c.quantity.value()===e&&c.riskInCurrency.value()===i&&c.riskInPercent.value()===r&&c.focusedControl.value()===s||c._setValuesForUnfocusedControls(s,e,i,r)}),this._resultSubscription=S.Observable.combineLatest(this._quantitySubj,this._controlError,this._focusSubj).subscribe(function(t){var e=t[0],i=t[1],r=t[2],s=c._checkQtyError(e),o=i.res?i.msg:s.msg;c.error.setValue({res:s.res||i.res,msg:o}),c.$value.next(s.res||i.res||null===r?null:e)}),this.focusedControl.setValue(0),this._settings=a,this._settings.subscribe(this._updateFocusIfNeeded)}return t.prototype.unsubscribe=function(){this._stopLossSubscription.unsubscribe(),this._valuesSubscription.unsubscribe(),this._resultSubscription.unsubscribe(),this._focusSubscription.unsubscribe(),this._quantitySubscription.unsubscribe(),this._riskInCurrencySubscription.unsubscribe(),this._riskInPercentSubscription.unsubscribe(),
this._settings.unsubscribe(this._updateFocusIfNeeded)},t.prototype._setValuesForUnfocusedControls=function(t,e,i,r){0!==t&&this.quantity.setValue(e),1!==t&&this.riskInCurrency.setValue(i),2!==t&&this.riskInPercent.setValue(r)},t.prototype._createQuantityObservable=function(){var t=this;return S.Observable.combineLatest([this._focusSubj,this._pipValue,this._quantitySubj,this._riskInCurrencySubj,this._riskInPercentSubj,this._stopLossPips,this._equity],function(e){var i,o,n,u,a,c,l,h=[];for(i=1;i<arguments.length;i++)h[i-1]=arguments[i];switch(o=h[0],n=h[1],u=h[2],a=h[3],c=h[4],l=h[5],e){case 0:return n;case 1:return r(u,c,o,t.qty.step);case 2:return s(a,l,c,o,t.qty.step);default:return n}})},t.prototype._createRiskInCurrencyObservable=function(){var t=this;return S.Observable.combineLatest([this._focusSubj,this._pipValue,this._quantitySubj,this._riskInCurrencySubj,this._riskInPercentSubj,this._stopLossPips,this._equity],function(e){var i,r,n,u,a,c,l,h=[];for(i=1;i<arguments.length;i++)h[i-1]=arguments[i];switch(r=h[0],n=h[1],u=h[2],a=h[3],c=h[4],l=h[5],e){case 0:return o(n,c,r);case 1:return u;case 2:return o(s(a,l,c,r,t.qty.step),c,r);default:return o(n,c,r)}})},t.prototype._createRiskInPercentObservable=function(){var t=this;return S.Observable.combineLatest([this._focusSubj,this._pipValue,this._quantitySubj,this._riskInCurrencySubj,this._riskInPercentSubj,this._stopLossPips,this._equity],function(e){var i,s,o,u,a,c,l,h=[];for(i=1;i<arguments.length;i++)h[i-1]=arguments[i];switch(s=h[0],o=h[1],u=h[2],a=h[3],c=h[4],l=h[5],e){case 0:return n(o,c,s,l);case 1:return n(r(u,c,s,t.qty.step),c,s,l);case 2:return a;default:return n(o,c,s,l)}})},t.prototype._checkQtyError=function(t){var e,i,r,s,o;return null===t?{res:!0}:(e=this.qty.step,i=this.qty.min,r=this.qty.max,t<i?{res:!0,msg:H.min.format(i)}:t>r?{res:!0,msg:H.max.format(r)}:(s=new z.Big(t),o=new z.Big(e),s.mod(o).eq(0)?{res:!1}:{res:!0,msg:H.step.format(e)}))},t}(),i("gxrE"),Y={orderStopLoss:{long:window.t("Stop loss order must be below entry price."),short:window.t("Stop loss order must be higher entry price.")},orderTakeProfit:{long:window.t("Take profit order must be above entry price."),short:window.t("Take profit order must be lower entry price.")},positionStopLoss:{long:function(t){return window.t("Stop loss must be below current __value__.",{value:t})},short:function(t){return window.t("Stop loss must be above current __value__.",{value:t})}},positionTakeProfit:{long:function(t){return window.t("Take profit must be above current __value__.",{value:t})},short:function(t){return window.t("Take profit must be below current __value__.",{value:t})}}},G={ask:window.t("ask"),bid:window.t("bid"),multiplyOfMinTick:window.t("Bracket price should be a multiple of {minTick}")},X=function(){function t(t,e,i,r,s,o,n,u,a,c,l,h,d,p,b,f){var _,y,v,m=this;this.focusedControl=new I.a(null),this.error=new q({res:!1},N.g),this.onControlFocused=new j.a,this.slTypes=[w.a.StopLoss,w.a.TrailingStop],this.$value=new O.BehaviorSubject(null),this.roundToStopLimitPriceStepRequired=!1,
this._errorSubj=new O.BehaviorSubject({res:!1}),this._controlError=new O.BehaviorSubject({res:!1}),this._enabledSubj=new O.BehaviorSubject(!1),this._focusSubscription=Object(N.t)(this.focusedControl),this.setControlError=function(t){m._controlError.next({res:t,msg:void 0})},this._updateFocusIfNeeded=function(t){var e=m.focusedControl.value(),i=3===e&&!t.showBracketsInPercent||2===e&&!t.showBracketsInCurrency;i&&m.focusedControl.setValue(0)},this.bracketType=new I.a(i),_=null!==t,this.enabled=new I.a(e),_&&this.focusedControl.setValue(1),_?(y=null,v=t):(y=null!==b?b:this._getDefaultPips(i),v=null),this.pips={value:new I.a(y),displayProps:{step:1,formatter:new Q.PriceFormatter(n.pipSize!==n.minTick?10:1)}},this._priceStep=n.minTick,i===w.a.StopLoss&&void 0!==n.stopPriceStep?(this._priceStep=n.stopPriceStep,this.roundToStopLimitPriceStepRequired=!0):i===w.a.TakeProfit&&void 0!==n.limitPriceStep&&(this._priceStep=n.limitPriceStep,this.roundToStopLimitPriceStepRequired=!0),this.price={value:new I.a(v),displayProps:{step:this._priceStep,formatter:r}},this.riskInCurrency={value:new I.a(null),displayProps:{step:.01,formatter:new Q.PriceFormatter(100)}},this.riskInPercent={value:new I.a(null),displayProps:{step:.01,formatter:new Q.PriceFormatter(100)}},this._pipsSubscription=Object(N.t)(this.pips.value),this._priceSubscription=Object(N.t)(this.price.value),this._riskInCurrencySubscription=Object(N.t)(this.riskInCurrency.value),this._riskInPercentSubscription=Object(N.t)(this.riskInPercent.value),this._enabledSubscription=Object(N.t)(this.enabled),this._bracketTypeSubscription=Object(N.t)(this.bracketType),this.currency=d.length>0?d:window.t("Money"),this._equity=s,this._pipValue=u,this._pipSize=n.pipSize,this._lotSize=n.lotSize,this._sideSign=a.map(function(t){return(i!==w.a.TakeProfit?-1:1)*t}),this._quotes=o,this._amount=c,this._side=a,this._parent=p,this._type=i,this._focus=this._focusSubscription.subject,this._pipsSubj=this._pipsSubscription.subject,this._priceSubj=this._priceSubscription.subject,this._riskInCurrencySubj=this._riskInCurrencySubscription.subject,this._riskInPercentSubj=this._riskInPercentSubscription.subject,this._enabledSubj=this._enabledSubscription.subject,this._bracketTypeSubj=this._bracketTypeSubscription.subject,this._orderPrice=S.Observable.combineLatest(l,h,this._bracketTypeSubj,o,a,function(t,e,i,r,s){return i!==w.a.TrailingStop||2!==e&&1===p?t:1===s?Object(N.m)(r):Object(N.l)(r)}),this._valuesSubscription=S.Observable.combineLatest([this._enabledSubj,this._side,this._focus,this._quotes,this._createPipsObservable(),this._createPriceObservable(),this._createRiskInCurrencyObservable(),this._createRiskInPercentObservable()],function(t,e,i,s){var o,n,u,a,c,l,h=[];for(o=4;o<arguments.length;o++)h[o-4]=arguments[o];n=h[0],u=h[1],a=h[2],c=h[3],!t&&null!==m.riskInCurrency.value.value()||m.focusedControl.value()===i&&m.pips.value.value()===n&&m.price.value.value()===u&&m.riskInCurrency.value.value()===a&&m.riskInPercent.value.value()===c||(m._setValuesForUnfocusedControls(i,n,u,a,c),l={res:!1},
l=2===m._parent?m._checkPositionError(e,n,u,s):m._checkOrderError(e,n,u),m.roundToStopLimitPriceStepRequired&&!l.res&&1===m.focusedControl.value()&&(l=function(t,e,i){return Object(N.s)(t,e)?{res:!1}:{res:!0,msg:G.multiplyOfMinTick.format({minTick:i.format(e)})}}(u,m._priceStep,r)),m._errorSubj.next(l))}).subscribe(),this._resultSubscription=S.Observable.combineLatest(this._pipsSubj,this._errorSubj,this._controlError,this._focus,this._enabledSubj).subscribe(function(t){var e=t[0],i=t[1],r=t[2],s=t[3],o=t[4],n=r.res?r.msg:i.msg;m.error.setValue({res:i.res||r.res,msg:n}),m.$value.next(i.res||r.res||null===s||!o?null:e)}),this._settings=f,this._settings.subscribe(this._updateFocusIfNeeded)}return t.prototype.unsubscribe=function(){this._focusSubscription.unsubscribe(),this._pipsSubscription.unsubscribe(),this._priceSubscription.unsubscribe(),this._riskInCurrencySubscription.unsubscribe(),this._riskInPercentSubscription.unsubscribe(),this._valuesSubscription.unsubscribe(),this._resultSubscription.unsubscribe(),this._bracketTypeSubscription.unsubscribe(),this._settings.unsubscribe(this._updateFocusIfNeeded)},t.prototype.readyToSubmit=function(){return this.enabled.value()&&null!==this.$value.getValue()&&null!==this.price.value.value()||!this.enabled.value()},t.prototype._getDefaultPips=function(t){return t===w.a.TakeProfit?w.b.TakeProfit:w.b.StopLoss},t.prototype._setValuesForUnfocusedControls=function(t,e,i,r,s){0!==t&&this.pips.value.setValue(e),1!==t&&this.price.value.setValue(i),2!==t&&this.riskInCurrency.value.setValue(r),3!==t&&this.riskInPercent.value.setValue(s),null===this.focusedControl.value()&&this.focusedControl.setValue(0)},t.prototype._checkOrderError=function(t,e,i){if(e<=0||i<=0){var r=this._type===w.a.TakeProfit?Y.orderTakeProfit:Y.orderStopLoss;return{res:!0,msg:1===t?r.long:r.short}}return{res:!1}},t.prototype._checkPositionError=function(t,e,i,r){var s=(this._type===w.a.TakeProfit?-1:1)*t,o=-1===t?Object(N.l)(r):Object(N.m)(r),n=-1===t?G.ask:G.bid,u=this._type===w.a.TakeProfit?Y.positionTakeProfit:Y.positionStopLoss;return o&&Math.sign(i-o)===s?{res:!0,msg:-1===t?u.short(n):u.long(n)}:{res:!1}},t.prototype._createPipsObservable=function(){var t=this;return S.Observable.combineLatest([this._focus,this._sideSign,this._pipValue,this._amount,this._equity,this._orderPrice,this._pipsSubj,this._priceSubj,this._riskInCurrencySubj,this._riskInPercentSubj],function(e){var i,r,s,o,n,l,h,d,p,b,f=[];for(i=1;i<arguments.length;i++)f[i-1]=arguments[i];switch(r=f[0],s=f[1],o=f[2],n=f[3],l=f[4],h=f[5],d=f[6],p=f[7],b=f[8],e){case 0:return h;case 1:return u(d,l,r,t._pipSize);case 2:return a(p,o,s,t._lotSize);case 3:return c(b,o,n,s,t._lotSize);default:return h}})},t.prototype._createPriceObservable=function(){var t=this;return S.Observable.combineLatest([this._focus,this._sideSign,this._pipValue,this._amount,this._equity,this._orderPrice,this._pipsSubj,this._priceSubj,this._riskInCurrencySubj,this._riskInPercentSubj],function(e){var i,r,s,o,n,u,h,d,p,b,f,_,y=[];for(i=1;i<arguments.length;i++)y[i-1]=arguments[i]
;switch(r=y[0],s=y[1],o=y[2],n=y[3],u=y[4],h=y[5],d=y[6],p=y[7],b=y[8],f=t._type===w.a.TakeProfit?1:2,e){case 0:_=l(h,u,r,t._pipSize);break;case 1:return d;case 2:_=l(a(p,o,s,t._lotSize),u,r,t._pipSize);break;case 3:_=l(c(b,o,n,s,t._lotSize),u,r,t._pipSize);break;default:_=l(h,u,r,t._pipSize)}return t.roundToStopLimitPriceStepRequired?Object(R.roundToStepByPriceTypeAndSide)(_,t._priceStep,f,r):_})},t.prototype._createRiskInCurrencyObservable=function(){var t=this;return S.Observable.combineLatest([this._focus,this._sideSign,this._pipValue,this._amount,this._equity,this._orderPrice,this._pipsSubj,this._priceSubj,this._riskInCurrencySubj,this._riskInPercentSubj],function(e){var i,r,s,o,n,a,l,d,p,b,f=[];for(i=1;i<arguments.length;i++)f[i-1]=arguments[i];switch(r=f[0],s=f[1],o=f[2],n=f[3],a=f[4],l=f[5],d=f[6],p=f[7],b=f[8],e){case 0:return h(l,o,s,t._lotSize);case 1:return h(u(d,a,r,t._pipSize),o,s,t._lotSize);case 2:return p;case 3:return h(c(b,o,n,s,t._lotSize),o,s,t._lotSize);default:return h(l,o,s,t._lotSize)}})},t.prototype._createRiskInPercentObservable=function(){var t=this;return S.Observable.combineLatest([this._focus,this._sideSign,this._pipValue,this._amount,this._equity,this._orderPrice,this._pipsSubj,this._priceSubj,this._riskInCurrencySubj,this._riskInPercentSubj],function(e){var i,r,s,o,n,c,l,h,p,b,f=[];for(i=1;i<arguments.length;i++)f[i-1]=arguments[i];switch(r=f[0],s=f[1],o=f[2],n=f[3],c=f[4],l=f[5],h=f[6],p=f[7],b=f[8],e){case 0:return d(l,o,n,s,t._lotSize);case 1:return d(u(h,c,r,t._pipSize),o,n,s,t._lotSize);case 2:return d(a(p,o,s,t._lotSize),o,n,s,t._lotSize);case 3:return b;default:return d(l,o,n,s,t._lotSize)}})},t}(),J=function(){function t(t,e){this.onControlFocused=new j.a,this.duration=new q(t,N.g),this.durations=e,this._subcsription=Object(N.t)(this.duration),this.$value=this._subcsription.subject}return t.prototype.unsubscribe=function(){this._subcsription.unsubscribe()},t.prototype.getValue=function(){var t,e=this.$value.getValue(),i=this.durations.find(function(t){return e.type===t.value});return void 0===i?null:(t={type:e.type},(i.hasDatePicker||i.hasTimePicker)&&(t.datetime=e.datetime),t)},t}(),Z=window.t("Modify"),tt=window.t("Modify order"),et=function(){return function(t,e,i,r){var s,o=this;this.value=new I.a(""),this.unsubscribe=function(){o._orderSubscription&&o._orderSubscription.unsubscribe()},i||2===t?this.value.setValue(1===t?tt:Z):(s=Object(k.ensureDefined)(r),this._orderTypeSubsctiption=Object(N.t)(s.orderType),this._orderTypeSubj=this._orderTypeSubsctiption.subject,this._statusSubscription=Object(N.t)(e),this._statusSubj=this._statusSubscription.subject,this._orderSubscription=S.Observable.combineLatest([this._orderTypeSubj,this._statusSubj,s.orderPlacingStatus,s.side,s.quantity,s.stopPrice,s.limitPrice],function(t,e,i,r){var n,u,a,c,l,h,d,p,b=[];for(n=4;n<arguments.length;n++)b[n-4]=arguments[n];if(u=b[0],a=b[1],c=b[2],e===w.g.Preview)return o.value.setValue(window.t("Send"))
;if(e===w.g.Wait)return i===w.h.Placed?o.value.setValue(window.t("Order sent")):o.value.setValue(window.t("Click any field to activate order placement"));switch(l=null!==a?s.formatter.format(a):"",h=null!==c?s.formatter.format(c):"",d=null!==u?s.quantityFormatter.format(u):"",p=1===r?N.r.buy:N.r.sell,t){case 2:return o.value.setValue(p.market(d,s.symbol));case 3:return o.value.setValue(p.stop(d,s.symbol,l));case 1:return o.value.setValue(p.limit(d,s.symbol,h));case 4:return o.value.setValue(p.stopLimit(d,s.symbol,l,h))}}).subscribe())}}(),it={title:window.t("Order Info"),pipValue:window.t("Pip Value"),tradeValue:window.t("Trade Value"),total:window.t("Total"),leverage:window.t("Leverage"),lotSize:window.t("Lot Size"),reward:window.t("Reward"),risk:window.t("Risk")},rt=function(){function t(t,e,i,r,s,o,n,u,a,c,l){this._availableMargin=new I.a(0),this._usedMargin=new I.a(0),this._textOutputs=new q([],N.g),this._tpRiskInCurrencySubscription=null,this._tpRiskInPercentSubscription=null,this._slRiskInCurrencySubscription=null,this._slRiskInPercentSubscription=null,this._riskFormatter=new Q.PriceFormatter(100),this._marginAvailable$=t,this._qty$=e,this._pipValue$=r,this._side$=o,this._type=u.type,this._minTick=u.minTick,this._currency=i,this._marginRate=u.marginRate,this._hasMarginMeter=l&&void 0!==this._marginRate,this._price$=s,this._showTotalInsteadOfTradeValue=n,this._leverage=u.leverage,this._lotSize=u.lotSize,this._symbolPipSize=u.pipSize,this._pipValueForCurrentQuantity=0,this._tradeValue=0,a&&c&&(this._tpRiskInCurrencySubscription=Object(N.t)(a.riskInCurrency),this._tpRiskInPercentSubscription=Object(N.t)(a.riskInPercent),this._slRiskInCurrencySubscription=Object(N.t)(c.riskInCurrency),this._slRiskInPercentSubscription=Object(N.t)(c.riskInPercent))}return t.prototype.subscribe=function(){var t=this,e=[this._price$,this._pipValue$,this._side$,this._qty$],i=[S.Observable.combineLatest(e,function(e,i,r,s){var o,n,u,a,c,l,h,d,p,b,f=[];for(o=4;o<arguments.length;o++)f[o-4]=arguments[o];n=f[0],u=f[1],a=f[2],c=f[3],l=f[4],h=f[5],t._pipValueForCurrentQuantity=Object(N.b)(s,i,t._lotSize),t._tradeValue="crypto"===t._type?(null!==s?s:0)*e:Object(N.c)(s,e,i,t._symbolPipSize,t._lotSize),t._usedMargin.setValue(Object(N.d)(t._tradeValue,t._marginRate)),d=[],null!==(p=Object(N.i)(t._leverage,t._marginRate))&&d.push({title:it.leverage,value:p}),"number"==typeof t._lotSize&&Number.isFinite(t._lotSize)&&d.push({title:it.lotSize,value:""+t._lotSize}),"crypto"!==t._type&&Number.isFinite(t._pipValueForCurrentQuantity)&&d.push({title:it.pipValue,value:t._currency+" "+Object(N.j)(t._pipValueForCurrentQuantity)}),Number.isFinite(t._tradeValue)&&(b="crypto"===t._type?t._tradeValue.toFixed(Object(N.n)(t._minTick)):Object(N.j)(t._tradeValue),d.push({title:t._showTotalInsteadOfTradeValue?it.total:it.tradeValue,value:t._currency+" "+b})),n&&null!==u&&null!==a&&d.push({title:it.reward,value:t._riskFormatter.format(a)+"% ("+t._currency+" "+t._riskFormatter.format(u)+")"}),c&&null!==l&&null!==h&&d.push({title:it.risk,
value:t._riskFormatter.format(h)+"% ("+t._currency+" "+t._riskFormatter.format(l)+")"}),t._textOutputs.setValue(d)}).subscribe()];return this._hasMarginMeter&&i.push(Object(k.ensureNotNull)(this._marginAvailable$).subscribe(function(e){return t._updateAvailableMargin(e)})),i},t.prototype.title=function(){return it.title},t.prototype.textOutputs=function(){return this._textOutputs},t.prototype.hasMarginMeter=function(){return this._hasMarginMeter},t.prototype.availableMargin=function(){return this._availableMargin},t.prototype.usedMargin=function(){return this._usedMargin},t.prototype.pipValue=function(){throw new Error("not supported")},t.prototype.tradeValue=function(){throw new Error("not supported")},t.prototype.tpRiskInCurrency=function(){throw new Error("not supported")},t.prototype.tpRiskInPercent=function(){throw new Error("not supported")},t.prototype.slRiskInCurrency=function(){throw new Error("not supported")},t.prototype.slRiskInPercent=function(){throw new Error("not supported")},t.prototype._updateAvailableMargin=function(t){this._availableMargin.setValue(t)},t}(),st=i("jofe"),ot=i("MiOS"),nt=i("uOxu"),ut=Object(nt.getLogger)("PromiseWithDefault"),at={symbol:window.t("Symbol"),ask:window.t("Ask"),bid:window.t("Bid"),orderType:window.t("Type"),side:window.t("Side"),quantity:window.t("Quantity"),price:window.t("Price"),stopPrice:window.t("Stop price"),limitPrice:window.t("Limit price"),currency:window.t("Currency"),stopLoss:window.t("Stop Loss"),takeProfit:window.t("Take Profit"),buy:window.t("Buy"),sell:window.t("Sell"),warning:window.t("Estimated money impact is for main order only")},ct=function(){function t(t,e,i,r,s,o,n,u){this.warning=void 0,this._textQuotesOutputs=new q([],N.g),this._textOrderOutputs=[],this._textInfoOutputs=[],this.order=t,this.confirmId=e.confirmId,this.onCancelClick=r,this.onPlaceClick=s,this._quotes$=i,this._currency=u,this._formatter=o,this._quantityFormatter=n,this._textInfoOutputs=e.info,this._fillQuotesInfo(),this._fillOrderInfo(),(t.takeProfit||t.stopLoss)&&(this.warning=at.warning)}return t.prototype.subscribe=function(){var t=this;return this._quotes$.subscribe(function(e){return t._fillQuotesInfo(e)})},t.prototype.textQuotesOutputs=function(){return this._textQuotesOutputs},t.prototype.textOrderOutputs=function(){return this._textOrderOutputs},t.prototype.textInfoOutputs=function(){return this._textInfoOutputs},t.prototype._fillQuotesInfo=function(t){var e=[];e.push({title:at.symbol,value:this.order.symbol}),e.push({title:at.ask,value:t?this._formatter.format(t.ask):""}),e.push({title:at.bid,value:t?this._formatter.format(t.bid):""}),this._textQuotesOutputs.setValue(e)},t.prototype._fillOrderInfo=function(){this._textOrderOutputs.push({title:at.orderType,value:this.order.type?w.j[this.order.type]:""}),this._textOrderOutputs.push({title:at.side,value:1===this.order.side?at.buy:at.sell}),this._textOrderOutputs.push({title:at.quantity,value:this._quantityFormatter.format(this.order.qty)}),3!==this.order.type&&1!==this.order.type||this._textOrderOutputs.push({title:at.price,
value:this._formatter.format(3===this.order.type?this.order.stopPrice:this.order.limitPrice)}),4===this.order.type&&(this._textOrderOutputs.push({title:at.stopPrice,value:this._formatter.format(this.order.stopPrice)}),this._textOrderOutputs.push({title:at.limitPrice,value:this._formatter.format(this.order.limitPrice)})),this.order.stopLoss&&this._textOrderOutputs.push({title:at.stopLoss,value:String(this.order.stopLoss)}),this.order.takeProfit&&this._textOrderOutputs.push({title:at.takeProfit,value:String(this.order.takeProfit)}),this._currency.length>0&&this._textOrderOutputs.push({title:at.currency,value:this._currency})},t}(),lt=Object(nt.getLogger)("Trading.OrderViewModel"),ht=function(){function t(t,e,i,r,s,o,n,u,a,c,l,h,d,b){var f,_,y=this;if(this.orderType=new I.a(null),this.orderPreviewModel=null,this.customFieldModels=new I.a([]),this.onDoneButtonClicked=Object(st.createDeferredPromise)(),this.status=new I.a(w.g.Active),this.rewardRisk=new I.a(""),this.disabled=new I.a(!1),this.loading=new I.a(!1),this.needSignIn=!1,this.noBroker=!1,this.symbolHasLotSize=!1,this.id=Object(C.randomHashN)(6),this._onModeChanged=new j.a,this._onInputStateChanged=new j.a,this._onCloseButtonClicked=new j.a,this._onBackButtonClicked=new j.a,this._subscriptions=[],this._stopLossPips=new O.BehaviorSubject(25),this._stopLossAvailable=new O.BehaviorSubject(!1),this._marginAvailable$=null,this._orderPlacingStatus=new O.BehaviorSubject(w.h.Creating),this.doneButtonClick=function(){if(!y.loading.value()){y.loading.setValue(!0),y._initialInputState.quantity=y._currentInputState.quantity;var t=y.existingOrder?y._order:{symbol:y.symbol,type:Object(k.ensureNotNull)(y.orderType.value()),side:y.sideModel.$value.getValue(),qty:0};if(t.qty=Object(k.ensureNotNull)(y.quantityModel.$value.getValue()),4===y.orderType.value()?(t.stopPrice=Object(k.ensureNotNull)(y.stopPriceModel.$value.getValue()),t.limitPrice=Object(k.ensureNotNull)(y.limitPriceModel.$value.getValue())):3===y.orderType.value()?t.stopPrice=Object(k.ensureNotNull)(y.stopPriceModel.$value.getValue()):1===y.orderType.value()&&(t.limitPrice=Object(k.ensureNotNull)(y.limitPriceModel.$value.getValue())),y.durationModel&&2!==y.orderType.value()&&(t.duration=y.durationModel.$value.getValue()),y.stopLossModel&&(delete t.stopLoss,delete t.trailingStopPips,y.stopLossModel.bracketType.value()===w.a.StopLoss&&(t.stopLoss=y.stopLossModel.enabled.value()?Object(k.ensureNotNull)(y.stopLossModel.$value.getValue()&&y.stopLossModel.price.value.value()):void 0),y.stopLossModel.bracketType.value()===w.a.TrailingStop&&(t.trailingStopPips=y.stopLossModel.enabled.value()?Object(k.ensureNotNull)(y.stopLossModel.$value.getValue()):void 0)),y.takeProfitModel&&(t.takeProfit=y.takeProfitModel.enabled.value()?Object(k.ensureNotNull)(y.takeProfitModel.$value.getValue()&&y.takeProfitModel.price.value.value()):void 0),Array.isArray(y.customFieldModels.value())&&(t.customFields=y._getCustomFields()),y.supportOrderPreview&&!y.existingOrder&&y._settings.value().showOrderPreview){
if(null===y.orderPreviewModel)return void y._adapter.previewOrder(t).then(function(e){y.orderPreviewModel=new ct(t,e,y._quotes$,y._back,y.doneButtonClick,y.formatter,y.quantityModel.quantityFormatter,Object(k.ensureDefined)(y.currency)),y._subscriptions.push(y.orderPreviewModel.subscribe()),y.loading.setValue(!1),y.status.setValue(w.g.Preview)}).catch(function(t){y.loading.setValue(!1),y._showErrorNotification(window.t("Order preview"),"object"==typeof t?t.message:t)});t=y.orderPreviewModel.order}y._doneHandler(t,null!==y.orderPreviewModel?y.orderPreviewModel.confirmId:void 0).then(function(t){y.loading.setValue(!1),null!==y.orderPreviewModel&&y._suggestedQty.setValue(y.symbol,y.orderPreviewModel.order.qty),t&&(y.mode.value()===w.f.Popup?y.headerModel.close():y._backToDefaultOrderPanel(),y._trackEvent("Order Ticket",y.existingOrder?"Modify Order":"Place Order",y.mode.value()===w.f.Panel?"Panel":"Popup"),y.existingOrder||y._orderPlacingStatus.next(w.h.Placed),y.onDoneButtonClicked.resolve(!0)),t||null===y.orderPreviewModel||y._back(),y.orderPreviewModel=null})}},this.activateOrderPanel=function(){y.status.setValue(y.existingOrder?w.g.Editing:w.g.Active),y.orderType.unsubscribe(y.activateOrderPanel),y.sideModel&&y.sideModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.limitPriceModel&&y.limitPriceModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.stopPriceModel&&y.stopPriceModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.quantityModel&&y.quantityModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.takeProfitModel&&y.takeProfitModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.stopLossModel&&y.stopLossModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),y.durationModel&&y.durationModel.onControlFocused.unsubscribe(y,y.activateOrderPanel),Array.isArray(y.customFieldModels.value())&&y.customFieldModels.value().length>0&&y.customFieldModels.value().forEach(function(t){t.onControlFocused.unsubscribe(y,y.activateOrderPanel)}),y._orderPlacingStatus.next(w.h.Creating)},this._noQuotesCallback=function(){y._trackEvent("Order Ticket","No Quotes")},this._updateMode=function(){y.mode.value()===w.f.Popup&&y.status.value()!==w.g.Preview&&y.activateOrderPanel(),y.toggleCancelButton()},this._syncOrderPricesAndFocuses=function(){1===y.orderType.value()&&4===y.prevOrderType.value()&&y.limitPriceModel.forceRelativePriceUpdate(),1===y.orderType.value()&&3===y.prevOrderType.value()&&(y.limitPriceModel.forceAbsolutePriceUpdate(y.stopPriceModel.price.value()),y.limitPriceModel.focusedControl.setValue(y.stopPriceModel.focusedControl.value()),y.limitPriceModel.forceRelativePriceUpdate()),3===y.orderType.value()&&4===y.prevOrderType.value()&&y.stopPriceModel.forceRelativePriceUpdate(),3===y.orderType.value()&&1===y.prevOrderType.value()&&(y.stopPriceModel.forceAbsolutePriceUpdate(y.limitPriceModel.price.value()),y.stopPriceModel.focusedControl.setValue(y.limitPriceModel.focusedControl.value()),y.stopPriceModel.forceRelativePriceUpdate()),
4===y.orderType.value()&&y.limitPriceModel.forceStopLimitRelativePriceUpdate(y.stopPriceModel.price.value()),y.prevOrderType.setValue(y.orderType.value())},this._syncStopLimitPrices=function(){4===y.orderType.value()&&y.limitPriceModel.syncWithPrice(y.stopPriceModel.price.value())},this._back=function(){y.orderPreviewModel=null,y.onDoneButtonClicked.resolve(!1),y._onBackButtonClicked.fire()},this._toggleTradingWidget=u,this._onNeedSelectBroker=a,this._showErrorNotification=l,this._trackEvent=c,this._suggestedQty=h,this.mode=r,this._settings=s,this.existingOrder=e.hasOwnProperty("id"),this.status=new I.a(this.existingOrder?w.g.Editing:w.g.Active),this.symbol=e.symbol,this._orderStatusSubscription=Object(N.t)(this.status),this._loadingSubscription=Object(N.t)(this.loading),this._status=this._orderStatusSubscription.subject,this._loading=this._loadingSubscription.subject,this._panelCanBeShown=n,null!==t){if(!o.tradable)return this.notTradableText=o.reason,this._createSimpleDialog(t),void(this.onReady=Promise.resolve());this._adapter=t,this._handler=i,this._order=Object.assign({},e),this.existingOrder=e.hasOwnProperty("id"),this.status.setValue(this.existingOrder?w.g.Editing:w.g.Active),f=Boolean(e.takeProfit||e.stopLoss),_=t.metainfo().configFlags,this.supportEditAmount=_.supportEditAmount,this.showQuantityInsteadOfAmount=_.showQuantityInsteadOfAmount,this.supportMarketOrders=_.supportMarketOrders,this.supportLimitOrders=_.supportLimitOrders,this.supportStopOrders=_.supportStopOrders,this.supportStopLimitOrders=_.supportStopLimitOrders,this.supportBrackets=_.supportOrderBrackets&&!(e.hasOwnProperty("parentId")&&e.parentId)&&(!this.existingOrder||this.existingOrder&&(f||_.supportAddBracketsToExistingOrder)),this.supportTrailingStop=this.supportBrackets&&_.supportTrailingStop,this.supportMarketBrackets=_.supportMarketBrackets,this.supportModifyDuration=_.supportModifyDuration,this.supportOrderPreview=_.supportOrderPreview,this.orderType.setValue(e.hasOwnProperty("type")&&e.type||this.supportMarketOrders&&2||this.supportLimitOrders&&1||this.supportStopOrders&&3||this.supportStopLimitOrders&&4||null),this.prevOrderType=new I.a(this.orderType.value()),this._orderTypeSubscription=Object(N.t)(this.orderType),this._orderType=this._orderTypeSubscription.subject,this._suggestedQty=h,this._suggestedQty.changed.subscribe(this,this._suggestedQtyChangedHandler),this.onReady=Promise.all([t.symbolInfo(e.symbol),p(t.accountInfo(),{id:t.metainfo().id,name:t.metainfo().title}),p(t.quotesSnapshot(e.symbol),{},this._noQuotesCallback),p(t.formatter(e.symbol,!1),new Q.PriceFormatter),p(t.spreadFormatter(e.symbol),new Q.PriceFormatter),p(h.value(e.symbol),1e3)]).then(function(i){var r=i[0],s=i[1],n=i[2],u=i[3],a=i[4],c=i[5];y.brokerSymbol=r.brokerSymbol||e.brokerSymbol||y.symbol,y.currency=Object(N.o)(r,s),y.formatter=u,y.symbolHasLotSize=r.hasOwnProperty("lotSize"),y._initialInputState=y._getInitialInputState(t,e,c,d),y._currentInputState=Object.assign({},y._initialInputState),
y.customFieldModels.setValue(Object(N.h)(y.existingOrder,y.status,t.metainfo().orderDialogOptions,Object.assign(y._currentInputState.customFields||{},e.customFields))),y._currentInputState.quantity=y._order.qty||c,y._quotes$=S.Observable.fromEventPattern(function(i){return t.subscribeRealtime(e.symbol,i)},function(i){return t.unsubscribeRealtime(e.symbol,i)},function(t,e){return Object(N.a)(e,r.minTick)}).publishReplay(1).refCount(),y._equity$=S.Observable.fromEventPattern(function(e){return t.subscribeEquity(e)},function(e){return t.unsubscribeEquity(e)},function(t,e){return e}).publishReplay(1).refCount(),y._marginAvailable$=_.supportMargin?S.Observable.fromEventPattern(function(e){return t.subscribeMarginAvailable(e)},function(e){return t.unsubscribeMarginAvailable(e)},function(t,e){return e}).publish():null,y._pipValues$=S.Observable.fromEventPattern(function(i){return t.subscribePipValue(e.symbol,i)},function(i){return t.unsubscribePipValue(e.symbol,i)},function(t,e){return e}).startWith({buyPipValue:r.pipValue,sellPipValue:r.pipValue}).publish(),0===y._order.limitPrice&&!1===y.existingOrder&&(y._order.limitPrice=1===y._order.side?Object(N.l)(n):Object(N.m)(n)),0===y._order.stopPrice&&!1===y.existingOrder&&(y._order.stopPrice=1===y._order.side?Object(N.m)(n):Object(N.l)(n)),y._createModels(e,r,s,a,o.tradable,b),y._subscribe(),y._setOrderWidgetInputState()}).catch(function(t){throw lt.logError("Failed to create order model: "+t),t})}else this.onReady=Promise.resolve()}return t.prototype.destroy=function(){var t=this;this._subscriptions.forEach(function(t){return t&&t.unsubscribe()}),this._orderStatusSubscription.unsubscribe(),this._loadingSubscription.unsubscribe(),this._orderTypeSubscription&&this._orderTypeSubscription.unsubscribe(),this._suggestedQty&&this._suggestedQty.changed.unsubscribe(this,this._suggestedQtyChangedHandler),this.headerModel&&(this.headerModel.unsubscribe(),this.headerModel.pinButtonClicked().unsubscribe(this,this._toggleMode),this.headerModel.cancelButtonClicked().unsubscribe(this,this._cancel),this.headerModel.closeButtonClicked().unsubscribe(this,this._closeWidget),this.headerModel.backButtonClicked().unsubscribe(this,this._back)),this.sideModel&&(this.sideModel.unsubscribe(),this.sideModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),this.limitPriceModel&&(this.limitPriceModel.unsubscribe(),this.limitPriceModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),this.stopPriceModel&&(this.stopPriceModel.price.unsubscribe(this._syncStopLimitPrices),this.stopPriceModel.unsubscribe(),this.stopPriceModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),this.quantityModel&&(this.quantityModel.unsubscribe(),this.quantityModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),this.takeProfitModel&&(this.takeProfitModel.unsubscribe(),this.takeProfitModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),this.stopLossModel&&(this.stopLossModel.unsubscribe(),this.stopLossModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),
this.durationModel&&(this.durationModel.unsubscribe(),this.durationModel.onControlFocused.unsubscribe(this,this.activateOrderPanel)),Array.isArray(this.customFieldModels.value())&&this.customFieldModels.value().length>0&&this.customFieldModels.value().forEach(function(e){e.onControlFocused.unsubscribe(t,t.activateOrderPanel),e.subscription&&e.subscription.unsubscribe()}),this.buttonModel&&this.buttonModel.unsubscribe(),this._customFieldsSubscription&&this._customFieldsSubscription.unsubscribe(),this._adapter&&(this._adapter.orderUpdate.unsubscribe(this,this._orderUpdate),this._adapter.orderDialogOptionsUpdate.unsubscribe(this,this._orderDialogOptionsUpdate)),this.orderType.unsubscribe(this._syncOrderPricesAndFocuses),this.orderType.unsubscribe(this.activateOrderPanel),this.mode.unsubscribe(this._updateMode)},t.prototype.onModeChanged=function(){return this._onModeChanged},t.prototype.onInputStateChanged=function(){return this._onInputStateChanged},t.prototype.onCloseButtonClicked=function(){return this._onCloseButtonClicked},t.prototype.onBackButtonClicked=function(){return this._onBackButtonClicked},t.prototype.selectBroker=function(){var t=this;this._toggleTradingWidget().then(function(){return t._onNeedSelectBroker.fire()})},t.prototype.resetOrderPanel=function(){this._cancel()},t.prototype.deactivateOrderPanel=function(){var t=this;this.status.value()!==w.g.Wait&&(this.status.setValue(w.g.Wait),this.orderType.subscribe(this.activateOrderPanel),this.sideModel&&this.sideModel.onControlFocused.subscribe(this,this.activateOrderPanel),this.limitPriceModel&&this.limitPriceModel.onControlFocused.subscribe(this,this.activateOrderPanel),this.stopPriceModel&&this.stopPriceModel.onControlFocused.subscribe(this,this.activateOrderPanel),this.quantityModel&&this.quantityModel.onControlFocused.subscribe(this,this.activateOrderPanel),this.takeProfitModel&&(this.takeProfitModel.enabled.setValue(!1),this.takeProfitModel.onControlFocused.subscribe(this,this.activateOrderPanel)),this.stopLossModel&&(this.stopLossModel.enabled.setValue(!1),this.stopLossModel.onControlFocused.subscribe(this,this.activateOrderPanel)),this.durationModel&&this.durationModel.onControlFocused.subscribe(this,this.activateOrderPanel),Array.isArray(this.customFieldModels.value())&&this.customFieldModels.value().length>0&&this.customFieldModels.value().forEach(function(e){e.onControlFocused.subscribe(t,t.activateOrderPanel)}),this._setDisabledIfNeeded(this._status.getValue(),this._loading.getValue(),this.sideModel?this.sideModel.$value.getValue():null,this.limitPriceModel?this.limitPriceModel.$value.getValue():null,this.stopPriceModel?this.stopPriceModel.$value.getValue():null,this.quantityModel?this.quantityModel.$value.getValue():null,this.takeProfitModel?this.takeProfitModel.$value.getValue():null,this.stopLossModel?this.stopLossModel.$value.getValue():null))},t.prototype.toggleCancelButton=function(){this.mode.value()===w.f.Panel&&this.status.value()===w.g.Active&&this.headerModel?this.headerModel.showCancelButton():this.headerModel.hideCancelButton()},
t.prototype._createSimpleDialog=function(t){this.orderType.setValue(null),this.status.setValue(w.g.Wait),this.headerModel=new E(this.symbol,t?t.metainfo().title:"",this.mode,this.status,1,!1,!1,this._quotes$,this._panelCanBeShown),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget)},t.prototype._createModels=function(t,e,i,r,s,o){var n,u,a,c,l,h,d,p,b,f,_=this;this.sideModel=new L(this._quotes$,this.formatter,r,this._order.side||1,this.status),this.side=this.sideModel.side,this._pipValue$=S.Observable.combineLatest(this._pipValues$,this.sideModel.$value,function(t,e){return 1===e?t.buyPipValue:t.sellPipValue}),this.quantityModel=new K(this._stopLossAvailable,this._stopLossPips,this._equity$,this._pipValue$,e,Object(k.ensureDefined)(this.currency),this._currentInputState.quantity,this.status,this._settings),u=(n=this._adapter.metainfo()).orderRules,a=n.title,this.limitPriceModel=new W(this._quotes$,this.sideModel.$value,e,this.status,this._order.limitPrice,this.formatter,this.orderType,!0,this._settings,a,u,o),this.stopPriceModel=new W(this._quotes$,this.sideModel.$value,e,this.status,this._order.stopPrice,this.formatter,this.orderType,!1,this._settings,a,u,o),4===this.orderType.value()&&this.limitPriceModel.syncWithPrice(this.stopPriceModel.price.value()),this._price$=S.Observable.combineLatest(this._orderType,this.sideModel.$value,this._quotes$,this.stopPriceModel.$value,this.limitPriceModel.$value,function(t,e,i,r,s){var o=1===e?Object(N.l)(i):Object(N.m)(i),n=(i.trade?i.trade:o)||0;switch(_._initialInputState.limitPrice=o,_._initialInputState.stopPrice=o,t){case 1:case 4:return(null===s?_.limitPriceModel.price.value():s)||n;case 3:return(null===r?_.stopPriceModel.price.value():r)||n;default:return o}}),this.supportBrackets&&this._createBracketsModels(t,e,Object(k.ensureDefined)(this.currency)),this.headerModel=new E(this.brokerSymbol,this._adapter.metainfo().title,this.mode,this.status,1,this.existingOrder,s,this._quotes$,this._panelCanBeShown,t,this.formatter),c=Object(N.v)(this._adapter.metainfo().orderDialogOptions),this.orderInfoModel=new rt(this._marginAvailable$,this.quantityModel.$value,Object(k.ensureDefined)(this.currency),this._pipValue$,this._price$,this.sideModel.$value,c,e,this.supportBrackets&&this.takeProfitModel?{enabled:this.takeProfitModel.enabled,riskInCurrency:this.takeProfitModel.riskInCurrency.value,riskInPercent:this.takeProfitModel.riskInPercent.value}:null,this.supportBrackets&&this.stopLossModel?{enabled:this.stopLossModel.enabled,riskInCurrency:this.stopLossModel.riskInCurrency.value,riskInPercent:this.stopLossModel.riskInPercent.value}:null,this._adapter.metainfo().configFlags.supportMargin||!1),l=e.allowedDurations,void 0!==(h=this._adapter.metainfo().durations)&&h.length>0&&(d=void 0,p=!0,void 0!==l&&h.filter(function(t){return l.includes(t.value)}),void 0!==this._order.duration?(p=function(t,e){return-1!==e.findIndex(function(e){return t===e.value})}(this._order.duration.type,h),d={type:this._order.duration.type},
void 0!==this._order.duration.datetime&&(d.datetime=Object(k.ensureDefined)(this._order.duration).datetime)):(void 0===(b=h.find(function(t){return _._currentInputState.duration&&t.value===_._currentInputState.duration.type}))&&(b=h.find(function(t){return Boolean(t.default)})||h[0]),d={type:b.value},f=b,Boolean(f.hasTimePicker||f.hasDatePicker)&&(d.datetime=Object(ot.c)(g().utc().add(1,"days")))),p&&(this.durationModel=new J(d,h)))},t.prototype._createBracketsModels=function(t,e,i){var r,s=this;this.takeProfitModel=new X(t.takeProfit||null,Boolean(t.takeProfit),w.a.TakeProfit,this.formatter,this._equity$,this._quotes$,e,this._pipValue$,this.sideModel.$value,this.quantityModel.$value,this._price$,this._orderType,i,1,this._currentInputState.takeProfitPips,this._settings),r=Boolean(t.trailingStopPips),this.stopLossModel=new X(r?null:t.stopLoss||null,Boolean(t.trailingStopPips||t.stopLoss),r?w.a.TrailingStop:w.a.StopLoss,this.formatter,this._equity$,this._quotes$,e,this._pipValue$,this.sideModel.$value,this.quantityModel.$value,this._price$,this._orderType,i,1,(r?t.trailingStopPips:this._currentInputState.stopLossPips)||null,this._settings),this.stopLossModel.focusedControl.subscribe(function(t){2!==t&&3!==t||s.quantityModel.focusedControl.setValue(0)}),this.quantityModel.focusedControl.subscribe(function(t){!s.stopLossModel||1===s.stopLossModel.focusedControl.value()||1!==t&&2!==t||s.stopLossModel.focusedControl.setValue(0)}),this._rewardRiskSubscription=S.Observable.combineLatest(this.takeProfitModel.$value,this.stopLossModel.$value).subscribe(function(t){var e=t[0],i=t[1];s.rewardRisk.setValue(Object(N.k)(e,i))}),this.stopLossModel.$value.subscribe(function(t){s.stopLossModel&&(s._stopLossAvailable.next(s.stopLossModel.enabled.value()),null!==t&&s._stopLossPips.next(t))})},t.prototype._subscribe=function(){var t,e,i=this;this.mode.subscribe(this._updateMode),this.headerModel.pinButtonClicked().subscribe(this,this._toggleMode),this.headerModel.cancelButtonClicked().subscribe(this,this._cancel),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget),this.headerModel.backButtonClicked().subscribe(this,this._back),this.buttonModel=new et(1,this.status,this.existingOrder,{orderType:this.orderType,side:this.sideModel.$value,quantity:this.quantityModel.$value,symbol:this.brokerSymbol,stopPrice:this.stopPriceModel.$value,limitPrice:this.limitPriceModel.$value,formatter:this.formatter,quantityFormatter:this.quantityModel.quantityFormatter,orderPlacingStatus:this._orderPlacingStatus}),t=[this._status,this.sideModel.$value,this._loading,this.limitPriceModel.$value,this.stopPriceModel.$value,this.quantityModel.$value],this.takeProfitModel&&t.push(this.takeProfitModel.$value),this.stopLossModel&&t.push(this.stopLossModel.$value),this._buttonDataSubscription=S.Observable.combineLatest(t,function(t,e,r){var s,o,n,u,a,c,l=[];for(s=3;s<arguments.length;s++)l[s-3]=arguments[s];o=l[0],n=l[1],u=l[2],a=l[3],c=l[4],i._setDisabledIfNeeded(t,r,e,o,n,u,a,c),i._compareInputStates(e,o,n,u,a,c)}).subscribe(),
this.customFieldModels&&(e=[],this._getSavableCustomFieldModels().forEach(function(t){var i=Object(N.t)(t.selectedItem);e.push(i.subject),t.subscription=i}),e.length&&(this._customFieldsSubscription=S.Observable.combineLatest(e,function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];Object(M.deepEquals)(i._getCustomFields(i._getSavableCustomFieldModels()),i._currentInputState.customFields)[0]||i._setOrderWidgetInputState()}).subscribe())),this._subscriptions=Object(_.__spreadArrays)([this.sideModel.subscribe(),this.limitPriceModel.subscribe(),this.stopPriceModel.subscribe(),this._price$.subscribe()],this.orderInfoModel.subscribe(),[this._buttonDataSubscription,this._pipValues$.connect()]),null!==this._marginAvailable$&&this._subscriptions.push(this._marginAvailable$.connect()),this.supportBrackets&&this._subscriptions.push(this._rewardRiskSubscription),this.orderType.subscribe(this._syncOrderPricesAndFocuses),this._adapter.orderUpdate.subscribe(this,this._orderUpdate),this._adapter.orderDialogOptionsUpdate.subscribe(this,this._orderDialogOptionsUpdate),this.stopPriceModel.price.subscribe(this._syncStopLimitPrices)},t.prototype._backToDefaultOrderPanel=function(){this.mode.value()===w.f.Panel&&!0===this.existingOrder?this._back():this.mode.value()===w.f.Panel&&!1===this.existingOrder&&this._cancel()},t.prototype._orderUpdate=function(t){this.existingOrder&&t.id===this._order.id&&6!==t.status&&this._back()},t.prototype._orderDialogOptionsUpdate=function(t){this.customFieldModels.setValue(Object(N.h)(this.existingOrder,this.status,t,this._order.customFields))},t.prototype._doneHandler=function(t,e){return this._suggestedQty.setValue(t.symbol,t.qty),this._getAndSendStatistics(t),this._handler(t,e)},t.prototype._getAndSendStatistics=function(t){var e,i=this,r=1===t.side?" Buy":" Sell",s=["Limit","Market","Stop","StopLimit"],o=["Price","Pips"],n=["Manual","RiskInCurrency","RiskInPercent"],u=["Pips","Price","RiskInCurrency","RiskInPercent"],a=["StopLoss","TakeProfit","TrailingStop"],c=this.quantityModel.focusedControl.value(),l=this.takeProfitModel&&this.takeProfitModel.enabled.value(),h=this.takeProfitModel&&this.takeProfitModel.focusedControl.value(),d=this.stopLossModel&&this.stopLossModel.enabled.value(),p=this.stopLossModel&&this.stopLossModel.focusedControl.value(),b=this.stopLossModel&&this.stopLossModel.bracketType.value(),f=" "+s[t.type-1],_=this._adapter.currentAccountType(),y=void 0!==_?_:"",v=4===t.type,m={StopPrice:{active:3===t.type||v,mode:o[this.stopPriceModel.focusedControl.value()]},LimitPrice:{active:1===t.type||v,mode:o[this.limitPriceModel.focusedControl.value()]},Quantity:{active:!0,mode:n[null!==c?c:0]},TP:{active:Boolean(l),mode:"number"==typeof h?u[h]:u[1]},SL:{active:Boolean(d),mode:"number"==typeof p?u[p]:u[1]}};this.durationModel&&(m.TimeInForce={active:Boolean(this.durationModel),mode:this.durationModel.$value.getValue().type}),Boolean(d)&&this.supportTrailingStop&&(m.SLType={active:!0,mode:"number"==typeof b?a[b]:a[0]}),e=this._settings.value(),Object.keys(e).forEach(function(t){
i._trackEvent("Order Ticket",t,e[t]?"on":"off")}),Object.keys(m).forEach(function(t){m[t].active&&i._trackEvent("Order Ticket",(y+r).trim()+f+" "+t,m[t].mode)})},t.prototype._getInitialInputState=function(t,e,i,r){var s,o=t.metainfo().durations;return Array.isArray(o)&&0!==o.length&&(s=e.duration||(void 0!==r?r.duration:{type:o[0].value})),{symbol:this.symbol,side:e.side||1,limitPrice:e.limitPrice||e.price||e.stopPrice||0,stopPrice:e.stopPrice||e.price||e.limitPrice||0,quantity:e.qty||i,takeProfitPips:void 0!==r?r.takeProfitPips:w.b.TakeProfit,stopLossPips:void 0!==r?r.stopLossPips:w.b.StopLoss,customFields:void 0!==r&&null!==r.customFields?r.customFields:{},duration:s||null}},t.prototype._compareInputStates=function(t,e,i,r,s,o){var n,u,a,c,l,h,d,p,b,f,_;0===this._initialInputState.limitPrice&&null!==e&&(this._initialInputState.limitPrice=e),0===this._initialInputState.stopPrice&&null!==i&&(this._initialInputState.stopPrice=i),n=this.orderType.value(),u=this.formatter.format(e),a=this.formatter.format(this._currentInputState.limitPrice),c=this.formatter.format(i),l=this.formatter.format(this._currentInputState.stopPrice),h=3!==n&&null!==e&&u!==a,d=(3===n||4===n)&&null!==i&&c!==l,p=null!==r&&this._currentInputState.quantity!==r,b=null!==s&&this._currentInputState.takeProfitPips!==s,f=null!==o&&this._currentInputState.stopLossPips!==o,_=h||d||p||b||f,(this._currentInputState.symbol!==this.symbol||null!==t&&this._currentInputState.side!==t||_)&&this._setOrderWidgetInputState()},t.prototype._getSavableCustomFieldModels=function(){return this.customFieldModels.value().filter(function(t){return t.saveToSettings&&"ComboBox"===t.type}).map(function(t){return t.selectedItem.value()===t.items[0].value&&t.selectedItem.setValue(""),t})},t.prototype._getCustomFields=function(t){t||(t=this.customFieldModels.value());var e={};return t.forEach(function(t){"TextWithCheckBox"===t.type?e[t.id]={text:t.text.value().replace(/&quote;/g,'"'),checked:t.checked.value()}:e[t.id]=t.selectedItem.value()}),e},t.prototype._setOrderWidgetInputState=function(){this._currentInputState={symbol:this.symbol,side:this.sideModel.$value.getValue(),limitPrice:this.limitPriceModel.$value.getValue(),stopPrice:this.stopPriceModel.$value.getValue(),quantity:this.quantityModel.$value.getValue(),takeProfitPips:this.takeProfitModel?this.takeProfitModel.pips.value.value():null,stopLossPips:this.stopLossModel?this.stopLossModel.pips.value.value():null,duration:this.durationModel&&this.durationModel.duration.value(),customFields:this._getCustomFields(this._getSavableCustomFieldModels())},this._onInputStateChanged.fire(this._currentInputState)},t.prototype._setDisabledIfNeeded=function(t,e,i,r,s,o,n,u){this.disabled.setValue(this.mode.value()===w.f.Panel&&t===w.g.Wait||e||null===i||Object(N.f)(this.orderType.value(),r,s)||null===o||Boolean(this.takeProfitModel&&!this.takeProfitModel.readyToSubmit())||Boolean(this.stopLossModel&&!this.stopLossModel.readyToSubmit()))},t.prototype._suggestedQtyChangedHandler=function(t){var e=this
;t===this.symbol&&this.quantityModel&&this._suggestedQty.value(t).then(function(t){e.quantityModel.quantity.value()!==t&&(e.quantityModel.focusedControl.setValue(0),e._currentInputState.quantity=t,e.quantityModel.quantity.setValue(t))})},t.prototype._toggleMode=function(){this.mode.setValue(this.mode.value()===w.f.Panel?w.f.Popup:w.f.Panel),this._updateMode(),this._onModeChanged.fire(this.mode.value())},t.prototype._closeWidget=function(){this.orderPreviewModel=null,this.onDoneButtonClicked.resolve(!1),this._onCloseButtonClicked.fire()},t.prototype._cancel=function(){this.orderPreviewModel=null,this.onDoneButtonClicked.resolve(!1),this.deactivateOrderPanel(),this._currentInputState=Object.assign({},this._initialInputState),this.limitPriceModel&&this.limitPriceModel.forcePricesUpdate(this._initialInputState.limitPrice),this.stopPriceModel&&this.stopPriceModel.forcePricesUpdate(this._initialInputState.stopPrice),this.quantityModel&&this.quantityModel.quantity.setValue(this._initialInputState.quantity),this.takeProfitModel&&this.takeProfitModel.enabled.setValue(!1),this.stopLossModel&&this.stopLossModel.enabled.setValue(!1),this.durationModel&&this._initialInputState.duration&&this.durationModel.duration.setValue(this._initialInputState.duration),this._orderPlacingStatus.next(w.h.Creating),this.existingOrder&&this._back()},t}(),dt={title:window.t("Position Info"),pipValue:window.t("Pip Value"),tradeValue:window.t("Trade Value"),total:window.t("Total"),leverage:window.t("Leverage"),lotSize:window.t("Lot Size")},pt=function(){function t(t,e,i,r,s){var o,n;this._baseTextOutputs=[],this._textOutputs=new q([],N.g),this._riskFormatter=new Q.PriceFormatter(100),this._currency=e,this._showTotalInsteadOfTradeValue=r,this._type=s.type,this._minTick=s.minTick,this._leverage=s.leverage,this._marginRate=s.marginRate,this._lotSize=s.lotSize,this._pipValue=Object(N.b)(t,s.pipValue,this._lotSize),this._tradeValue="crypto"===this._type?(null!==t?t:0)*i:Object(N.c)(t,i,s.pipValue,s.pipSize,this._lotSize),null!==(o=Object(N.i)(this._leverage,this._marginRate))&&this._baseTextOutputs.push({title:dt.leverage,value:o}),"number"==typeof this._lotSize&&Number.isFinite(this._lotSize)&&this._baseTextOutputs.push({title:dt.lotSize,value:""+this._lotSize}),"crypto"!==this._type&&Number.isFinite(this._pipValue)&&this._baseTextOutputs.push({title:dt.pipValue,value:this._currency+" "+Object(N.j)(this._pipValue)}),Number.isFinite(this._tradeValue)&&(n="crypto"===this._type?this._tradeValue.toFixed(Object(N.n)(this._minTick)):Object(N.j)(this._tradeValue),this._baseTextOutputs.push({title:this._showTotalInsteadOfTradeValue?dt.total:dt.tradeValue,value:this._currency+" "+n})),this._textOutputs.setValue(this._baseTextOutputs)}return t.prototype.title=function(){return dt.title},t.prototype.textOutputs=function(){return this._textOutputs},t.prototype.pipValue=function(){throw new Error("not supported")},t.prototype.tradeValue=function(){throw new Error("not supported")},t.prototype.tpRiskInCurrency=function(){throw new Error("not supported")},
t.prototype.tpRiskInPercent=function(){throw new Error("not supported")},t.prototype.slRiskInCurrency=function(){throw new Error("not supported")},t.prototype.slRiskInPercent=function(){throw new Error("not supported")},t}(),bt={bracketsWarning:window.t("You already have at least one working order that can affect this position")},ft=function(){function t(t,e,i,r,s,o,n,u,a){var c,l=this;this.customFieldModels=new I.a([]),this.onDoneButtonClicked=Object(st.createDeferredPromise)(),this.rewardRisk=new I.a(""),this.disabled=new I.a(!1),this.loading=new I.a(!1),this.status=new I.a(w.g.Active),this.id=Object(C.randomHashN)(6),this.warning=new I.a(void 0),this._onModeChanged=new j.a,this._onBackButtonClicked=new j.a,this._onCloseButtonClicked=new j.a,this._loadingSubscription=Object(N.t)(this.loading),this._loading=this._loadingSubscription.subject,this.mode=s,this._position=e,this._settings=o,this._adapter=t,this.position=e,this.symbol=e.symbol,this.brackets=i,this._handler=r,this._panelCanBeShown=n,this.side=new I.a(e.side),c=this._adapter.metainfo().configFlags,this.supportTrailingStop=c.supportTrailingStop,this.supportPositions=c.supportPositions,this.supportTrades=c.supportTrades,this.supportOnlyPairPositionBrackets=c.supportOnlyPairPositionBrackets,this._adapter.orders().then(function(i){var r=i.filter(function(t){return 2===t.parentType&&t.parentId===e.id}),s=r.length?r[0].customFields:void 0;l.customFieldModels.setValue(Object(N.h)(Boolean(r.length),l.status,t.metainfo().positionDialogOptions,s)),l.supportOnlyPairPositionBrackets&&l._updateWarning()}),this._trackEvent=a,this.onReady=Promise.all([t.symbolInfo(e.symbol),p(t.accountInfo(),{id:t.metainfo().id,name:t.metainfo().title}),p(t.formatter(e.symbol,!1),new Q.PriceFormatter)]).then(function(r){var s=r[0],o=r[1],n=r[2];l.currency=Object(N.o)(s,o),l.brokerSymbol=s.brokerSymbol||e.brokerSymbol||l.symbol,l._quotes$=S.Observable.fromEventPattern(function(t){return u.subscribeRealtime(e.symbol,t)},function(t){return u.unsubscribeRealtime(e.symbol,t)},function(t,e){return e}).publish(),l._equity$=S.Observable.fromEventPattern(function(e){return t.subscribeEquity(e)},function(e){return t.unsubscribeEquity(e)},function(t,e){return e}).publish(),l._pipValues$=S.Observable.fromEventPattern(function(i){return t.subscribePipValue(e.symbol,i)},function(i){return t.unsubscribePipValue(e.symbol,i)},function(t,e){return e}).startWith({buyPipValue:s.pipValue,sellPipValue:s.pipValue}).publish(),l._pipValue$=l._pipValues$.map(function(t){return 1===e.side?t.buyPipValue:t.sellPipValue}),l._createModels(i,s,o,l.mode,n),l._subscribe()})}return t.prototype.destroy=function(){this._subscriptions&&this._subscriptions.forEach(function(t){return t.unsubscribe()}),this.headerModel&&(this.headerModel.unsubscribe(),this.headerModel.pinButtonClicked().unsubscribe(this,this._toggleMode),this.headerModel.backButtonClicked().unsubscribe(this,this._back),this.headerModel.closeButtonClicked().unsubscribe(this,this._closeWidget)),this.takeProfitModel&&this.takeProfitModel.unsubscribe(),
this.stopLossModel&&this.stopLossModel.unsubscribe(),this.buttonModel&&this.buttonModel.unsubscribe(),this.supportPositions&&this._adapter.positionUpdate.unsubscribe(this,this._positionOrTradeUpdate),this.supportTrades&&this._adapter.tradeUpdate.unsubscribe(this,this._positionOrTradeUpdate),this.supportOnlyPairPositionBrackets&&(this._adapter.orderUpdate.unsubscribe(this,this._updateWarning),this._slEnabled&&this._slEnabled.destroy(),this._tpEnabled&&this._tpEnabled.destroy())},t.prototype.doneButtonClick=function(){var t=this;this.loading.setValue(!0),this._doneHandler().then(function(e){e&&(t.mode.value()===w.f.Popup?t.headerModel.close():t._back(),t._trackEvent("Position Ticket","Modify Position",t.mode.value()===w.f.Panel?"Panel":"Popup"),t.onDoneButtonClicked.resolve(!0)),t.loading.setValue(!1)})},t.prototype.onModeChanged=function(){return this._onModeChanged},t.prototype.onBackButtonClicked=function(){return this._onBackButtonClicked},t.prototype.onCloseButtonClicked=function(){return this._onCloseButtonClicked},t.prototype._createModels=function(t,e,i,r,s){var o,n,u,a=Object(N.o)(e,i)||"$",c=new O.BehaviorSubject(this._position.side||-1);this.headerModel=new E(this.brokerSymbol," ",r,this.status,2,!0,!0,this._quotes$,this._panelCanBeShown,this._position,this._position.priceFormatter?this._position.priceFormatter:s),this.takeProfitModel=new X(t.takeProfit||this._position.takeProfit||null,Boolean(t.takeProfit||this._position.takeProfit),w.a.TakeProfit,s,this._equity$,this._quotes$,e,this._pipValue$,c,new O.BehaviorSubject(this._position.qty),new O.BehaviorSubject(this._position.avgPrice),new O.BehaviorSubject(null),a,2,null,this._settings),o=t.trailingStopPips||this._position.trailingStopPips,n=Boolean(o),this.stopLossModel=new X(n?null:t.stopLoss||this._position.stopLoss||null,Boolean(n?o:t.stopLoss||this._position.stopLoss),n?w.a.TrailingStop:w.a.StopLoss,s,this._equity$,this._quotes$,e,this._pipValue$,c,new O.BehaviorSubject(this._position.qty),new O.BehaviorSubject(this._position.avgPrice),new O.BehaviorSubject(null),a,2,o||null,this._settings),u=Object(N.v)(this._adapter.metainfo().orderDialogOptions),this.positionInfoModel=new pt(this._position.qty,Object(N.o)(e,i),this._position.avgPrice,u,e),this.buttonModel=new et(2,this.status,!0)},t.prototype._updateWarning=function(){var t=this;this._adapter.orders().then(function(e){var i=e.find(function(e){return e.symbol===t._position.symbol&&e.side!==t._position.side&&(6===e.status&&void 0===e.parentId||3===e.status)});t.warning.setValue(i?bt.bracketsWarning:void 0)})},t.prototype._subscribe=function(){var t=this;this.headerModel.pinButtonClicked().subscribe(this,this._toggleMode),this.headerModel.backButtonClicked().subscribe(this,this._back),this.headerModel.closeButtonClicked().subscribe(this,this._closeWidget),this._buttonDataSubscription=S.Observable.combineLatest(this.takeProfitModel.$value,this.stopLossModel.$value,this._loading).subscribe(function(e){var i=e[0],r=e[1],s=e[2]
;t.disabled.setValue(s||t.takeProfitModel.enabled.value()&&null===i||t.stopLossModel.enabled.value()&&null===r)}),this._rewardRiskSubscription=S.Observable.combineLatest(this.takeProfitModel.$value,this.stopLossModel.$value).subscribe(function(e){var i=e[0],r=e[1];t.rewardRisk.setValue(Object(N.k)(i,r))}),this._subscriptions=[this._rewardRiskSubscription,this._buttonDataSubscription,this._equity$.connect(),this._quotes$.connect(),this._pipValues$.connect()],this.supportPositions&&this._adapter.positionUpdate.subscribe(this,this._positionOrTradeUpdate),this.supportTrades&&this._adapter.tradeUpdate.subscribe(this,this._positionOrTradeUpdate),this.supportOnlyPairPositionBrackets&&(this._adapter.orderUpdate.subscribe(this,this._updateWarning),this._slEnabled=this.stopLossModel.enabled.spawn(),this._slEnabled.subscribe(function(e){t.takeProfitModel.enabled.setValue(e)}),this._tpEnabled=this.takeProfitModel.enabled.spawn(),this._tpEnabled.subscribe(function(e){t.stopLossModel.enabled.setValue(e)}))},t.prototype._doneHandler=function(){var t,e=null!==this.stopLossModel.$value.getValue()?this.stopLossModel.price.value.value():null,i=this.stopLossModel.$value.getValue(),r=null!==this.takeProfitModel.$value.getValue()?this.takeProfitModel.price.value.value():null,s={};return null!==i&&null!==e&&(this.stopLossModel.bracketType.value()===w.a.StopLoss&&(s.stopLoss=e),this.stopLossModel.bracketType.value()===w.a.TrailingStop&&(s.trailingStopPips=i)),null!==r&&(s.takeProfit=r),Array.isArray(this.customFieldModels.value())?(t={},this.customFieldModels.value().forEach(function(e){"TextWithCheckBox"===e.type?t[e.id]={text:e.text.value().replace(/&quote;/g,'"'),checked:e.checked.value()}:t[e.id]=e.selectedItem.value()}),this._getAndSendStatistics(),this._handler(this.position.id,s,t)):(this._getAndSendStatistics(),this._handler(this.position.id,s))},t.prototype._getAndSendStatistics=function(){var t,e=this,i=this.stopLossModel.enabled.value(),r=this.stopLossModel.focusedControl.value(),s=this.takeProfitModel.enabled.value(),o=this.takeProfitModel.focusedControl.value(),n=this.stopLossModel&&this.stopLossModel.bracketType.value(),u=["Pips","Price","RiskInCurrency","RiskInPercent"],a=[" Disabled"," Active"],c=["StopLoss","TakeProfit","TrailingStop"],l={SL:{active:a[+i],mode:null!==r?u[r]:u[1]},TP:{active:a[+s],mode:null!==o?u[o]:u[1]}};this.supportTrailingStop&&(l.SLType={active:a[+i],mode:c[n]}),t=this._settings.value(),Object.keys(t).filter(function(t){return["showBracketsInCurrency","showBracketsInPercent"].includes(t)}).forEach(function(i){e._trackEvent("Order Ticket",i,t[i]?"on":"off")}),Object.keys(l).forEach(function(t){l[t].active&&e._trackEvent("Position Ticket",t,l[t].mode)})},t.prototype._positionOrTradeUpdate=function(t){t.id!==this.position.id||0!==t.qty&&this.position.side===t.side||this._back()},t.prototype._toggleMode=function(){this.mode.setValue(this.mode.value()===w.f.Panel?w.f.Popup:w.f.Panel),this._onModeChanged.fire(this.mode.value())},t.prototype._closeWidget=function(){this.onDoneButtonClicked.resolve(!1),
this._onCloseButtonClicked.fire()},t.prototype._back=function(){this.onDoneButtonClicked.resolve(!1),this._onBackButtonClicked.fire()},t}(),_t=i("8wgr"),yt=function(){function t(t){this._brokerId="",this._settingsAdapter=t}return t.prototype.setBrokerId=function(t){this._brokerId=t},t.prototype.getInputStateFromStorage=function(t){var e,i;if(null!==t)return(i=t.broker&&t.broker.metainfo().orderDialogOptions)&&i.customFields&&(e=this.customFields(t.symbol,i.customFields.map(function(t){return t.id}))),{symbol:t.symbol,side:t.side,limitPrice:null,stopPrice:null,quantity:null,takeProfitPips:this.takeProfitPips(t.symbol),stopLossPips:this.stopLossPips(t.symbol),duration:null,customFields:e||null}},t.prototype.saveSettings=function(t){this._settingsAdapter.setValue(this._makeKey(_t.settingsKeys.ORDER_PANEL_SETTINGS,this._brokerId),JSON.stringify(t))},t.prototype.getSettings=function(){var t=this._settingsAdapter.getValue(this._makeKey(_t.settingsKeys.ORDER_PANEL_SETTINGS,this._brokerId));try{return JSON.parse(t)}catch(t){return null}},t.prototype.setWidgetMode=function(t){this._settingsAdapter.setValue(_t.settingsKeys.ORDER_WIDGET_MODE,t)},t.prototype.widgetMode=function(){var t=this._settingsAdapter.getValue(_t.settingsKeys.ORDER_WIDGET_MODE);return t||null},t.prototype.setTakeProfitPips=function(t,e){var i=this._makeKey(_t.settingsKeys.TAKE_PROFIT,this._brokerId,t);e===w.b.TakeProfit?this._settingsAdapter.remove(i):this._settingsAdapter.setValue(i,e)},t.prototype.takeProfitPips=function(t){var e=this._makeKey(_t.settingsKeys.TAKE_PROFIT,this._brokerId,t),i=Number(this._settingsAdapter.getValue(e));return Object(M.isNumber)(i)?i:null},t.prototype.setStopLossPips=function(t,e){var i=this._makeKey(_t.settingsKeys.STOP_LOSS,this._brokerId,t);e===w.b.StopLoss?this._settingsAdapter.remove(i):this._settingsAdapter.setValue(i,e)},t.prototype.stopLossPips=function(t){var e=this._makeKey(_t.settingsKeys.STOP_LOSS,this._brokerId,t),i=Number(this._settingsAdapter.getValue(e));return Object(M.isNumber)(i)?i:null},t.prototype.setDuration=function(t,e){var i=this._makeKey(_t.settingsKeys.ORDER_DURATION,this._brokerId,t);null===e?this._settingsAdapter.remove(i):this._settingsAdapter.setValue(i,e)},t.prototype.duration=function(t){var e=this._makeKey(_t.settingsKeys.ORDER_DURATION,this._brokerId,t),i=this._settingsAdapter.getValue(e);return"string"==typeof i&&i.length>0?{type:i}:null},t.prototype.setCustomFields=function(t,e){var i,r,s,o,n,u;for(i=0,r=Object.entries(e);i<r.length;i++)o=(s=r[i])[0],n=s[1],u=this._makeKey("trading."+o+".",this._brokerId,t),"string"==typeof n&&n.length>0?this._settingsAdapter.setValue(u,n):this._settingsAdapter.remove(u)},t.prototype.customFields=function(t,e){var i=this,r={};return e.forEach(function(e){var s=i._makeKey("trading."+e+".",i._brokerId,t),o=i._settingsAdapter.getValue(s);"string"==typeof o&&o.length>0&&(r[e]=o)}),r},t.prototype._makeKey=function(t,e,i){return t+e+("string"==typeof i?"."+i:"")},t}(),vt=i("5XxY"),mt=i("vOQ2"),i.d(e,"OrderViewController",function(){return wt}),wt=function(){
function t(t,e){var i,r=this;this._state=null,this._mode=new I.a(w.f.Panel),this._orderViewModel=null,this._positionViewModel=null,this._settings=new I.a(P.b),this._activeAccount=null,this._statusChangeIndex=0,this._onStatusChangedBinded=this._onStatusChanged.bind(this),this._saveSettingsBinded=this._saveSettings.bind(this),this._updateContent=function(t){t!==mt.d.OrderPanel&&(r._positionViewModel&&(r._unmountPositionPanel(),r._unsubscribePositionViewModel()),null!==r._orderViewModel&&r._orderViewModel.existingOrder&&r._orderViewModel.onDoneButtonClicked.reject(),r._unmountOrderPanel())},this._onOrderWidgetModeChanged=function(t){null!==r._state&&null!==r._state.broker&&null!==r._orderViewModel&&(r._state.symbol!==r._orderViewModel.symbol?r.showOrderView(r._state.broker,r._orderStub):r._showOrderView()),t===w.f.Panel?r._closePositionDialog():r._closeTradingPanel()},this._onOrderWidgetInputStateChanged=function(t){var e,i,s;null!==r._state&&(null!==t.takeProfitPips&&r._orderViewDataStorage.setTakeProfitPips(r._state.symbol,t.takeProfitPips),null!==t.stopLossPips&&r._orderViewDataStorage.setStopLossPips(r._state.symbol,t.stopLossPips),t.duration&&(s=(i=(e=r._state.broker&&r._state.broker.metainfo().durations)&&(e.find(function(t){return t.default})||e[0]))&&i.name===t.duration.type?null:t.duration.type,r._orderViewDataStorage.setDuration(r._state.symbol,s)),t.customFields&&r._orderViewDataStorage.setCustomFields(r._state.symbol,t.customFields))},this._onOrderWidgetCloseButtonClicked=function(){r._mode.value()===w.f.Panel&&r._closeTradingPanel()},this._onOrderWidgetBackButtonClicked=function(){null!==r._state&&null!==r._state.broker&&(r._orderViewModel&&r._orderViewModel.status.value()===w.g.Preview?(r._showOrderView(),r._activateOrderPanel()):(r._orderStub=r._createOrderStub(),r.showOrderView(r._state.broker,r._orderStub,void 0,void 0,function(){r._mode.value()===w.f.Popup?(r._closeOrderDialog(),r._closePositionDialog()):r._deactivateOrderPanel()})))},this._onPositionWidgetModeChanged=function(t){null!==r._positionViewModel&&r._showPositionOrTradeView(),t===w.f.Panel?r._closeOrderDialog():r._closeTradingPanel()},this._onPositionWidgetBackButtonClicked=function(){null!==r._state&&null!==r._state.broker&&(r._mode.value()===w.f.Panel?(r._unmountPositionPanel(),r._showOrderView(void 0,function(){return r._resetOrderPanel()})):r._closePositionDialog())},this._onPositionWidgetCloseButtonClicked=function(){r._mode.value()===w.f.Panel?(r._unsubscribePositionViewModel(),r._recreateOrderViewModel().then(function(){r._closePositionPanel(),r._resetOrderPanel()}),r._closeTradingPanel()):r._closePositionDialog()},this._tradingCommands=t,this._trackEvent=t.trackEvent,this._realtimeProvider=t.realtimeProvider,this._resizerBridge=t.resizerBridge,this._orderViewDataStorage=new yt(v),this._tradingPanelContainer=e.container,this._isTradingPanelAvailable=e.isAvailable,this._isTradingPanelOpened=e.isOpened,this._tradingPanelActivePage=e.activePage,this._closeTradingPanel=e.close,this._openTradingPanelPage=e.openPage,
e.isAvailable.value()&&y.enabled("order_panel")?(i=this._orderViewDataStorage.widgetMode(),this._mode.setValue(null!==i?i:w.f.Panel)):this._mode.setValue(w.f.Popup),e.isAvailable.subscribe(function(t){t||r._mode.value()!==w.f.Panel||(e.close(),r._mode.setValue(w.f.Popup))}),this._realtimeProvider.onStatusChanged.subscribe(null,function(){return r._onStatusChanged()}),m.linking.proSymbol.subscribe(function(){r._mode.value()===w.f.Popup&&r._closeOrderDialog(),r._onStatusChanged()}),window.loginStateChange&&window.loginStateChange.subscribe(this,this._onStatusChanged),this._settings.subscribe(this._saveSettingsBinded),this._onStatusChanged(),this._orderViewDataStorage.setWidgetMode(this._mode.value()),e.activePage.subscribe(this._updateContent)}return t.prototype.openPanel=function(){var t=this;return this._closeOrderDialog(),this._closePositionDialog(),this._mode.setValue(w.f.Panel),null!==this._positionViewModel?(this._positionViewModel.onDoneButtonClicked.reject(),this._recreateOrderViewModel().then(function(){t._openOrderPanel(),t._resetOrderPanel(),t._unsubscribePositionViewModel()})):null!==this._orderViewModel&&this._orderViewModel.existingOrder?(this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel(),this._recreateOrderViewModel().then(function(){t._openOrderPanel(),t._resetOrderPanel()})):(this._openOrderPanel(),this._resetOrderPanel(),Promise.resolve())},t.prototype.closePanel=function(){null!==this._positionViewModel?(this._positionViewModel.onDoneButtonClicked.reject(),this._closePositionPanel(),this._unsubscribePositionViewModel()):(null!==this._orderViewModel&&this._orderViewModel.existingOrder&&(this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel(),this._recreateOrderViewModel()),this._closeOrderPanel())},t.prototype.showOrderView=function(t,e,i,r,s){return Object(_.__awaiter)(this,void 0,void 0,function(){var o,n,u,a,c,l,h=this;return Object(_.__generator)(this,function(d){switch(d.label){case 0:return[4,t.isTradable(e.symbol)];case 1:return(o=d.sent()).tradable||this._mode.value()!==w.f.Popup?(null!==this._orderViewModel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel()),u=e.hasOwnProperty("id"),a=u?t.modifyOrder:t.placeOrder,this._orderStub=Object.assign(this._createOrderStub(),e),r&&this._mode.setValue(w.f.Popup),(c=this._orderViewDataStorage.getInputStateFromStorage(this._state))&&Object.assign(c,{stopLossPips:e.stopLoss,stopTakeProfit:e.takeProfit}),l=new ht(t,e,a.bind(t),this._mode,this._settings,o,this._isTradingPanelAvailable.value(),this._tradingCommands.toggleTradingWidget,this._tradingCommands.onNeedSelectBroker,this._tradingCommands.trackEvent,this._tradingCommands.showErrorNotification,this._tradingCommands.suggestedQty,c,!0),this._orderViewModel=l,[2,Object(k.ensureNotNull)(this._orderViewModel).onReady.then(function(){return h._orderViewModel!==l?Promise.resolve(!1):(null!==h._positionViewModel&&h._unsubscribePositionViewModel(),h._subscribeOrderViewModel(),
h._showOrderView(i,s,r))})]):(n="<p>"+o.reason+"</p>",vt.a.show(window.t("Non-tradable symbol"),n),[2,Promise.resolve(!1)])}})})},t.prototype.showPositionView=function(t,e,i,r){return this._createAndShowPositionOrTradeView(t,e,i,t.editPositionBrackets.bind(t),r)},t.prototype.showTradeView=function(t,e,i,r){return this._createAndShowPositionOrTradeView(t,e,i,t.editTradeBrackets.bind(t),r)},t.prototype.mode=function(){return this._mode},t.prototype.status=function(){return Object(k.ensureNotNull)(this._orderViewModel).status.value()},t.prototype.orderViewDataStorage=function(){return this._orderViewDataStorage},t.prototype._createAndShowPositionOrTradeView=function(t,e,i,r,s){var o,n=this;return null!==this._positionViewModel&&(this._unmountPositionPanel(),this._unsubscribePositionViewModel()),null!==this._orderViewModel&&this._orderViewModel.existingOrder&&(this._orderViewModel.onDoneButtonClicked.reject(),this._recreateOrderViewModel()),o=new ft(t,e,i,r.bind(t),this._mode,this._settings,this._isTradingPanelAvailable.value(),this._tradingCommands.realtimeProvider,this._tradingCommands.trackEvent),this._positionViewModel=o,Object(k.ensureNotNull)(this._positionViewModel).onReady.then(function(){return n._positionViewModel!==o?Promise.resolve(!1):(n._subscribePositionViewModel(),n._showPositionOrTradeView(s))})},t.prototype._showPositionOrTradeView=function(t){var e=this;return null===this._positionViewModel?Promise.resolve(!1):Object(k.ensureNotNull)(this._positionViewModel).onReady.then(function(){return e._mode.value()===w.f.Panel?e._openPositionPanel(t):e._showPositionDialog(t),e._orderViewDataStorage.setWidgetMode(e._mode.value()),Object(k.ensureNotNull)(e._positionViewModel).onDoneButtonClicked.promise.then(function(t){return t})})},t.prototype._showOrderView=function(t,e,i){var r=this;return null===this._orderViewModel?Promise.resolve(!1):Object(k.ensureNotNull)(this._orderViewModel).onReady.then(function(){return r._mode.value()===w.f.Panel?r._openOrderPanel(t):r._showOrderDialog(t),r._orderViewDataStorage.setWidgetMode(r._mode.value()),"function"==typeof e&&e(),Object(k.ensureNotNull)(r._orderViewModel).onDoneButtonClicked.promise.then(function(t){return t})})},t.prototype._onStatusChanged=function(){return Object(_.__awaiter)(this,void 0,void 0,function(){var t,e,i,r,s,o;return Object(_.__generator)(this,function(n){switch(n.label){case 0:return t=++this._statusChangeIndex,e=m.linking.proSymbol.value()||m.linking.symbol.value(),i=this._realtimeProvider.activeBroker(),r=this._state,this._orderViewDataStorage.setBrokerId(i?i.metainfo().id:""),this._state={broker:i,symbol:e,side:null!==this._orderViewModel&&this._orderViewModel.side?this._orderViewModel.side.value():1,orderType:null!==this._orderViewModel&&this._orderViewModel.orderType?this._orderViewModel.orderType.value():1,accountId:null!==i?(u=i.accountManagerInfo(),u.account&&u.account instanceof I.a?u.account.value().id:String(u.account)):null},this._orderStub=this._createOrderStub(),
null!==this._orderViewModel&&(this._orderViewModel.existingOrder&&this._orderViewModel.onDoneButtonClicked.reject(),this._unsubscribeOrderViewModel()),null!==this._positionViewModel&&(this._positionViewModel.onDoneButtonClicked.reject(),this._unsubscribePositionViewModel()),!r||r.broker===this._state.broker&&r.accountId===this._state.accountId?[3,2]:[4,Promise.all([this._closeOrderDialog(),this._closePositionDialog(),this._unmountPositionPanel()])];case 1:if(n.sent(),t!==this._statusChangeIndex)return[2];n.label=2;case 2:return null!==i?[3,4]:(o=new ht(i,this._orderStub,function(){return Promise.resolve(!0)},this._mode,this._settings,{tradable:!1},this._isTradingPanelAvailable.value(),this._tradingCommands.toggleTradingWidget,this._tradingCommands.onNeedSelectBroker,this._tradingCommands.trackEvent,this._tradingCommands.showErrorNotification,this._tradingCommands.suggestedQty),this._orderViewModel=o,[4,Object(k.ensureNotNull)(this._orderViewModel).onReady]);case 3:return n.sent(),t!==this._statusChangeIndex||this._orderViewModel!==o?[2]:(this._subscribeOrderViewModel(),this._deactivateOrderPanel(),this._isTradingPanelOpened.value()&&this._mode.value()===w.f.Panel&&null===this._positionViewModel&&this._tradingPanelActivePage.value()===mt.d.OrderPanel&&this._showOrderView(),[3,7]);case 4:return this._subscribeActiveAccount(i.accountManagerInfo()),this._initializeSettings(),[4,i.isTradable(e)];case 5:return s=n.sent(),t!==this._statusChangeIndex?[2]:(o=new ht(i,this._orderStub,i.placeOrder.bind(i),this._mode,this._settings,s,this._isTradingPanelAvailable.value(),this._tradingCommands.toggleTradingWidget,this._tradingCommands.onNeedSelectBroker,this._tradingCommands.trackEvent,this._tradingCommands.showErrorNotification,this._tradingCommands.suggestedQty,this._orderViewDataStorage.getInputStateFromStorage(this._state)),this._orderViewModel=o,[4,Object(k.ensureNotNull)(this._orderViewModel).onReady]);case 6:if(n.sent(),this._orderViewModel!==o)return[2];this._resetOrderPanel(),this._deactivateOrderPanel(),this._subscribeOrderViewModel(),this._isTradingPanelOpened.value()&&this._mode.value()===w.f.Panel&&null===this._positionViewModel&&this._tradingPanelActivePage.value()===mt.d.OrderPanel&&this._showOrderView(),n.label=7;case 7:return[2]}var u})})},t.prototype._initializeSettings=function(){this._settings.unsubscribe(this._saveSettingsBinded),this._settings.setValue(this._orderViewDataStorage.getSettings()||P.b),this._settings.subscribe(this._saveSettingsBinded)},t.prototype._saveSettings=function(t){this._orderViewDataStorage.saveSettings(t)},t.prototype._createOrderStub=function(){var t=Object(k.ensureNotNull)(this._state),e={limitPrice:0,stopPrice:0,qty:0,side:t.side,symbol:t.symbol,type:null!==t.orderType?t.orderType:1,takeProfit:void 0,stopLoss:void 0},i=this._orderViewDataStorage.duration(t.symbol);return null!==i&&(e.duration=i),e},t.prototype._activateOrderPanel=function(){null!==this._orderViewModel&&this._orderViewModel.activateOrderPanel()},t.prototype._deactivateOrderPanel=function(){
null!==this._orderViewModel&&this._orderViewModel.deactivateOrderPanel()},t.prototype._resetOrderPanel=function(){null!==this._orderViewModel&&this._orderViewModel.resetOrderPanel()},t.prototype._subscribeActiveAccount=function(t){t.account&&t.account instanceof I.a&&(null!==this._activeAccount&&(this._activeAccount.unsubscribe(this._onStatusChangedBinded),this._activeAccount=null),this._activeAccount=t.account,this._activeAccount.subscribe(this._onStatusChangedBinded))},t.prototype._recreateOrderViewModel=function(){return Object(_.__awaiter)(this,void 0,void 0,function(){var t,e;return Object(_.__generator)(this,function(i){switch(i.label){case 0:return null===this._state||null===this._state.broker?[3,2]:(this._orderStub=this._createOrderStub(),this._orderViewDataStorage.setBrokerId(this._state.broker.metainfo().id),[4,this._state.broker.isTradable(this._state.symbol)]);case 1:return t=i.sent(),e=new ht(this._state.broker,this._orderStub,this._state.broker.placeOrder.bind(this._state.broker),this._mode,this._settings,t,this._isTradingPanelAvailable.value(),this._tradingCommands.toggleTradingWidget,this._tradingCommands.onNeedSelectBroker,this._tradingCommands.trackEvent,this._tradingCommands.showErrorNotification,this._tradingCommands.suggestedQty,this._orderViewDataStorage.getInputStateFromStorage(this._state)),this._orderViewModel=e,this._subscribeOrderViewModel(),[2,e.onReady];case 2:return[2]}})})},t.prototype._openOrderPanel=function(t){var e=this;return this._mountOrderPanel(t).then(function(){return e._openTradingPanelPage(mt.d.OrderPanel)})},t.prototype._mountOrderPanel=function(t){var e=this;return b().then(function(i){null!==e._orderViewModel&&i.mountOrderPanel(e._orderViewModel,e._settings,e._tradingPanelContainer,Object(k.ensureNotNull)(e._resizerBridge).width,t,e._trackEvent)})},t.prototype._closeOrderPanel=function(){var t=this;return this._unmountOrderPanel().then(function(){return t._closeTradingPanel()})},t.prototype._unmountOrderPanel=function(){var t=this;return b().then(function(e){e.unmountOrderPanel(Object(k.ensureNotNull)(t._tradingPanelContainer))})},t.prototype._showOrderDialog=function(t){var e=this;b().then(function(i){null!==e._orderViewModel&&i.showOrderDialog(e._orderViewModel,e._settings,t,e._trackEvent)})},t.prototype._closeOrderDialog=function(){return b().then(function(t){t.closeOrderDialog()})},t.prototype._subscribeOrderViewModel=function(){Object(k.ensureNotNull)(this._orderViewModel).onModeChanged().subscribe(this,this._onOrderWidgetModeChanged),Object(k.ensureNotNull)(this._orderViewModel).onInputStateChanged().subscribe(this,this._onOrderWidgetInputStateChanged),Object(k.ensureNotNull)(this._orderViewModel).onCloseButtonClicked().subscribe(this,this._onOrderWidgetCloseButtonClicked),Object(k.ensureNotNull)(this._orderViewModel).onBackButtonClicked().subscribe(this,this._onOrderWidgetBackButtonClicked)},t.prototype._unsubscribeOrderViewModel=function(){Object(k.ensureNotNull)(this._orderViewModel).onModeChanged().unsubscribe(this,this._onOrderWidgetModeChanged),
Object(k.ensureNotNull)(this._orderViewModel).onInputStateChanged().unsubscribe(this,this._onOrderWidgetInputStateChanged),Object(k.ensureNotNull)(this._orderViewModel).onCloseButtonClicked().unsubscribe(this,this._onOrderWidgetCloseButtonClicked),Object(k.ensureNotNull)(this._orderViewModel).onBackButtonClicked().unsubscribe(this,this._onOrderWidgetBackButtonClicked),Object(k.ensureNotNull)(this._orderViewModel).destroy(),this._orderViewModel=null},t.prototype._openPositionPanel=function(t){var e=this;return this._mountPositionPanel(t).then(function(){return e._openTradingPanelPage(mt.d.OrderPanel)})},t.prototype._mountPositionPanel=function(t){var e=this;return f().then(function(i){if(null!==e._positionViewModel)return i.mountPositionPanel(e._positionViewModel,e._settings,e._tradingPanelContainer,t)})},t.prototype._closePositionPanel=function(){var t=this;return this._unmountPositionPanel().then(function(){return t._closeTradingPanel()})},t.prototype._unmountPositionPanel=function(){var t=this;return f().then(function(e){null!==t._positionViewModel&&e.unmountPositionPanel(t._positionViewModel,t._tradingPanelContainer)})},t.prototype._showPositionDialog=function(t){var e=this;f().then(function(i){null!==e._positionViewModel&&i.showPositionDialog(e._positionViewModel,e._settings,t)})},t.prototype._closePositionDialog=function(){return f().then(function(t){t.closePositionDialog()})},t.prototype._subscribePositionViewModel=function(){Object(k.ensureNotNull)(this._positionViewModel).onModeChanged().subscribe(this,this._onPositionWidgetModeChanged),Object(k.ensureNotNull)(this._positionViewModel).onBackButtonClicked().subscribe(this,this._onPositionWidgetBackButtonClicked),Object(k.ensureNotNull)(this._positionViewModel).onCloseButtonClicked().subscribe(this,this._onPositionWidgetCloseButtonClicked)},t.prototype._unsubscribePositionViewModel=function(){Object(k.ensureNotNull)(this._positionViewModel).onModeChanged().unsubscribe(this,this._onPositionWidgetModeChanged),Object(k.ensureNotNull)(this._positionViewModel).onBackButtonClicked().unsubscribe(this,this._onPositionWidgetBackButtonClicked),Object(k.ensureNotNull)(this._positionViewModel).onCloseButtonClicked().unsubscribe(this,this._onPositionWidgetCloseButtonClicked),Object(k.ensureNotNull)(this._positionViewModel).onDoneButtonClicked.resolve(!1),Object(k.ensureNotNull)(this._positionViewModel).destroy(),this._positionViewModel=null},t}()},"3oOo":function(t,e,i){"use strict";var r,s,o,n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},u=i("8yf6"),a=i("4c1C"),c=i("rfFC"),l=i("NTzu"),h=i("wHNh"),d=function(t){function e(e,i){t.call(this),this.source=e,this.subjectFactory=i,this._refCount=0,this._isComplete=!1}return n(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},
e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new l.Subscription).add(this.source.subscribe(new s(this.getSubject(),this))),t.closed?(this._connection=null,t=l.Subscription.EMPTY):this._connection=t),t},e.prototype.refCount=function(){return h.refCount()(this)},e}(a.Observable);e.ConnectableObservable=d,r=d.prototype,e.connectableObservableDescriptor={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}},s=function(t){function e(e,i){t.call(this,e),this.connectable=i}return n(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t,e=this.connectable;e&&(this.connectable=null,t=e._connection,e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe())},e}(u.SubjectSubscriber),function(){function t(t){this.connectable=t}t.prototype.call=function(t,e){var i,r,s=this.connectable;return s._refCount++,i=new o(t,s),r=e.subscribe(i),i.closed||(i.connection=s.connect()),r}}(),o=function(t){function e(e,i){t.call(this,e),this.connectable=i}return n(e,t),e.prototype._unsubscribe=function(){var t,e,i,r=this.connectable;r?(this.connectable=null,(t=r._refCount)<=0?this.connection=null:(r._refCount=t-1,t>1?this.connection=null:(e=this.connection,i=r._connection,this.connection=null,!i||e&&i!==e||i.unsubscribe()))):this.connection=null},e}(c.Subscriber)},"4EEH":function(t,e,i){"use strict";function r(t){return t?1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}:s.noop}var s=i("ENbT");e.pipe=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r(e)},e.pipeFromArray=r},"4XzM":function(t,e,i){"use strict";var r=i("4c1C"),s=i("+EyI");r.Observable.prototype.map=s.map},"4c1C":function(t,e,i){"use strict";var r=i("tSeh"),s=i("nA+3"),o=i("78uX"),n=i("4EEH"),u=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var i=new t;return i.source=this,i.operator=e,i},t.prototype.subscribe=function(t,e,i){var r=this.operator,o=s.toSubscriber(t,e,i);if(r?r.call(o,this.source):o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},t.prototype.forEach=function(t,e){var i=this;if(e||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?e=r.root.Rx.config.Promise:r.root.Promise&&(e=r.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var s;s=i.subscribe(function(e){if(s)try{t(e)
}catch(t){r(t),s.unsubscribe()}else t(e)},r,e)})},t.prototype._subscribe=function(t){return this.source.subscribe(t)},t.prototype[o.observable]=function(){return this},t.prototype.pipe=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 0===e.length?this:n.pipeFromArray(e)(this)},t.prototype.toPromise=function(t){var e=this;if(t||(r.root.Rx&&r.root.Rx.config&&r.root.Rx.config.Promise?t=r.root.Rx.config.Promise:r.root.Promise&&(t=r.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,i){var r;e.subscribe(function(t){return r=t},function(t){return i(t)},function(){return t(r)})})},t.create=function(e){return new t(e)},t}();e.Observable=u},"5NPC":function(t,e,i){"use strict";var r=i("8yf6"),s=i("xE8I");e.publish=function(t){return t?s.multicast(function(){return new r.Subject},t):s.multicast(new r.Subject)}},"78uX":function(t,e,i){"use strict";function r(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}var s=i("tSeh");e.getSymbolObservable=r,e.observable=r(s.root),e.$$observable=e.observable},"8Zmw":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("NTzu"),o=function(t){function e(e,i){t.call(this),this.subject=e,this.subscriber=i,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){var t,e,i;this.closed||(this.closed=!0,e=(t=this.subject).observers,this.subject=null,!e||0===e.length||t.isStopped||t.closed||-1!==(i=e.indexOf(this.subscriber))&&e.splice(i,1))},e}(s.Subscription);e.SubjectSubscription=o},"8yf6":function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("4c1C"),u=i("rfFC"),a=i("NTzu"),c=i("VpWK"),l=i("8Zmw"),h=i("qWnh"),d=function(t){function e(e){t.call(this,e),this.destination=e}return o(e,t),e}(u.Subscriber);e.SubjectSubscriber=d,r=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return o(e,t),e.prototype[h.rxSubscriber]=function(){return new d(this)},e.prototype.lift=function(t){var e=new s(this,this);return e.operator=t,e},e.prototype.next=function(t){var e,i,r,s;if(this.closed)throw new c.ObjectUnsubscribedError;if(!this.isStopped)for(i=(e=this.observers).length,r=e.slice(),s=0;s<i;s++)r[s].next(t)},e.prototype.error=function(t){var e,i,r,s;if(this.closed)throw new c.ObjectUnsubscribedError;for(this.hasError=!0,this.thrownError=t,this.isStopped=!0,i=(e=this.observers).length,r=e.slice(),s=0;s<i;s++)r[s].error(t);this.observers.length=0},e.prototype.complete=function(){var t,e,i,r;if(this.closed)throw new c.ObjectUnsubscribedError;for(this.isStopped=!0,e=(t=this.observers).length,i=t.slice(),r=0;r<e;r++)i[r].complete()
;this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new c.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new c.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),a.Subscription.EMPTY):this.isStopped?(t.complete(),a.Subscription.EMPTY):(this.observers.push(t),new l.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new n.Observable;return t.source=this,t},e.create=function(t,e){return new s(t,e)},e}(n.Observable),e.Subject=r,s=function(t){function e(e,i){t.call(this),this.destination=e,this.source=i}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):a.Subscription.EMPTY},e}(r),e.AnonymousSubject=s},"9A11":function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("rfFC"),u=i("ty+v");e.first=function(t,e,i){return function(s){return s.lift(new r(t,e,i,s))}},r=function(){function t(t,e,i,r){this.predicate=t,this.resultSelector=e,this.defaultValue=i,this.source=r}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.predicate,this.resultSelector,this.defaultValue,this.source))},t}(),s=function(t){function e(e,i,r,s,o){t.call(this,e),this.predicate=i,this.resultSelector=r,this.defaultValue=s,this.source=o,this.index=0,this.hasCompleted=!1,this._emitted=!1}return o(e,t),e.prototype._next=function(t){var e=this.index++;this.predicate?this._tryPredicate(t,e):this._emit(t,e)},e.prototype._tryPredicate=function(t,e){var i;try{i=this.predicate(t,e,this.source)}catch(t){return void this.destination.error(t)}i&&this._emit(t,e)},e.prototype._emit=function(t,e){this.resultSelector?this._tryResultSelector(t,e):this._emitFinal(t)},e.prototype._tryResultSelector=function(t,e){var i;try{i=this.resultSelector(t,e)}catch(t){return void this.destination.error(t)}this._emitFinal(i)},e.prototype._emitFinal=function(t){var e=this.destination;this._emitted||(this._emitted=!0,e.next(t),e.complete(),this.hasCompleted=!0)},e.prototype._complete=function(){var t=this.destination;this.hasCompleted||void 0===this.defaultValue?this.hasCompleted||t.error(new u.EmptyError):(t.next(this.defaultValue),t.complete())},e}(n.Subscriber)},"9zIo":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("xA5P"),o=function(t){function e(){t.apply(this,arguments)}
return r(e,t),e}(s.AsyncScheduler);e.QueueScheduler=o},C7Jb:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("NTzu"),o=function(t){function e(e,i){t.call(this)}return r(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(s.Subscription);e.Action=o},DVyt:function(t,e,i){"use strict";var r=i("HDK4"),s=i("xE8I");e.publishReplay=function(t,e,i,o){var n,u;return i&&"function"!=typeof i&&(o=i),n="function"==typeof i?i:void 0,u=new r.ReplaySubject(t,e,o),function(t){return s.multicast(function(){return u},n)(t)}}},ENbT:function(t,e,i){"use strict";e.noop=function(){}},G4OQ:function(t,e,i){"use strict";var r=i("rRE7");e.of=r.ArrayObservable.of},G7k4:function(t,e,i){"use strict";var r=i("4c1C"),s=i("gjxa");r.Observable.prototype.publish=s.publish},H9Zw:function(t,e,i){"use strict";var r=i("z6YP"),s=i("G4OQ"),o=i("IrFB"),n=i("Rcwy");e.concat=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 1===e.length||2===e.length&&r.isScheduler(e[1])?o.from(e[0]):n.concatAll()(s.of.apply(void 0,e))}},HDK4:function(t,e,i){"use strict";var r,s=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i("8yf6"),n=i("1ouX"),u=i("NTzu"),a=i("Ndu5"),c=i("VpWK"),l=i("8Zmw"),h=function(t){function e(e,i,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===i&&(i=Number.POSITIVE_INFINITY),t.call(this),this.scheduler=r,this._events=[],this._bufferSize=e<1?1:e,this._windowTime=i<1?1:i}return s(e,t),e.prototype.next=function(e){var i=this._getNow();this._events.push(new r(i,e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,i,r,s=this._trimBufferThenGetEvents(),o=this.scheduler;if(this.closed)throw new c.ObjectUnsubscribedError;for(this.hasError?e=u.Subscription.EMPTY:this.isStopped?e=u.Subscription.EMPTY:(this.observers.push(t),e=new l.SubjectSubscription(this,t)),o&&t.add(t=new a.ObserveOnSubscriber(t,o)),i=s.length,r=0;r<i&&!t.closed;r++)t.next(s[r].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||n.queue).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,i=this._windowTime,r=this._events,s=r.length,o=0;o<s&&!(t-r[o].time<i);)o++;return s>e&&(o=Math.max(o,s-e)),o>0&&r.splice(0,o),r},e}(o.Subject);e.ReplaySubject=h,r=function(){return function(t,e){this.time=t,this.value=e}}()},IrFB:function(t,e,i){"use strict";var r=i("pHYF");e.from=r.FromObservable.create},JwtW:function(t,e,i){"use strict";var r=i("4c1C"),s=i("oaOn");r.Observable.combineLatest=s.combineLatest},MSNS:function(t,e,i){"use strict";var r=i("4c1C"),s=i("jQCj");r.Observable.prototype.startWith=s.startWith},MiOS:function(t,e,i){"use strict"
;function r(t,e){return t.find(function(t){return t.value===e})||t[0]}function s(t){return new Date(t.format("YYYY-MM-DD[T]HH:mm[:00Z]")).valueOf()}function o(t,e){var i=e.hasDatePicker?t.format("DD MMM YYYY"):"",r=e.hasTimePicker?", "+t.format("hh:mm A"):"";return i+r}i.d(e,"a",function(){return r}),i.d(e,"c",function(){return s}),i.d(e,"b",function(){return o})},NTzu:function(t,e,i){"use strict";function r(t){return t.reduce(function(t,e){return t.concat(e instanceof c.UnsubscriptionError?e.errors:e)},[])}var s=i("luwt"),o=i("rkVw"),n=i("xqEh"),u=i("PBwO"),a=i("s4BY"),c=i("1R9w"),l=function(){function t(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var t,e,i,l,h,d,p,b,f,_,y=!1;if(!this.closed){for(i=(e=this)._parent,l=e._parents,h=e._unsubscribe,d=e._subscriptions,this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null,p=-1,b=l?l.length:0;i;)i.remove(this),i=++p<b&&l[p]||null;if(n.isFunction(h)&&u.tryCatch(h).call(this)===a.errorObject&&(y=!0,t=t||(a.errorObject.e instanceof c.UnsubscriptionError?r(a.errorObject.e.errors):[a.errorObject.e])),s.isArray(d))for(p=-1,b=d.length;++p<b;)f=d[p],o.isObject(f)&&u.tryCatch(f.unsubscribe).call(f)===a.errorObject&&(y=!0,t=t||[],(_=a.errorObject.e)instanceof c.UnsubscriptionError?t=t.concat(r(_.errors)):t.push(_));if(y)throw new c.UnsubscriptionError(t)}},t.prototype.add=function(e){var i,r;if(!e||e===t.EMPTY)return t.EMPTY;if(e===this)return this;switch(i=e,typeof e){case"function":i=new t(e);case"object":if(i.closed||"function"!=typeof i.unsubscribe)return i;if(this.closed)return i.unsubscribe(),i;"function"!=typeof i._addParent&&(r=i,(i=new t)._subscriptions=[r]);break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(i),i._addParent(this),i},t.prototype.remove=function(t){var e,i=this._subscriptions;i&&-1!==(e=i.indexOf(t))&&i.splice(e,1)},t.prototype._addParent=function(t){var e=this._parent,i=this._parents;e&&e!==t?i?-1===i.indexOf(t)&&i.push(t):this._parents=[t]:this._parent=t},t.EMPTY=((e=new t).closed=!0,e),t}();e.Subscription=l},NVK1:function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("rfFC");e.map=function(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new r(t,e))}},r=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.thisArg))},t}(),e.MapOperator=r,s=function(t){function e(e,i,r){t.call(this,e),this.project=i,this.count=0,this.thisArg=r||this}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}
this.destination.next(e)},e}(n.Subscriber)},NbG7:function(t,e,i){"use strict";var r,s,o;i.d(e,"b",function(){return s}),i.d(e,"a",function(){return o}),r=i("q1tI"),s={showRelativePriceControl:!0,showCurrencyRiskInQty:!0,showPercentRiskInQty:!0,showBracketsInCurrency:!0,showBracketsInPercent:!0,showOrderPreview:!0},o=r.createContext({value:s,setValue:function(t){console.warn("unable to modify order ticket settings because context.setValue is not defined")}})},Ndu5:function(t,e,i){"use strict";var r,s,o,n=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},u=i("rfFC"),a=i("i2Fk");e.observeOn=function(t,e){return void 0===e&&(e=0),function(i){return i.lift(new r(t,e))}},r=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.scheduler,this.delay))},t}(),e.ObserveOnOperator=r,s=function(t){function e(e,i,r){void 0===r&&(r=0),t.call(this,e),this.scheduler=i,this.delay=r}return n(e,t),e.dispatch=function(t){var e=t.notification,i=t.destination;e.observe(i),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new o(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(a.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(a.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(a.Notification.createComplete())},e}(u.Subscriber),e.ObserveOnSubscriber=s,o=function(){return function(t,e){this.notification=t,this.destination=e}}(),e.ObserveOnMessage=o},PBwO:function(t,e,i){"use strict";function r(){try{return s.apply(this,arguments)}catch(t){return o.errorObject.e=t,o.errorObject}}var s,o=i("s4BY");e.tryCatch=function(t){return s=t,r}},PIcZ:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("4c1C"),o=function(t){function e(e,i){t.call(this),this.value=e,this.scheduler=i,this._isScalar=!0,i&&(this._isScalar=!1)}return r(e,t),e.create=function(t,i){return new e(t,i)},e.dispatch=function(t){var e=t.done,i=t.value,r=t.subscriber;e?r.complete():(r.next(i),r.closed||(t.done=!0,this.schedule(t)))},e.prototype._subscribe=function(t){var i=this.value,r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{done:!1,value:i,subscriber:t});t.next(i),t.closed||t.complete()},e}(s.Observable);e.ScalarObservable=o},Qros:function(t,e,i){"use strict";e.empty={closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},RRpD:function(t,e,i){t.exports={button:"button-1WkyaKr8"}},Rcwy:function(t,e,i){"use strict";var r=i("XlJg");e.concatAll=function(){return r.mergeAll(1)}},Rkh2:function(t,e,i){"use strict";function r(t){var e=t.value,i=t.subscriber;i.closed||(i.next(e),i.complete())}function s(t){
var e=t.err,i=t.subscriber;i.closed||i.error(e)}var o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("tSeh"),u=i("4c1C"),a=function(t){function e(e,i){t.call(this),this.promise=e,this.scheduler=i}return o(e,t),e.create=function(t,i){return new e(t,i)},e.prototype._subscribe=function(t){var e=this,i=this.promise,o=this.scheduler;if(null==o)this._isScalar?t.closed||(t.next(this.value),t.complete()):i.then(function(i){e.value=i,e._isScalar=!0,t.closed||(t.next(i),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){n.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return o.schedule(r,0,{value:this.value,subscriber:t})}else i.then(function(i){e.value=i,e._isScalar=!0,t.closed||t.add(o.schedule(r,0,{value:i,subscriber:t}))},function(e){t.closed||t.add(o.schedule(s,0,{err:e,subscriber:t}))}).then(null,function(t){n.root.setTimeout(function(){throw t})})},e}(u.Observable);e.PromiseObservable=a},SUh3:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("4c1C"),o=function(t){function e(e){t.call(this),this.scheduler=e}return r(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var i=this.scheduler;if(i)return i.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(s.Observable);e.EmptyObservable=o},VVyh:function(t,e,i){"use strict";function r(t,e,i){var r=e.parse(t);return r.res?r.price:void 0!==i?i:parseFloat(t)}function s(t,e,i,r,s){var o=Array.from({length:t},function(t,e,i,r){return function(s,o){return r.format(t+i*e*(o+1))}}(e,i,r,s));return 1===r?o.reverse():o}function o(t,e,i,r){return Object(u.__spreadArrays)(s(r,t,e,1,i),[i.format(t)],s(r,t,e,-1,i))}function n(){return"phone"!==a.device&&"phone-vertical"!==a.device?c:l}var u,a,c,l;i.d(e,"d",function(){return r}),i.d(e,"b",function(){return s}),i.d(e,"a",function(){return o}),i.d(e,"c",function(){return n}),u=i("mrSG"),a=i("33OQ"),c=6,l=4},VpWK:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=s},XlJg:function(t,e,i){"use strict";var r=i("ciX6"),s=i("22vd");e.mergeAll=function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),r.mergeMap(s.identity,null,t)}},ciX6:function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])
;t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("hgAg"),u=i("35Wn");e.mergeMap=function(t,e,i){return void 0===i&&(i=Number.POSITIVE_INFINITY),function(s){return"number"==typeof e&&(i=e,e=null),s.lift(new r(t,e,i))}},r=function(){function t(t,e,i){void 0===i&&(i=Number.POSITIVE_INFINITY),this.project=t,this.resultSelector=e,this.concurrent=i}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.resultSelector,this.concurrent))},t}(),e.MergeMapOperator=r,s=function(t){function e(e,i,r,s){void 0===s&&(s=Number.POSITIVE_INFINITY),t.call(this,e),this.project=i,this.resultSelector=r,this.concurrent=s,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e,t,i)},e.prototype._innerSub=function(t,e,i){this.add(n.subscribeToResult(this,t,e,i))},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},e.prototype.notifyNext=function(t,e,i,r,s){this.resultSelector?this._notifyResultSelector(t,e,i,r):this.destination.next(e)},e.prototype._notifyResultSelector=function(t,e,i,r){var s;try{s=this.resultSelector(t,e,i,r)}catch(t){return void this.destination.error(t)}this.destination.next(s)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(u.OuterSubscriber),e.MergeMapSubscriber=s},"d/Vi":function(t,e,i){"use strict";function r(t){var e,i=+t.length;return isNaN(i)?0:0!==i&&"number"==typeof(e=i)&&a.root.isFinite(e)?(i=function(t){var e=+t;if(0===e)return e;if(isNaN(e))return e;return e<0?-1:1}(i)*Math.floor(Math.abs(i)))<=0?0:i>n?n:i:i}var s,o,n,u=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},a=i("tSeh"),c=i("4c1C"),l=i("p8xl"),h=function(t){function e(e,i){if(t.call(this),this.scheduler=i,null==e)throw new Error("iterator cannot be null.");this.iterator=function(t){var e=t[l.iterator];if(!e&&"string"==typeof t)return new s(t);if(!e&&void 0!==t.length)return new o(t);if(!e)throw new TypeError("object is not iterable");return t[l.iterator]()}(e)}return u(e,t),e.create=function(t,i){return new e(t,i)},e.dispatch=function(t){var e,i=t.index,r=t.hasError,s=t.iterator,o=t.subscriber;r?o.error(t.error):(e=s.next()).done?o.complete():(o.next(e.value),t.index=i+1,o.closed?"function"==typeof s.return&&s.return():this.schedule(t))},e.prototype._subscribe=function(t){var i,r=0,s=this,o=s.iterator,n=s.scheduler;if(n)return n.schedule(e.dispatch,0,{index:r,iterator:o,subscriber:t});for(;;){if((i=o.next()).done){t.complete();break}if(t.next(i.value),t.closed){
"function"==typeof o.return&&o.return();break}}},e}(c.Observable);e.IteratorObservable=h,s=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length),this.str=t,this.idx=e,this.len=i}return t.prototype[l.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),o=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=r(t)),this.arr=t,this.idx=e,this.len=i}return t.prototype[l.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}(),n=Math.pow(2,53)-1},en3B:function(t,e,i){"use strict";var r,s,o,n,u,a,c,l,h,d,p,b;i.d(e,"g",function(){return o}),i.d(e,"h",function(){return n}),i.d(e,"f",function(){return u}),i.d(e,"a",function(){return a}),i.d(e,"i",function(){return c}),i.d(e,"b",function(){return l}),i.d(e,"c",function(){return h}),i.d(e,"d",function(){return d}),i.d(e,"e",function(){return p}),i.d(e,"j",function(){return b}),r=i("q1tI"),function(t){t[t.Wait=0]="Wait",t[t.Active=1]="Active",t[t.Editing=2]="Editing",t[t.Preview=3]="Preview"}(o||(o={})),function(t){t[t.Creating=0]="Creating",t[t.Placed=1]="Placed"}(n||(n={})),function(t){t.Popup="popup",t.Panel="panel"}(u||(u={})),function(t){t[t.StopLoss=0]="StopLoss",t[t.TakeProfit=1]="TakeProfit",t[t.TrailingStop=2]="TrailingStop"}(a||(a={})),function(t){t[t.Stop=0]="Stop",t[t.Limit=1]="Limit"}(c||(c={})),function(t){t[t.TakeProfit=75]="TakeProfit",t[t.StopLoss=25]="StopLoss"}(l||(l={})),function(t){t[t.Minus=189]="Minus",t[t.NumMinus=109]="NumMinus",t[t.FirefoxMinus=173]="FirefoxMinus"}(h||(h={})),function(t){t[t.Plus=187]="Plus",t[t.NumPlus=107]="NumPlus",t[t.FirefoxPlus=61]="FirefoxPlus"}(d||(d={})),p=r.createContext({resizerWidth:null,mode:u.Panel,supportTrailingStop:!1}),(s={})[1]=window.t("Limit"),s[2]=window.t("Market"),s[3]=window.t("Stop"),s[4]=window.t("Stop Limit"),b=s},fLIW:function(t,e,i){"use strict";var r=i("DVyt");e.publishReplay=function(t,e,i,s){return r.publishReplay(t,e,i,s)(this)}},gjxa:function(t,e,i){"use strict";var r=i("5NPC");e.publish=function(t){return r.publish(t)(this)}},gxrE:function(t,e,i){"use strict";var r=i("4c1C"),s=i("lKtV");r.Observable.prototype.first=s.first},hDVK:function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("rRE7"),u=i("luwt"),a=i("35Wn"),c=i("hgAg"),l={};e.combineLatest=function(){var t,e,i=[];for(t=0;t<arguments.length;t++)i[t-0]=arguments[t];return e=null,"function"==typeof i[i.length-1]&&(e=i.pop()),1===i.length&&u.isArray(i[0])&&(i=i[0].slice()),function(t){return t.lift.call(new n.ArrayObservable([t].concat(i)),new r(e))}},r=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project))},t}(),e.CombineLatestOperator=r,s=function(t){function e(e,i){t.call(this,e),
this.project=i,this.active=0,this.values=[],this.observables=[]}return o(e,t),e.prototype._next=function(t){this.values.push(l),this.observables.push(t)},e.prototype._complete=function(){var t,e,i=this.observables,r=i.length;if(0===r)this.destination.complete();else for(this.active=r,this.toRespond=r,t=0;t<r;t++)e=i[t],this.add(c.subscribeToResult(this,e,e,t))},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,i,r,s){var o=this.values,n=o[i],u=this.toRespond?n===l?--this.toRespond:this.toRespond:0;o[i]=e,0===u&&(this.project?this._tryProject(o):this.destination.next(o.slice()))},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(a.OuterSubscriber),e.CombineLatestSubscriber=s},hgAg:function(t,e,i){"use strict";var r=i("tSeh"),s=i("vf56"),o=i("/Trf"),n=i("rkVw"),u=i("4c1C"),a=i("p8xl"),c=i("nFJ+"),l=i("78uX");e.subscribeToResult=function(t,e,i,h){var d,p,b,f,_,y,v=new c.InnerSubscriber(t,i,h);if(v.closed)return null;if(e instanceof u.Observable)return e._isScalar?(v.next(e.value),v.complete(),null):(v.syncErrorThrowable=!0,e.subscribe(v));if(s.isArrayLike(e)){for(d=0,p=e.length;d<p&&!v.closed;d++)v.next(e[d]);v.closed||v.complete()}else{if(o.isPromise(e))return e.then(function(t){v.closed||(v.next(t),v.complete())},function(t){return v.error(t)}).then(null,function(t){r.root.setTimeout(function(){throw t})}),v;if(e&&"function"==typeof e[a.iterator])for(b=e[a.iterator]();;){if((f=b.next()).done){v.complete();break}if(v.next(f.value),v.closed)break}else if(e&&"function"==typeof e[l.observable]){if("function"==typeof(_=e[l.observable]()).subscribe)return _.subscribe(new c.InnerSubscriber(t,i,h));v.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else y="You provided "+(n.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.",v.error(new TypeError(y))}return null}},i2Fk:function(t,e,i){"use strict";var r=i("4c1C"),s=function(){function t(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}},t.prototype.accept=function(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,i)},t.prototype.toObservable=function(){switch(this.kind){case"N":return r.Observable.of(this.value);case"E":return r.Observable.throw(this.error);case"C":return r.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){
return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();e.Notification=s},iLVi:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("4c1C"),o=i("PIcZ"),n=i("SUh3"),u=function(t){function e(e,i){t.call(this),this.arrayLike=e,this.scheduler=i,i||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,i){var r=t.length;return 0===r?new n.EmptyObservable:1===r?new o.ScalarObservable(t[0],i):new e(t,i)},e.dispatch=function(t){var e=t.arrayLike,i=t.index,r=t.length,s=t.subscriber;s.closed||(i>=r?s.complete():(s.next(e[i]),t.index=i+1,this.schedule(t)))},e.prototype._subscribe=function(t){var i,r=0,s=this,o=s.arrayLike,n=s.scheduler,u=o.length;if(n)return n.schedule(e.dispatch,0,{arrayLike:o,index:r,length:u,subscriber:t});for(i=0;i<u&&!t.closed;i++)t.next(o[i]);t.complete()},e}(s.Observable);e.ArrayLikeObservable=u},jQCj:function(t,e,i){"use strict";var r=i("+AwB");e.startWith=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r.startWith.apply(void 0,e)(this)}},lKtV:function(t,e,i){"use strict";var r=i("9A11");e.first=function(t,e,i){return r.first(t,e,i)(this)}},lZfC:function(t,e,i){"use strict";var r,s,o,n,u;i.d(e,"b",function(){return n}),i.d(e,"a",function(){return u}),r=i("mrSG"),s=i("q1tI"),o=i("RRpD"),function(t){t[t.PlusValue=0]="PlusValue",t[t.IncDec=1]="IncDec",t[t.Clear=2]="Clear",t[t.Default=3]="Default"}(n||(n={})),u=function(t){function e(e){var i=t.call(this,e)||this;return i._createClickHandler=function(t,e){return void 0===e&&(e=n.Default),function(){i.props.onClick(t,e)}},i}return Object(r.__extends)(e,t),e.prototype.render=function(){var t;switch(this.props.type){case n.PlusValue:case n.IncDec:t=this.props.value;break;case n.Clear:t="clear";break;case n.Default:t="default"}return s.createElement("div",{className:o.button,"data-value":t,onClick:this._createClickHandler(this.props.value,this.props.type)},this.props.icon||this.props.value)},e}(s.PureComponent)},luwt:function(t,e,i){"use strict";e.isArray=Array.isArray||function(t){return t&&"number"==typeof t.length}},"m4/a":function(t,e,i){"use strict";var r=function(){function t(e,i){void 0===i&&(i=t.now),this.SchedulerAction=e,this.now=i}return t.prototype.schedule=function(t,e,i){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(i,e)},t.now=Date.now?Date.now:function(){return+new Date},t}();e.Scheduler=r},"m6W+":function(t,e,i){"use strict";var r,s,o,n;i.d(e,"a",function(){return n}),r=i("9XXR"),s=i("Ialn"),o=i("qFKp"),n=function(){function t(t){void 0===t&&(t=" "),this._divider=t}return t.prototype.format=function(t){var e=Object(r.splitThousands)(t,this._divider);return Object(s.isRtl)()&&o.isChrome?Object(s.startWithLTR)(e):e},t.prototype.parse=function(t){var e=Object(s.stripLTRMarks)(t).split(this._divider).join(""),i=Number(e)
;return isNaN(i)||/e/i.test(e)?{res:!1}:{res:!0,price:i,suggest:this.format(i)}},t}()},mPU7:function(t,e,i){"use strict";var r=i("4c1C"),s=i("fLIW");r.Observable.prototype.publishReplay=s.publishReplay},"nA+3":function(t,e,i){"use strict";var r=i("rfFC"),s=i("qWnh"),o=i("Qros");e.toSubscriber=function(t,e,i){if(t){if(t instanceof r.Subscriber)return t;if(t[s.rxSubscriber])return t[s.rxSubscriber]()}return t||e||i?new r.Subscriber(t,e,i):new r.Subscriber(o.empty)}},nDsj:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("8yf6"),o=i("VpWK"),n=function(t){function e(e){t.call(this),this._value=e}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var i=t.prototype._subscribe.call(this,e);return i&&!i.closed&&e.next(this._value),i},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.ObjectUnsubscribedError;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(s.Subject);e.BehaviorSubject=n},"nFJ+":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("rfFC"),o=function(t){function e(e,i,r){t.call(this),this.parent=e,this.outerValue=i,this.outerIndex=r,this.index=0}return r(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(s.Subscriber);e.InnerSubscriber=o},oaOn:function(t,e,i){"use strict";var r=i("z6YP"),s=i("luwt"),o=i("rRE7"),n=i("hDVK");e.combineLatest=function(){var t,e,i,u=[];for(t=0;t<arguments.length;t++)u[t-0]=arguments[t];return e=null,i=null,r.isScheduler(u[u.length-1])&&(i=u.pop()),"function"==typeof u[u.length-1]&&(e=u.pop()),1===u.length&&s.isArray(u[0])&&(u=u[0]),new o.ArrayObservable(u,i).lift(new n.CombineLatestOperator(e))}},p8xl:function(t,e,i){"use strict";function r(t){var e,i,r,s,o,n=t.Symbol;if("function"==typeof n)return n.iterator||(n.iterator=n("iterator polyfill")),n.iterator;if((e=t.Set)&&"function"==typeof(new e)["@@iterator"])return"@@iterator";if(i=t.Map)for(r=Object.getOwnPropertyNames(i.prototype),s=0;s<r.length;++s)if("entries"!==(o=r[s])&&"size"!==o&&i.prototype[o]===i.prototype.entries)return o;return"@@iterator"}var s=i("tSeh");e.symbolIteratorPonyfill=r,e.iterator=r(s.root),e.$$iterator=e.iterator},pHYF:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,
new i)},s=i("luwt"),o=i("vf56"),n=i("/Trf"),u=i("Rkh2"),a=i("d/Vi"),c=i("rRE7"),l=i("iLVi"),h=i("p8xl"),d=i("4c1C"),p=i("Ndu5"),b=i("78uX"),f=function(t){function e(e,i){t.call(this,null),this.ish=e,this.scheduler=i}return r(e,t),e.create=function(t,i){if(null!=t){if("function"==typeof t[b.observable])return t instanceof d.Observable&&!i?t:new e(t,i);if(s.isArray(t))return new c.ArrayObservable(t,i);if(n.isPromise(t))return new u.PromiseObservable(t,i);if("function"==typeof t[h.iterator]||"string"==typeof t)return new a.IteratorObservable(t,i);if(o.isArrayLike(t))return new l.ArrayLikeObservable(t,i)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},e.prototype._subscribe=function(t){var e=this.ish,i=this.scheduler;return null==i?e[b.observable]().subscribe(t):e[b.observable]().subscribe(new p.ObserveOnSubscriber(t,i,0))},e}(d.Observable);e.FromObservable=f},qWnh:function(t,e,i){"use strict";var r=i("tSeh"),s=r.root.Symbol;e.rxSubscriber="function"==typeof s&&"function"==typeof s.for?s.for("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber},rRE7:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("4c1C"),o=i("PIcZ"),n=i("SUh3"),u=i("z6YP"),a=function(t){function e(e,i){t.call(this),this.array=e,this.scheduler=i,i||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,i){return new e(t,i)},e.of=function(){var t,i,r,s=[];for(t=0;t<arguments.length;t++)s[t-0]=arguments[t];return i=s[s.length-1],u.isScheduler(i)?s.pop():i=null,(r=s.length)>1?new e(s,i):1===r?new o.ScalarObservable(s[0],i):new n.EmptyObservable(i)},e.dispatch=function(t){var e=t.array,i=t.index,r=t.count,s=t.subscriber;i>=r?s.complete():(s.next(e[i]),s.closed||(t.index=i+1,this.schedule(t)))},e.prototype._subscribe=function(t){var i,r=0,s=this.array,o=s.length,n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{array:s,index:r,count:o,subscriber:t});for(i=0;i<o&&!t.closed;i++)t.next(s[i]);t.complete()},e}(s.Observable);e.ArrayObservable=a},rfFC:function(t,e,i){"use strict";function r(t){return t instanceof l||"syncErrorThrowable"in t&&t[c.rxSubscriber]}var s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("xqEh"),u=i("NTzu"),a=i("Qros"),c=i("qWnh"),l=function(t){function e(e,i,o){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.empty;break;case 1:if(!e){this.destination=a.empty;break}if("object"==typeof e){if(r(e)){var n=e[c.rxSubscriber]();this.syncErrorThrowable=n.syncErrorThrowable,this.destination=n,n.add(this)}else this.syncErrorThrowable=!0,this.destination=new s(this,e);break}default:this.syncErrorThrowable=!0,this.destination=new s(this,e,i,o)}}return o(e,t),
e.prototype[c.rxSubscriber]=function(){return this},e.create=function(t,i,r){var s=new e(t,i,r);return s.syncErrorThrowable=!1,s},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},e}(u.Subscription);e.Subscriber=l,s=function(t){function e(e,i,r,s){var o,u;t.call(this),this._parentSubscriber=e,u=this,n.isFunction(i)?o=i:i&&(o=i.next,r=i.error,s=i.complete,i!==a.empty&&(u=Object.create(i),n.isFunction(u.unsubscribe)&&this.add(u.unsubscribe.bind(u)),u.unsubscribe=this.unsubscribe.bind(this))),this._context=u,this._next=o,this._error=r,this._complete=s}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},e.prototype.complete=function(){var t,e,i=this;this.isStopped||(t=this._parentSubscriber,this._complete?(e=function(){return i._complete.call(i._context)},t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())):this.unsubscribe())},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){throw this.unsubscribe(),t}},e.prototype.__tryOrSetError=function(t,e,i){try{e.call(this._context,i)}catch(e){return t.syncErrorValue=e,t.syncErrorThrown=!0,!0}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(l)},rkVw:function(t,e,i){"use strict";e.isObject=function(t){return null!=t&&"object"==typeof t}},s4BY:function(t,e,i){"use strict";e.errorObject={e:{}}},srUj:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("xqEh"),o=i("4c1C"),n=i("NTzu"),u=function(t){function e(e,i,r){t.call(this),this.addHandler=e,this.removeHandler=i,this.selector=r}return r(e,t),e.create=function(t,i,r){return new e(t,i,r)},
e.prototype._subscribe=function(t){var e=this,i=this.removeHandler,r=this.selector?function(){var i,r=[];for(i=0;i<arguments.length;i++)r[i-0]=arguments[i];e._callSelector(t,r)}:function(e){t.next(e)},o=this._callAddHandler(r,t);s.isFunction(i)&&t.add(new n.Subscription(function(){i(r,o)}))},e.prototype._callSelector=function(t,e){try{var i=this.selector.apply(this,e);t.next(i)}catch(e){t.error(e)}},e.prototype._callAddHandler=function(t,e){try{return this.addHandler(t)||null}catch(t){e.error(t)}},e}(o.Observable);e.FromEventPatternObservable=u},tSeh:function(t,e,i){"use strict";(function(t){var i="undefined"!=typeof window&&window,r="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,s=void 0!==t&&t,o=i||s||r;e.root=o,function(){if(!o)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(this,i("yLpj"))},"ty+v":function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=function(t){function e(){var e=t.call(this,"no elements in sequence");this.name=e.name="EmptyError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.EmptyError=s},"u+1n":function(t,e,i){"use strict";var r=i("srUj");e.fromEventPattern=r.FromEventPatternObservable.create},vf56:function(t,e,i){"use strict";e.isArrayLike=function(t){return t&&"number"==typeof t.length}},wHNh:function(t,e,i){"use strict";var r,s,o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=i("rfFC");e.refCount=function(){return function(t){return t.lift(new r(t))}},r=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var i,r,o=this.connectable;return o._refCount++,i=new s(t,o),r=e.subscribe(i),i.closed||(i.connection=o.connect()),r},t}(),s=function(t){function e(e,i){t.call(this,e),this.connectable=i}return o(e,t),e.prototype._unsubscribe=function(){var t,e,i,r=this.connectable;r?(this.connectable=null,(t=r._refCount)<=0?this.connection=null:(r._refCount=t-1,t>1?this.connection=null:(e=this.connection,i=r._connection,this.connection=null,!i||e&&i!==e||i.unsubscribe()))):this.connection=null},e}(n.Subscriber)},xA5P:function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=i("m4/a"),o=function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return r(e,t),e.prototype.flush=function(t){var e,i=this.actions;if(this.active)i.push(t);else{this.active=!0;do{if(e=t.execute(t.state,t.delay))break}while(t=i.shift());if(this.active=!1,e){for(;t=i.shift();)t.unsubscribe();throw e}}},e}(s.Scheduler);e.AsyncScheduler=o},xDhC:function(t,e,i){"use strict"
;var r=i("4c1C"),s=i("u+1n");r.Observable.fromEventPattern=s.fromEventPattern},xE8I:function(t,e,i){"use strict";var r,s=i("3oOo");e.multicast=function(t,e){return function(i){var o,n;return o="function"==typeof t?t:function(){return t},"function"==typeof e?i.lift(new r(o,e)):((n=Object.create(i,s.connectableObservableDescriptor)).source=i,n.subjectFactory=o,n)}},r=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var i=this.selector,r=this.subjectFactory(),s=i(r).subscribe(t);return s.add(e.subscribe(r)),s},t}(),e.MulticastOperator=r},xqEh:function(t,e,i){"use strict";e.isFunction=function(t){return"function"==typeof t}},z6YP:function(t,e,i){"use strict";e.isScheduler=function(t){return t&&"function"==typeof t.schedule}}}]);